<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[React ‰∏≠ÊñáÊñáÊ°£]]></title><description><![CDATA[Áî®‰∫éÊûÑÂª∫Áî®Êà∑ÁïåÈù¢ÁöÑ JavaScript Â∫ì]]></description><link>https://doc.react-china.org</link><generator>RSS for Node</generator><lastBuildDate>Tue, 13 Nov 2018 16:36:01 GMT</lastBuildDate><item><title><![CDATA[React v16.6.0: lazy, memo and contextType]]></title><description><![CDATA[<p>Today we‚Äôre releasing React 16.6 with a few new convenient features. A form of PureComponent/shouldComponentUpdate for function components, a way to do code splitting using Suspense and an easier way to consume Context from class components.</p>
<p>Check out the full <a href="#changelog">changelog</a> below.</p>
<h2 id="reactmemo"><a href="#reactmemo" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/react-api.html#reactmemo"><code class="gatsby-code-text">React.memo</code></a></h2>
<p>Class components can bail out from rendering when their input props are the same using <a href="/docs/react-api.html#reactpurecomponent"><code class="gatsby-code-text">PureComponent</code></a> or <a href="/docs/react-component.html#shouldcomponentupdate"><code class="gatsby-code-text">shouldComponentUpdate</code></a>. Now you can do the same with function components by wrapping them in <a href="/docs/react-api.html#reactmemo"><code class="gatsby-code-text">React.memo</code></a>.</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">const</span> MyComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* only rerenders if props change */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<h2 id="reactlazy-code-splitting-with-suspense"><a href="#reactlazy-code-splitting-with-suspense" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/code-splitting.html#reactlazy"><code class="gatsby-code-text">React.lazy</code></a>: Code-Splitting with <code class="gatsby-code-text">Suspense</code></h2>
<p>You may have seen <a href="/blog/2018/03/01/sneak-peek-beyond-react-16.html">Dan‚Äôs talk about React Suspense at JSConf Iceland</a>. Now you can use the Suspense component to do <a href="/docs/code-splitting.html#reactlazy">code-splitting</a> by wrapping a dynamic import in a call to <code class="gatsby-code-text">React.lazy()</code>.</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>lazy<span class="token punctuation">,</span> Suspense<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> OtherComponent <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./OtherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Suspense</span> <span class="token attr-name">fallback</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Loading<span class="token operator">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OtherComponent</span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Suspense</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>The Suspense component will also allow library authors to start building data fetching with Suspense support in the future.</p>
<blockquote>
<p>Note: This feature is not yet available for server-side rendering. Suspense support will be added in a later release.</p>
</blockquote>
<h2 id="static-contexttype"><a href="#static-contexttype" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/context.html#classcontexttype"><code class="gatsby-code-text">static contextType</code></a></h2>
<p>In <a href="/blog/2018/03/29/react-v-16-3.html">React 16.3</a> we introduced the official Context API as a replacement to the previous <a href="/docs/legacy-context.html">Legacy Context</a> API.</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">const</span> MyContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>We‚Äôve heard feedback that adopting the new render prop API can be difficult in class components. So we‚Äôve add a convenience API to <a href="/docs/context.html#classcontexttype">consume a context value from within a class component</a>.</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> MyContext<span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span>
    <span class="token comment">/* perform a side-effect at mount using the value of MyContext */</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span>
    <span class="token comment">/* render something based on the value of MyContext */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<h2 id="static-getderivedstatefromerror"><a href="#static-getderivedstatefromerror" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/react-component.html#static-getderivedstatefromerror"><code class="gatsby-code-text">static getDerivedStateFromError()</code></a></h2>
<p>React 16 introduced <a href="/blog/2017/07/26/error-handling-in-react-16.html">Error Boundaries</a> for handling errors thrown in React renders. We already had the <code class="gatsby-code-text">componentDidCatch</code> lifecycle method which gets fired after an error has already happened. It‚Äôs great for logging errors to the server. It also lets you show a different UI to the user by calling <code class="gatsby-code-text">setState</code>.</p>
<p>Before that is fired, we render <code class="gatsby-code-text">null</code> in place of the tree that threw an error. This sometimes breaks parent components that don‚Äôt expect their refs to be empty. It also doesn‚Äôt work to recover from errors on the server since the <code class="gatsby-code-text">Did</code> lifecycle methods don‚Äôt fire during server-side rendering.</p>
<p>We‚Äôre adding another error method that lets you render the fallback UI before the render completes. See the docs for <a href="/docs/react-component.html#static-getderivedstatefromerror"><code class="gatsby-code-text">getDerivedStateFromError()</code></a>.</p>
<blockquote>
<p>Note: <code class="gatsby-code-text">getDerivedStateFromError()</code> is not yet available for server-side rendering. It is designed to work with server-side rendering in a future release. We‚Äôre releasing it early so that you can start preparing to use it.</p>
</blockquote>
<h2 id="deprecations-in-strictmode"><a href="#deprecations-in-strictmode" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deprecations in StrictMode</h2>
<p>In <a href="/blog/2018/03/29/react-v-16-3.html#strictmode-component">16.3</a> we introduced the <a href="/docs/strict-mode.html"><code class="gatsby-code-text">StrictMode</code></a> component. It lets you opt-in to early warnings for patterns that might cause problems in the future.</p>
<p>We‚Äôve added two more APIs to the list of deprecated APIs in <code class="gatsby-code-text">StrictMode</code>. If you don‚Äôt use <code class="gatsby-code-text">StrictMode</code> you don‚Äôt have to worry; these warning won‚Äôt fire for you.</p>
<ul>
<li><strong>ReactDOM.findDOMNode()</strong> - This API is often misunderstood and most uses of it are unnecessary. It can also be surprisingly slow in React 16. <a href="/docs/strict-mode.html#warning-about-deprecated-finddomnode-usage">See the docs</a> for possible upgrade paths.</li>
<li><strong>Legacy Context</strong> using contextTypes and getChildContext - Legacy context makes React slightly slower and bigger than it needs to be. That‚Äôs why we strongly want to encourage upgrading to the <a href="/docs/context.html">new context API</a>. Hopefully the addition of the <a href="/docs/context.html#classcontexttype"><code class="gatsby-code-text">contextType</code></a> API makes this a bit easier.</li>
</ul>
<p>If you‚Äôre having trouble upgrading, we‚Äôd like to hear your feedback.</p>
<h2 id="installation"><a href="#installation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>React v16.6.0 is available on the npm registry.</p>
<p>To install React 16 with Yarn, run:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash">yarn add react@^16.6.0 react-dom@^16.6.0
</code></pre>
      </div>
<p>To install React 16 with npm, run:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash"><span class="token function">npm</span> <span class="token function">install</span> --save react@^16.6.0 react-dom@^16.6.0
</code></pre>
      </div>
<p>We also provide UMD builds of React via a CDN:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-html"><code class="gatsby-code-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react@16/umd/react.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react-dom@16/umd/react-dom.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>Refer to the documentation for <a href="/docs/installation.html">detailed installation instructions</a>.</p>
<h2 id="changelog"><a href="#changelog" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Changelog</h2>
<h3 id="react"><a href="#react" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React</h3>
<ul>
<li>Add <code class="gatsby-code-text">React.memo()</code> as an alternative to <code class="gatsby-code-text">PureComponent</code> for functions. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/13748">#13748</a>)</li>
<li>Add <code class="gatsby-code-text">React.lazy()</code> for code splitting components. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/13885">#13885</a>)</li>
<li><code class="gatsby-code-text">React.StrictMode</code> now warns about legacy context API. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/13760">#13760</a>)</li>
<li><code class="gatsby-code-text">React.StrictMode</code> now warns about <code class="gatsby-code-text">findDOMNode</code>. (<a href="https://github.com/sebmarkbage">@sebmarkbage</a> in <a href="https://github.com/facebook/react/pull/13841">#13841</a>)</li>
<li>Rename <code class="gatsby-code-text">unstable_AsyncMode</code> to <code class="gatsby-code-text">unstable_ConcurrentMode</code>. (<a href="https://github.com/trueadm">@trueadm</a> in <a href="https://github.com/facebook/react/pull/13732">#13732</a>)</li>
<li>Rename <code class="gatsby-code-text">unstable_Placeholder</code> to <code class="gatsby-code-text">Suspense</code>, and <code class="gatsby-code-text">delayMs</code> to <code class="gatsby-code-text">maxDuration</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/13799">#13799</a> and <a href="https://github.com/sebmarkbage">@sebmarkbage</a> in <a href="https://github.com/facebook/react/pull/13922">#13922</a>)</li>
</ul>
<h3 id="react-dom"><a href="#react-dom" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React DOM</h3>
<ul>
<li>Add <code class="gatsby-code-text">contextType</code> as a more ergonomic way to subscribe to context from a class. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/13728">#13728</a>)</li>
<li>Add <code class="gatsby-code-text">getDerivedStateFromError</code> lifecycle method for catching errors in a future asynchronous server-side renderer. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/13746">#13746</a>)</li>
<li>Warn when <code class="gatsby-code-text">&lt;Context&gt;</code> is used instead of <code class="gatsby-code-text">&lt;Context.Consumer&gt;</code>. (<a href="https://github.com/trueadm">@trueadm</a> in <a href="https://github.com/facebook/react/pull/13829">#13829</a>)</li>
<li>Fix gray overlay on iOS Safari. (<a href="https://github.com/philipp-spiess">@philipp-spiess</a> in <a href="https://github.com/facebook/react/pull/13778">#13778</a>)</li>
<li>Fix a bug caused by overwriting <code class="gatsby-code-text">window.event</code> in development. (<a href="https://github.com/sergei-startsev">@sergei-startsev</a> in <a href="https://github.com/facebook/react/pull/13697">#13697</a>)</li>
</ul>
<h3 id="react-dom-server"><a href="#react-dom-server" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React DOM Server</h3>
<ul>
<li>Add support for <code class="gatsby-code-text">React.memo()</code>. (<a href="https://github.com/alexmckenley">@alexmckenley</a> in <a href="https://github.com/facebook/react/pull/13855">#13855</a>)</li>
<li>Add support for <code class="gatsby-code-text">contextType</code>. (<a href="https://github.com/alexmckenley">@alexmckenley</a> and <a href="https://github.com/sebmarkbage">@sebmarkbage</a> in <a href="https://github.com/facebook/react/pull/13889">#13889</a>)</li>
</ul>
<h3 id="scheduler-experimental"><a href="#scheduler-experimental" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scheduler (Experimental)</h3>
<ul>
<li>Rename the package to <code class="gatsby-code-text">scheduler</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/13683">#13683</a>)</li>
<li>Support priority levels, continuations, and wrapped callbacks. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/13720">#13720</a> and <a href="https://github.com/facebook/react/pull/13842">#13842</a>)</li>
<li>Improve the fallback mechanism in non-DOM environments. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/13740">#13740</a>)</li>
<li>Schedule <code class="gatsby-code-text">requestAnimationFrame</code> earlier. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/13785">#13785</a>)</li>
<li>Fix the DOM detection to be more thorough. (<a href="https://github.com/trueadm">@trueadm</a> in <a href="https://github.com/facebook/react/pull/13731">#13731</a>)</li>
<li>Fix bugs with interaction tracing. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/13590">#13590</a>)</li>
<li>Add the <code class="gatsby-code-text">envify</code> transform to the package. (<a href="https://github.com/mridgway">@mridgway</a> in <a href="https://github.com/facebook/react/pull/13766">#13766</a>)</li>
</ul>]]></description><link>https://doc.react-china.org/blog/2018/10/23/react-v-16-6.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/10/23/react-v-16-6.html</guid><pubDate>Tue, 23 Oct 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[Create React App 2.0: Babel¬†7, Sass, and More]]></title><description><![CDATA[<p>Create React App 2.0 has been released today, and it brings a year‚Äôs worth of improvements in a single dependency update.</p>
<p>While React itself <a href="/docs/create-a-new-react-app.html">doesn‚Äôt require any build dependencies</a>, it can be challenging to write a complex app without a fast test runner, a production minifier, and a modular codebase. Since the very first release, the goal of <a href="https://github.com/facebook/create-react-app">Create React App</a> has been to help you focus on what matters the most ‚Äî your application code ‚Äî and to handle build and testing setup for you.</p>
<p>Many of the tools it relies on have since released new versions containing new features and performance improvements: <a href="https://babeljs.io/blog/2018/08/27/7.0.0">Babel 7</a>, <a href="https://medium.com/webpack/webpack-4-released-today-6cdb994702d4">webpack 4</a>, and <a href="https://jestjs.io/blog/2018/05/29/jest-23-blazing-fast-delightful-testing.html">Jest 23</a>. However, updating them manually and making them work well together takes a lot of effort. And this is exactly what <a href="https://github.com/facebook/create-react-app/graphs/contributors">Create React App 2.0 contributors</a> have been busy with for the past few months: <strong>migrating the configuration and dependencies so that you don‚Äôt need to do it yourself.</strong></p>
<p>Now that Create React App 2.0 is out of beta, let‚Äôs see what‚Äôs new and how you can try it!</p>
<blockquote>
<p>Note</p>
<p>Don‚Äôt feel pressured to upgrade anything. If you‚Äôre satisfied with the current feature set, its performance, and reliability, you can keep using the version you‚Äôre currently at! It might also be a good idea to let the 2.0 release stabilize a little bit before switching to it in production.</p>
</blockquote>
<h2 id="whats-new"><a href="#whats-new" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What‚Äôs New</h2>
<p>Here‚Äôs a short summary of what‚Äôs new in this release:</p>
<ul>
<li>üéâ More styling options: you can use <a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#adding-a-sass-stylesheet">Sass</a> and <a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#adding-a-css-modules-stylesheet">CSS Modules</a> out of the box.</li>
<li>üê† We updated to <a href="https://babeljs.io/blog/2018/08/27/7.0.0">Babel 7</a>, including support for the <a href="/docs/fragments.html#short-syntax">React fragment syntax</a> and many bugfixes.</li>
<li>üì¶ We updated to <a href="https://medium.com/webpack/webpack-4-released-today-6cdb994702d4">webpack 4</a>, which automatically splits JS bundles more intelligently.</li>
<li>üÉè We updated to <a href="https://jestjs.io/blog/2018/05/29/jest-23-blazing-fast-delightful-testing.html">Jest 23</a>, which includes an <a href="https://jestjs.io/blog/2018/05/29/jest-23-blazing-fast-delightful-testing#interactive-snapshot-mode">interactive mode</a> for reviewing snapshots.</li>
<li>üíÑ We added <a href="https://preset-env.cssdb.org/features#stage-3">PostCSS</a> so you can use new CSS features in old browsers.</li>
<li>üíé You can use <a href="https://github.com/leoasis/graphql-tag.macro#usage">Apollo</a>, <a href="https://github.com/facebook/relay/pull/2171#issuecomment-411459604">Relay Modern</a>, <a href="https://github.com/facebook/create-react-app/issues/5149#issuecomment-425396995">MDX</a>, and other third-party <a href="https://babeljs.io/blog/2017/09/11/zero-config-with-babel-macros">Babel Macros</a> transforms.</li>
<li>üå† You can now <a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#adding-svgs">import an SVG as a React component</a>, and use it in JSX.</li>
<li>üêà You can try the experimental <a href="https://github.com/yarnpkg/rfcs/pull/101">Yarn Plug‚Äôn‚ÄôPlay mode</a> that removes <code class="gatsby-code-text">node_modules</code>.</li>
<li>üï∏ You can now <a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#configuring-the-proxy-manually">plug your own proxy implementation</a> in development to match your backend API.</li>
<li>üöÄ You can now use <a href="https://github.com/sindresorhus/ama/issues/446#issuecomment-281014491">packages written for latest Node versions</a> without breaking the build.</li>
<li>‚úÇÔ∏è You can now optionally get a smaller CSS bundle if you only plan to target modern browsers.</li>
<li>üë∑‚Äç‚ôÄÔ∏è Service workers are now opt-in and are built using Google‚Äôs <a href="https://developers.google.com/web/tools/workbox/">Workbox</a>.</li>
</ul>
<p><strong>All of these features work out of the box</strong> ‚Äî to enable them, follow the below instructions.</p>
<h2 id="starting-a-project-with-create-react-app-20"><a href="#starting-a-project-with-create-react-app-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Starting a Project with Create React App 2.0</h2>
<p>You don‚Äôt need to update anything special. Starting from today, when you run <code class="gatsby-code-text">create-react-app</code> it will use the 2.0 version of the template by default. Have fun!</p>
<p>If you want to <strong>use the old 1.x template</strong> for some reason, you can do that by passing <code class="gatsby-code-text">--scripts-version=react-scripts@1.x</code> as an argument to <code class="gatsby-code-text">create-react-app</code>.</p>
<h2 id="updating-a-project-to-create-react-app-20"><a href="#updating-a-project-to-create-react-app-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating a Project to Create React App 2.0</h2>
<p>Upgrading a non-ejected project to Create React App 2.0 should usually be straightforward. Open <code class="gatsby-code-text">package.json</code> in the root of your project and find <code class="gatsby-code-text">react-scripts</code> there.</p>
<p>Then change its version to <code class="gatsby-code-text">2.0.3</code>:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx">  <span class="token comment">// ... other dependencies ...</span>
<span class="gatsby-highlight-code-line">  <span class="token string">"react-scripts"</span><span class="token punctuation">:</span> <span class="token string">"2.0.3"</span>
</span></code></pre>
      </div>
<p>Run <code class="gatsby-code-text">npm install</code> (or <code class="gatsby-code-text">yarn</code>, if you use it). <strong>For many projects, this one-line change is sufficient to upgrade!</strong></p>
<blockquote class="twitter-tweet" data-conversation="none" data-dnt="true"><p lang="en" dir="ltr">working here... thanks for all the new functionality üëç</p>&mdash; Stephen Haney (@sdothaney) <a href="https://twitter.com/sdothaney/status/1046822703116607490?ref_src=twsrc%5Etfw">October 1, 2018</a></blockquote>
<p>Here are a few more tips to get you started.</p>
<p><strong>When you run <code class="gatsby-code-text">npm start</code> for the first time after the upgrade,</strong> you‚Äôll get a prompt asking about which browsers you‚Äôd like to support. Press <code class="gatsby-code-text">y</code> to accept the default ones. They‚Äôll be written to your <code class="gatsby-code-text">package.json</code> and you can edit them any time. Create React App will use this information to produce smaller or polyfilled CSS bundles depending on whether you target modern browsers or older browsers.</p>
<p><strong>If <code class="gatsby-code-text">npm start</code> still doesn‚Äôt quite work for you after the upgrade,</strong> <a href="https://github.com/facebook/create-react-app/releases/tag/v2.0.3">check out the more detailed migration instructions in the release notes</a>. There <em>are</em> a few breaking changes in this release but the scope of them is limited, so they shouldn‚Äôt take more than a few hours to sort out. Note that <strong><a href="https://github.com/facebook/create-react-app/blob/master/packages/react-app-polyfill/README.md">support for older browsers</a> is now opt-in</strong> to reduce the polyfill size.</p>
<p><strong>If you previously ejected but now want to upgrade,</strong> one common solution is to find the commits where you ejected (and any subsequent commits changing the configuration), revert them, upgrade, and later optionally eject again. It‚Äôs also possible that the feature you ejected for (maybe Sass or CSS Modules?) is now supported out of the box.</p>
<blockquote>
<p>Note</p>
<p>Due to a possible bug in npm, you might see warnings about unsatisfied peer dependencies. You should be able to ignore them. As far as we‚Äôre aware, this issue isn‚Äôt present with Yarn.</p>
</blockquote>
<h2 id="breaking-changes"><a href="#breaking-changes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Breaking Changes</h2>
<p>Here‚Äôs a short list of breaking changes in this release:</p>
<ul>
<li>Node 6 is no longer supported.</li>
<li>Support for older browsers (such as IE 9 to IE 11) is now opt-in with a <a href="https://github.com/facebook/create-react-app/tree/master/packages/react-app-polyfill">separate package</a>.</li>
<li>Code-splitting with <code class="gatsby-code-text">import()</code> now behaves closer to specification, while <code class="gatsby-code-text">require.ensure()</code> is disabled.</li>
<li>The default Jest environment now includes jsdom.</li>
<li>Support for specifying an object as <code class="gatsby-code-text">proxy</code> setting was replaced with support for a custom proxy module.</li>
<li>Support for <code class="gatsby-code-text">.mjs</code> extension was removed until the ecosystem around it stabilizes.</li>
<li>PropTypes definitions are automatically stripped out of the production builds.</li>
</ul>
<p>If either of these points affects you, <a href="https://github.com/facebook/create-react-app/releases/tag/v2.0.3">2.0.3 release notes</a> contain more detailed instructions.</p>
<h2 id="learn-more"><a href="#learn-more" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Learn More</h2>
<p>You can find the full changelog in the <a href="https://github.com/facebook/create-react-app/releases/tag/v2.0.3">release notes</a>. This was a large release, and we may have missed something. Please report any problems to our <a href="https://github.com/facebook/create-react-app/issues/new">issue tracker</a> and we‚Äôll try to help.</p>
<blockquote>
<p>Note</p>
<p>If you‚Äôve been using 2.x alpha versions, we provide <a href="https://gist.github.com/gaearon/8650d1c70e436e5eff01f396dffc4114">separate migration instructions</a> for them.</p>
</blockquote>
<h2 id="thanks"><a href="#thanks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Thanks</h2>
<p>This release wouldn‚Äôt be possible without our wonderful community of contributors. We‚Äôd like to thank <a href="https://github.com/andriijas">Andreas Cederstr√∂m</a>, <a href="https://github.com/clemmy">Clement Hoang</a>, <a href="https://github.com/existentialism">Brian Ng</a>, <a href="https://github.com/kentcdodds">Kent C. Dodds</a>, <a href="https://github.com/viankakrisna">Ade Viankakrisna Fadlil</a>, <a href="https://github.com/ai">Andrey Sitnik</a>, <a href="https://github.com/ro-savage">Ro Savage</a>, <a href="https://github.com/Fabianopb">Fabiano Brito</a>, <a href="https://github.com/iansu">Ian Sutherland</a>, <a href="https://github.com/petetnt">Pete Nyk√§nen</a>, <a href="https://github.com/jeffposnick">Jeffrey Posnick</a>, <a href="https://github.com/bugzpodder">Jack Zhao</a>, <a href="https://github.com/sokra">Tobias Koppers</a>, <a href="https://github.com/hzoo">Henry Zhu</a>, <a href="https://github.com/arcanis">Ma√´l Nison</a>, <a href="https://github.com/lixiaoyan">XiaoYan Li</a>, <a href="https://github.com/themre">Marko Trebizan</a>, <a href="https://github.com/mareksuscak">Marek Suscak</a>, <a href="https://github.com/miraage">Mikhail Osher</a>, and many others who provided feedback and testing for this release.</p>]]></description><link>https://doc.react-china.org/blog/2018/10/01/create-react-app-v2.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/10/01/create-react-app-v2.html</guid><pubDate>Mon, 01 Oct 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[Introducing the React Profiler]]></title><description><![CDATA[<p>React 16.5 adds support for a new DevTools profiler plugin.
This plugin uses React‚Äôs <a href="https://github.com/reactjs/rfcs/pull/51">experimental Profiler API</a> to collect timing information about each component that‚Äôs rendered in order to identify performance bottlenecks in React applications.
It will be fully compatible with our upcoming <a href="/blog/2018/03/01/sneak-peek-beyond-react-16.html">time slicing and suspense</a> features.</p>
<p>This blog post covers the following topics:</p>
<ul>
<li><a href="#profiling-an-application">Profiling an application</a></li>
<li>
<p><a href="#reading-performance-data">Reading performance data</a></p>
<ul>
<li><a href="#browsing-commits">Browsing commits</a></li>
<li><a href="#filtering-commits">Filtering commits</a></li>
<li><a href="#flame-chart">Flame chart</a></li>
<li><a href="#ranked-chart">Ranked chart</a></li>
<li><a href="#component-chart">Component chart</a></li>
<li><a href="#interactions">Interactions</a></li>
</ul>
</li>
<li>
<p><a href="#troubleshooting">Troubleshooting</a></p>
<ul>
<li><a href="#no-profiling-data-has-been-recorded-for-the-selected-root">No profiling data has been recorded for the selected root</a></li>
<li><a href="#no-timing-data-to-display-for-the-selected-commit">No timing data to display for the selected commit</a></li>
</ul>
</li>
<li><a href="#deep-dive-video">Deep dive video</a></li>
</ul>
<h2 id="profiling-an-application"><a href="#profiling-an-application" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Profiling an application</h2>
<p>DevTools will show a ‚ÄúProfiler‚Äù tab for applications that support the new profiling API:</p>
<p><img src="../images/blog/introducing-the-react-profiler/devtools-profiler-tab.png" alt="New DevTools &#x22;profiler&#x22; tab"></p>
<blockquote>
<p>Note:</p>
<p><code class="gatsby-code-text">react-dom</code> 16.5+ supports profiling in DEV mode.
A production profiling bundle is also available as <code class="gatsby-code-text">react-dom/profiling</code>.
Read more about how to use this bundle at <a href="https://fb.me/react-profiling">fb.me/react-profiling</a> </p>
</blockquote>
<p>The ‚ÄúProfiler‚Äù panel will be empty initially. Click the record button to start profiling:</p>
<p><img src="../images/blog/introducing-the-react-profiler/start-profiling.png" alt="Click &#x22;record&#x22; to start profiling"></p>
<p>Once you‚Äôve started recording, DevTools will automatically collect performance information each time your application renders.
Use your app as you normally would.
When you are finished profiling, click the ‚ÄúStop‚Äù button.</p>
<p><img src="../images/blog/introducing-the-react-profiler/stop-profiling.png" alt="Click &#x22;stop&#x22; when you are finished profiling"></p>
<p>Assuming your application rendered at least once while profiling, DevTools will show several ways to view the performance data.
We‚Äôll <a href="#reading-performance-data">take a look at each of these below</a>.</p>
<h2 id="reading-performance-data"><a href="#reading-performance-data" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reading performance data</h2>
<h3 id="browsing-commits"><a href="#browsing-commits" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Browsing commits</h3>
<p>Conceptually, React does work in two phases:</p>
<ul>
<li>The <strong>render</strong> phase determines what changes need to be made to e.g. the DOM. During this phase, React calls <code class="gatsby-code-text">render</code> and then compares the result to the previous render.</li>
<li>The <strong>commit</strong> phase is when React applies any changes. (In the case of React DOM, this is when React inserts, updates, and removes DOM nodes.) React also calls lifecycles like <code class="gatsby-code-text">componentDidMount</code> and <code class="gatsby-code-text">componentDidUpdate</code> during this phase.</li>
</ul>
<p>The DevTools profiler groups performance info by commit.
Commits are displayed in a bar chart near the top of the profiler:</p>
<p><img src="../images/blog/introducing-the-react-profiler/commit-selector.png" alt="Bar chart of profiled commits"></p>
<p>Each bar in the chart represents a single commit with the currently selected commit colored black.
You can click on a bar (or the left/right arrow buttons) to select a different commit.</p>
<p>The color and height of each bar corresponds to how long that commit took to render.
(Taller, yellow bars took longer than shorter, blue bars.)</p>
<h3 id="filtering-commits"><a href="#filtering-commits" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Filtering commits</h3>
<p>The longer you profile, the more times your application will render.
In some cases you may end up with <em>too many commits</em> to easily process.
The profiler offers a filtering mechanism to help with this.
Use it to specify a threshold and the profiler will hide all commits that were <em>faster</em> than that value.</p>
<p><img src="../images/blog/introducing-the-react-profiler/filtering-commits.gif" alt="Filtering commits by time"></p>
<h3 id="flame-chart"><a href="#flame-chart" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Flame chart</h3>
<p>The flame chart view represents the state of your application for a particular commit.
Each bar in the chart represents a React component (e.g. <code class="gatsby-code-text">App</code>, <code class="gatsby-code-text">Nav</code>).
The size and color of the bar represents how long it took to render the component and its children.
(The width of a bar represents how much time was spent <em>when the component last rendered</em> and the color represents how much time was spent <em>as part of the current commit</em>.)</p>
<p><img src="../images/blog/introducing-the-react-profiler/flame-chart.png" alt="Example flame chart"></p>
<blockquote>
<p>Note:</p>
<p>The width of a bar indicates how long it took to render the component (and its children) when they last rendered.
If the component did not re-render as part of this commit, the time represents a previous render.
The wider a component is, the longer it took to render.</p>
<p>The color of a bar indicates how long the component (and its children) took to render in the selected commit.
Yellow components took more time, blue components took less time, and gray components did not render at all during this commit.</p>
</blockquote>
<p>For example, the commit shown above took a total of 18.4ms to render.
The <code class="gatsby-code-text">Router</code> component was the ‚Äúmost expensive‚Äù to render (taking 18.4ms).
Most of this time was due to two of its children, <code class="gatsby-code-text">Nav</code> (8.4ms) and <code class="gatsby-code-text">Route</code> (7.9ms).
The rest of the time was divided between its remaining children or spent in the component‚Äôs own render method.</p>
<p>You can zoom in or out on a flame chart by clicking on components:
<img src="../images/blog/introducing-the-react-profiler/zoom-in-and-out.gif" alt="Click on a component to zoom in or out"></p>
<p>Clicking on a component will also select it and show information in the right side panel which includes its <code class="gatsby-code-text">props</code> and <code class="gatsby-code-text">state</code> at the time of this commit.
You can drill into these to learn more about what the component actually rendered during the commit:</p>
<p><img src="../images/blog/introducing-the-react-profiler/props-and-state.gif" alt="Viewing a component&#x27;s props and state for a commit"></p>
<p>In some cases, selecting a component and stepping between commits may also provide a hint as to <em>why</em> the component rendered:</p>
<p><img src="../images/blog/introducing-the-react-profiler/see-which-props-changed.gif" alt="Seeing which values changed between commits"></p>
<p>The above image shows that <code class="gatsby-code-text">state.scrollOffset</code> changed between commits.
This is likely what caused the <code class="gatsby-code-text">List</code> component to re-render.</p>
<h3 id="ranked-chart"><a href="#ranked-chart" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ranked chart</h3>
<p>The ranked chart view represents a single commit.
Each bar in the chart represents a React component (e.g. <code class="gatsby-code-text">App</code>, <code class="gatsby-code-text">Nav</code>).
The chart is ordered so that the components which took the longest to render are at the top.</p>
<p><img src="../images/blog/introducing-the-react-profiler/ranked-chart.png" alt="Example ranked chart"></p>
<blockquote>
<p>Note:</p>
<p>A component‚Äôs render time includes the time spent rendering its children,
so the components which took the longest to render are generally near the top of the tree.</p>
</blockquote>
<p>As with the flame chart, you can zoom in or out on a ranked chart by clicking on components.</p>
<h3 id="component-chart"><a href="#component-chart" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Component chart</h3>
<p>Sometimes it‚Äôs useful to see how many times a particular component rendered while you were profiling.
The component chart provides this information in the form of a bar chart.
Each bar in the chart represents a time when the component rendered.
The color and height of each bar corresponds to how long the component took to render <em>relative to other components</em> in a particular commit.</p>
<p><img src="../images/blog/introducing-the-react-profiler/component-chart.png" alt="Example component chart"></p>
<p>The chart above shows that the <code class="gatsby-code-text">List</code> component rendered 11 times.
It also shows that each time it rendered, it was the most ‚Äúexpensive‚Äù component in the commit (meaning that it took the longest).</p>
<p>To view this chart, either double-click on a component <em>or</em> select a component and click on the blue bar chart icon in the right detail pane.
You can return to the previous chart by clicking the ‚Äúx‚Äù button in the right detail pane.
You can aso double click on a particular bar to view more information about that commit.</p>
<p><img src="../images/blog/introducing-the-react-profiler/see-all-commits-for-a-fiber.gif" alt="How to view all renders for a specific component"></p>
<p>If the selected component did not render at all during the profiling session, the following message will be shown:</p>
<p><img src="../images/blog/introducing-the-react-profiler/no-render-times-for-selected-component.png" alt="No render times for the selected component"></p>
<h3 id="interactions"><a href="#interactions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interactions</h3>
<p>React recently added another <a href="https://fb.me/react-interaction-tracing">experimental API</a> for tracing the <em>cause</em> of an update.
‚ÄúInteractions‚Äù traced with this API will also be shown in the profiler:</p>
<p><img src="../images/blog/introducing-the-react-profiler/interactions.png" alt="The interactions panel"></p>
<p>The image above shows a profiling session that traced four interactions.
Each row represents an interaction that was traced.
The colored dots along the row represent commits that were related to that interaction.</p>
<p>You can also see which interactions were traced for a particular commit from the flame chart and ranked chart views as well:</p>
<p><img src="../images/blog/introducing-the-react-profiler/interactions-for-commit.png" alt="List of interactions for a commit"></p>
<p>You can navigate between interactions and commits by clicking on them:</p>
<p><img src="../images/blog/introducing-the-react-profiler/navigate-between-interactions-and-commits.gif" alt="Navigate between interactions and commits"></p>
<p>The tracing API is still new and we will cover it in more detail in a future blog post.</p>
<h2 id="troubleshooting"><a href="#troubleshooting" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Troubleshooting</h2>
<h3 id="no-profiling-data-has-been-recorded-for-the-selected-root"><a href="#no-profiling-data-has-been-recorded-for-the-selected-root" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>No profiling data has been recorded for the selected root</h3>
<p>If your your application has multiple ‚Äúroots‚Äù, you may see the following message after profiling:
<img src="../images/blog/introducing-the-react-profiler/no-profiler-data-multi-root.png" alt="No profiling data has been recorded for the selected root"></p>
<p>This message indicates that no performance data was recorded for the root that‚Äôs selected in the ‚ÄúElements‚Äù panel.
In this case, try selecting a different root in that panel to view profiling information for that root:</p>
<p><img src="../images/blog/introducing-the-react-profiler/select-a-root-to-view-profiling-data.gif" alt="Select a root in the &#x22;Elements&#x22; panel to view its performance data"></p>
<h3 id="no-timing-data-to-display-for-the-selected-commit"><a href="#no-timing-data-to-display-for-the-selected-commit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>No timing data to display for the selected commit</h3>
<p>Sometimes a commit may be so fast that <code class="gatsby-code-text">performance.now()</code> doesn‚Äôt give DevTools any meaningful timing information.
In this case, the following message will be shown:</p>
<p><img src="../images/blog/introducing-the-react-profiler/no-timing-data-for-commit.png" alt="No timing data to display for the selected commit"></p>
<h2 id="deep-dive-video"><a href="#deep-dive-video" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deep dive video</h2>
<p>The following video demonstrates how the React profiler can be used to detect and improve performance bottlenecks in an actual React application.</p>
<br>
<div>
          <div
            class="gatsby-resp-iframe-wrapper"
            style="padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;"
          >
            <iframe src="https://www.youtube-nocookie.com/embed/nySib7ipZdk?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen style="
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          "></iframe>
          </div>
          </div>]]></description><link>https://doc.react-china.org/blog/2018/09/10/introducing-the-react-profiler.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/09/10/introducing-the-react-profiler.html</guid><pubDate>Mon, 10 Sep 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[React v16.4.2: Server-side vulnerability fix]]></title><description><![CDATA[<p>We discovered a minor vulnerability that might affect some apps using ReactDOMServer. We are releasing a patch version for every affected React minor release so that you can upgrade with no friction. Read on for more details.</p>
<h2 id="Ê¶ÇËø∞"><a href="#%E6%A6%82%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ê¶ÇËø∞</h2>
<p>Today, we are releasing a fix for a vulnerability we discovered in the <code class="gatsby-code-text">react-dom/server</code> implementation. It was introduced with the version 16.0.0 and has existed in all subsequent releases until today.</p>
<p>This vulnerability <strong>can only affect some server-rendered React apps.</strong> Purely client-rendered apps are <strong>not</strong> affected. Additionally, we expect that most server-rendered apps don‚Äôt contain the vulnerable pattern described below. Nevertheless, we recommend to follow the mitigation instructions at the earliest opportunity.</p>
<p>While we were investigating this vulnerability, we found similar vulnerabilities in a few other popular front-end libraries. We have coordinated this release together with <a href="https://github.com/vuejs/vue/releases/tag/v2.5.17">Vue</a> and <a href="https://github.com/developit/preact-render-to-string/releases/tag/3.7.1">Preact</a> releases fixing the same issue. The tracking number for this vulnerability is <code class="gatsby-code-text">CVE-2018-6341</code>.</p>
<h2 id="mitigation"><a href="#mitigation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mitigation</h2>
<p><strong>We have prepared a patch release with a fix for every affected minor version.</strong></p>
<h3 id="160x"><a href="#160x" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16.0.x</h3>
<p>Â¶ÇÊûú‰Ω†Âú®Ëøô‰∏™ÁâàÊú¨‰∏≠‰ΩøÁî® <code class="gatsby-code-text">react-dom/server</code> Ôºö</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.0.0</code></li>
</ul>
<p>ÂçáÁ∫ßÂà∞‰∏ãÈù¢ÁöÑÁâàÊú¨Êù•ÊõøÊç¢‰πãÂâçÁöÑÁâàÊú¨„ÄÇ</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.0.1</code> <strong>(contains the mitigation)</strong></li>
</ul>
<h3 id="161x"><a href="#161x" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16.1.x</h3>
<p>Â¶ÇÊûú‰Ω†Âú®‰∏ãÈù¢ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÁâàÊú¨‰∏≠‰ΩøÁî® <code class="gatsby-code-text">react-dom/server</code></p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.1.0</code></li>
<li><code class="gatsby-code-text">react-dom@16.1.1</code></li>
</ul>
<p>ÂçáÁ∫ßÂà∞‰∏ãÈù¢ÁöÑÁâàÊú¨Êù•ÊõøÊç¢‰πãÂâçÁöÑÁâàÊú¨„ÄÇ</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.1.2</code> <strong>(contains the mitigation)</strong></li>
</ul>
<h3 id="162x"><a href="#162x" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16.2.x</h3>
<p>Â¶ÇÊûú‰Ω†Âú®‰∏ãÈù¢ÁöÑÁâàÊú¨‰∏≠‰ΩøÁî® <code class="gatsby-code-text">react-dom/server</code>Ôºö</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.2.0</code></li>
</ul>
<p>ÂçáÁ∫ßÂà∞‰∏ãÈù¢ÁöÑÁâàÊú¨Êù•ÊõøÊç¢‰πãÂâçÁöÑÁâàÊú¨„ÄÇ</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.2.1</code> <strong>(contains the mitigation)</strong></li>
</ul>
<h3 id="163x"><a href="#163x" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16.3.x</h3>
<p>Â¶ÇÊûú‰Ω†Âú®‰∏ãÈù¢ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÁâàÊú¨‰∏≠‰ΩøÁî® <code class="gatsby-code-text">react-dom/server</code>Ôºö</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.3.0</code></li>
<li><code class="gatsby-code-text">react-dom@16.3.1</code></li>
<li><code class="gatsby-code-text">react-dom@16.3.2</code></li>
</ul>
<p>ÂçáÁ∫ßÂà∞‰∏ãÈù¢ÁöÑÁâàÊú¨Êù•ÊõøÊç¢‰πãÂâçÁöÑÁâàÊú¨„ÄÇ</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.3.3</code> <strong>(contains the mitigation)</strong></li>
</ul>
<h3 id="164x"><a href="#164x" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16.4.x</h3>
<p>Â¶ÇÊûú‰Ω†Âú®‰∏ãÈù¢ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÁâàÊú¨‰∏≠‰ΩøÁî® <code class="gatsby-code-text">react-dom/server</code>Ôºö</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.4.0</code></li>
<li><code class="gatsby-code-text">react-dom@16.4.1</code></li>
</ul>
<p>ÂçáÁ∫ßÂà∞‰∏ãÈù¢ÁöÑÁâàÊú¨Êù•ÊõøÊç¢‰πãÂâçÁöÑÁâàÊú¨„ÄÇ</p>
<ul>
<li><code class="gatsby-code-text">react-dom@16.4.2</code> <strong>(contains the mitigation)</strong></li>
</ul>
<p>If you‚Äôre using a newer version of <code class="gatsby-code-text">react-dom</code>, no action is required.</p>
<p>Note that only the <code class="gatsby-code-text">react-dom</code> package needs to be updated.</p>
<h2 id="ÁªÜËäÇÊèèËø∞"><a href="#%E7%BB%86%E8%8A%82%E6%8F%8F%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÁªÜËäÇÊèèËø∞</h2>
<p>Âè™ÊúâÂΩìËøô‰∏§‰∏™Êù°‰ª∂ÈÉΩ‰∏∫ÁúüÊó∂ÔºåÊÇ®ÁöÑÂ∫îÁî®Á®ãÂ∫èÊâç‰ºöÂèóÂà∞Ëøô‰∏™ÊºèÊ¥ûÁöÑÂΩ±ÂìçÔºö</p>
<ul>
<li>ÊÇ®ÁöÑÂ∫îÁî®Á®ãÂ∫èÊ≠£Âú®‰ΩøÁî®HTMLÂëàÁé∞ <a href="/docs/react-dom-server.html">ReactDOMServer API</a>, Âπ∂‰∏î</li>
<li>ÊÇ®ÁöÑÂ∫îÁî®Á®ãÂ∫èÂú®<strong>HTMLÊ†áËÆ∞‰∏≠ÂåÖÂê´Áî®Êà∑Êèê‰æõÁöÑÂ±ûÊÄßÂêç</strong>„ÄÇ</li>
</ul>
<p>ÂÖ∑‰ΩìËØ¥ÔºåËÑÜÂº±Ê®°ÂºèÂ∞±ÂÉè‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">props<span class="token punctuation">[</span>userProvidedData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
</span><span class="token keyword">let</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> html <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>‰∏∫‰∫ÜÂà©Áî®Ëøô‰∏™ËÑÜÂº±Ê®°ÂºèÔºåÊîªÂáªËÄÖÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™Ëß¶Âèë XSS ÊºèÊ¥ûÁöÑÁâπÊÆäÂ±ûÊÄßÂêç„ÄÇ‰æãÂ¶ÇÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">let</span> userProvidedData <span class="token operator">=</span> <span class="token string">'>&lt;/div>&lt;script>alert("hi")&lt;/script>'</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>In the vulnerable versions of <code class="gatsby-code-text">react-dom/server</code>, the output would let the attacker inject arbitrary markup:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-html"><code class="gatsby-code-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>In the versions after the vulnerability was <a href="https://github.com/facebook/react/pull/13302">fixed</a> (and before it was introduced), attributes with invalid names are skipped:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-html"><code class="gatsby-code-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>You would also see a warning about an invalid attribute name.</p>
<p>Note that <strong>we expect attribute names based on user input to be very rare in practice.</strong> It doesn‚Äôt serve any common practical use case, and has other potential security implications that React can‚Äôt guard against.</p>
<h2 id="ÂÆâË£Ö"><a href="#%E5%AE%89%E8%A3%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂÆâË£Ö</h2>
<p>React 16.4.2 ÁâàÊú¨ÂèØ‰ª•Âú® npm ‰∏äËé∑Âèñ„ÄÇ</p>
<p>‰ΩøÁî® Yarn ÂÆâË£Ö React 16 ÁâàÊú¨ÔºåËøêË°å‰∏ãÈù¢ÁöÑÂëΩ‰ª§Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash">yarn add react@^16.4.2 react-dom@^16.4.2
</code></pre>
      </div>
<p>‰ΩøÁî® npm ÂÆâË£Ö React 16 ÁâàÊú¨ÔºåËøêË°å‰∏ãÈù¢ÁöÑÂëΩ‰ª§Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash"><span class="token function">npm</span> <span class="token function">install</span> --save react@^16.4.2 react-dom@^16.4.2
</code></pre>
      </div>
<p>Êàë‰ª¨‰πüÊèê‰æõ‰∫ÜÈÄöËøá CDN ÁöÑÊñπÂºè UMD Âª∫Á´ãReactÁöÑÊñπÊ≥ïÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-html"><code class="gatsby-code-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react@16/umd/react.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react-dom@16/umd/react-dom.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>ÁÇπÂáªÈìæÊé•Ëé∑Âèñ <a href="/docs/installation.html">Êõ¥ËØ¶ÁªÜÁöÑÂÆâË£ÖÊïôÁ®ã</a>.</p>
<h2 id="Êõ¥Êñ∞Êó•Âøó"><a href="#%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êõ¥Êñ∞Êó•Âøó</h2>
<h3 id="react-dom-ÊúçÂä°Âô®"><a href="#react-dom-%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React DOM ÊúçÂä°Âô®</h3>
<ul>
<li>
<p>Fix a potential XSS vulnerability when the attacker controls an attribute name (<code class="gatsby-code-text">CVE-2018-6341</code>). This fix is available in the latest <code class="gatsby-code-text">react-dom@16.4.2</code>, as well as in previous affected minor versions: <code class="gatsby-code-text">react-dom@16.0.1</code>, <code class="gatsby-code-text">react-dom@16.1.2</code>, <code class="gatsby-code-text">react-dom@16.2.1</code>, and <code class="gatsby-code-text">react-dom@16.3.3</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/13302">#13302</a>)</p>
</li>
<li>
<p>Fix a crash in the server renderer when an attribute is called <code class="gatsby-code-text">hasOwnProperty</code>. This fix is only available in <code class="gatsby-code-text">react-dom@16.4.2</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/13303">#13303</a>)</p>
</li>
</ul>]]></description><link>https://doc.react-china.org/blog/2018/08/01/react-v-16-4-2.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/08/01/react-v-16-4-2.html</guid><pubDate>Wed, 01 Aug 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[You Probably Don't Need Derived State]]></title><description><![CDATA[<p>React 16.4  <a href="/blog/2018/05/23/react-v-16-4.html#bugfix-for-getderivedstatefromprops">‰øÆÂ§ç‰∫Ü‰∏Ä‰∏™ÂÖ≥‰∫é getDerivedStateFromProps ÁöÑ bug</a>„ÄÇËã•ËøôÁØáÊñáÁ´†ÊèêÂèä‰∫Ü‰Ω†Â∫îÁî®‰∏≠Ê≠£Âú®‰ΩøÁî®ÁöÑÂèçÊ®°ÂºèÔºåÂπ∂Âú®‰øÆÂ§çÂêéÂØºËá¥‰∫ÜÊó†Ê≥ïÊ≠£Á°ÆÂ∑•‰ΩúÔºåÊàë‰ª¨ÂØπÊ≠§ÊÑüÂà∞Êä±Ê≠â„ÄÇÂú®ËøôÁØáÊñáÁ´†ÔºåÊàë‰ª¨Â∞ÜÂØπÂú®Ê¥æÁîüÁä∂ÊÄÅ‰∏ãÊôÆÈÅç‰ΩøÁî®ÁöÑÂèçÊ®°Âºè‰ª•ÂèäÊàë‰ª¨ÂÄæÂêëÁöÑÈÄâÊã©ÊñπÊ°àËøõË°åËØ¥Êòé„ÄÇ</p>
<p>Âú®ÂæàÈïøÁöÑ‰∏ÄÊÆµÊó∂Èó¥ÔºåÁîüÂëΩÂë®Êúü <code class="gatsby-code-text">componentWillReceiveProps</code> ÊòØÂîØ‰∏ÄÁöÑËÉΩÂ§üÂú® props ÂèòÊõ¥Êó∂Êõ¥Êñ∞Áä∂ÊÄÅËÄå‰∏çËß¶ÂèëÊ∏≤ÊüìÁöÑÂîØ‰∏ÄÊñπÂºè„ÄÇÂú® 16.3Ôºå<a href="https://reactjs.org/blog/2018/03/29/react-v-16-3.html#component-lifecycle-changes">Êàë‰ª¨ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™Êõø‰ª£ÁöÑÁîüÂëΩÂë®ÊúüÔºå<code class="gatsby-code-text">getDerivedStateFromProps</code></a> Áî®‰ª•Êõ¥ÂÆâÂÖ®ÁöÑÊñπÂºèÊù•Ëß£ÂÜ≥ÂêåÊ†∑ÁöÑÈóÆÈ¢ò„ÄÇÂêåÊó∂ÔºåÊàë‰ª¨ÊÑèËØÜÂà∞Êúâ‰∫õÁî®Êà∑ÂèØËÉΩ‰ºöÂØπÂ¶Ç‰Ωï‰ΩøÁî®Ëøô‰∏§‰∏™ÊñπÊ≥ïÊúâÂæàÂ§öËØØËß£ÔºåÊàë‰ª¨‰πüÂèëÁé∞‰∫Ü‰∏Ä‰∫õÂèçÊ®°Âºè‰ºöÂØºËá¥ÊΩúÂú®ÁöÑ‰ª§‰∫∫Âõ∞ÊÉëÁöÑ bug„ÄÇÂú® 16.4 ‰∏≠‰øÆÂ§çÁöÑ <code class="gatsby-code-text">getDerivedStateFromProps</code> <a href="https://github.com/facebook/react/issues/12898">‰ΩøÂæóÊ¥æÁîüÁä∂ÊÄÅ‰ºöÊõ¥ÂÆπÊòìÈ¢ÑÊµã</a>ÔºåÂõ†Ê≠§‰∏Ä‰∫õÈîôËØØÁöÑÁî®‰æã‰ºöÊõ¥ÂÆπÊòìÊ≥®ÊÑèÂà∞„ÄÇ</p>
<blockquote>
<p>Ê≥®ÊÑè</p>
<p>Êú¨ÊñáÊâÄÊèêÂèäÁöÑÂèçÊ®°ÂºèÂêåÊó∂Â∫îÁî®‰∫Ü <code class="gatsby-code-text">componentWillReceivedProps</code> Âíå <code class="gatsby-code-text">getDerivedStateFromProps</code> ‰∏§‰∏™ÊñπÊ≥ï„ÄÇ</p>
</blockquote>
<p>Êú¨ÊñáÂ∞ÜÊ∂µÁõñ‰ª•‰∏ã‰∏ªÈ¢òÔºö</p>
<ul>
<li><a href="#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8%E6%B4%BE%E7%94%9F%E7%8A%B6%E6%80%81">‰ΩïÊó∂‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅ</a></li>
<li>
<p><a href="#%E4%BD%BF%E7%94%A8%E6%B4%BE%E7%94%9F%E7%8A%B6%E6%80%81%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅÁöÑ‰∏Ä‰∫õÂ∏∏ËßÅÈóÆÈ¢ò</a></p>
<ul>
<li>[ÂèçÊ®°ÂºèÔºöÊó†Êù°‰ª∂Âú∞Â∞Ü props Êã∑Ë¥ùÂà∞Áä∂ÊÄÅ‰∏ä](#ÂèçÊ®°ÂºèÔºöÊó†Êù°‰ª∂Âú∞Â∞Ü props Êã∑Ë¥ùÂà∞Áä∂ÊÄÅ‰∏ä)</li>
<li>[ÂèçÊ®°ÂºèÔºöÂΩì props Êõ¥Êñ∞Êó∂Êì¶Èô§Áä∂ÊÄÅ](#ÂèçÊ®°ÂºèÔºöÂΩì props Êõ¥Êñ∞Êó∂Êì¶Èô§Áä∂ÊÄÅ)</li>
</ul>
</li>
<li><a href="#%E6%9B%B4%E5%A5%BD%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">Êõ¥Â•ΩÁöÑËß£ÂÜ≥ÊñπÊ°à</a></li>
<li><a href="#%E8%AE%B0%E5%BF%86%E5%8C%96%EF%BC%88memoization%EF%BC%89%E6%98%AF%E5%90%A6%E5%8F%AF%E8%A1%8C%EF%BC%9F">ËÆ∞ÂøÜÂåñÔºàmemoizationÔºâÊòØÂê¶ÂèØË°åÔºü</a></li>
</ul>
<h2 id="‰ΩïÊó∂‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅ"><a href="#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8%E6%B4%BE%E7%94%9F%E7%8A%B6%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>‰ΩïÊó∂‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅ</h2>
<p><code class="gatsby-code-text">getDerivedStateFromeProps</code> Â≠òÂú®‰ªÖÊúâ‰∏Ä‰∏™ÁõÆÁöÑ„ÄÇÂÖ∂ËÉΩÂ§üËÆ©ÁªÑ‰ª∂Âú® <strong>prop ÂèòÊõ¥Êó∂</strong> Êõ¥Êñ∞ÂÜÖÈÉ®ÁöÑÁä∂ÊÄÅ„ÄÇÊàë‰ª¨‰πãÂâçÁöÑÂçöÊñáÊèê‰æõ‰∫Ü‰∏Ä‰∫õ‰æãÂ≠êÔºå‰æãÂ¶Ç<a href="/blog/2018/03/27/update-on-async-rendering.html#updating-state-based-on-props">Âü∫‰∫éÂΩìÂâçÂèòÊõ¥ÁöÑÂÅèÁßªÔºàoffsetÔºâprop ËÆ∞ÂΩïÂΩìÂâçÁöÑÊªöÂä®ÊñπÂêë</a> ÊàñËÄÖ <a href="/blog/2018/03/27/update-on-async-rendering.html#fetching-external-data-when-props-change">ÈÄöËøáËµÑÊ∫ê prop Âä†ËΩΩÈ¢ùÂ§ñÁöÑÁâπÂÆöËµÑÊ∫ê</a>„ÄÇ </p>
<p>Êàë‰ª¨Ê≤°ÊúâÊèê‰æõÊõ¥Â§öÁöÑ‰æãÂ≠êÔºåÂõ†‰∏∫‰Ωú‰∏∫‰∏Ä‰∏™ÈÄöÁî®ËßÑÂàôÔºå<strong>Ê¥æÁîüÁä∂ÊÄÅÂ∫îË∞®ÊÖé‰ΩøÁî®</strong>„ÄÇÊàë‰ª¨ÊâÄËßÅËøáÁöÑÊâÄÊúâÁöÑÁî±Ê¥æÁîüÁä∂ÊÄÅÂØºËá¥ÁöÑÈóÆÈ¢òÊúÄÁªàÈÉΩÂèØÂΩíÁªì‰∏∫Ôºà1ÔºâÊó†Êù°‰ª∂ÁöÑÈÄöËøá props Êù•Êõ¥Êñ∞Áä∂ÊÄÅÊàñÔºà2ÔºâÊó†ËÆ∫ props ÊòØÂê¶Âíå Áä∂ÊÄÅÂåπÈÖçÈÉΩÊõ¥Êñ∞Áä∂ÊÄÅ„ÄÇÔºàÊàë‰ª¨Â∞ÜÂú®Êé•‰∏ãÊù•Êõ¥‰∏∫ÁªÜËá¥Âú∞Êé¢ËÆ®Ëøô‰∏§‰∏™ÈóÆÈ¢ò„ÄÇÔºâ</p>
<ul>
<li>Ëã•‰Ω†‰ªÖÈÄöËøáÂΩìÂâçÁöÑ props ‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅÊù•ÁºìÂ≠ò‰∏Ä‰∫õËÆ°ÁÆóÊìç‰ΩúÔºåÂàôÊ≤°ÂøÖË¶Å‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅ„ÄÇÂèØÊü•Áúã <a href="#what-about-memoization">ËÆ∞ÂøÜÂåñÊòØÂê¶ÂèØË°åÔºü</a>‰∏ÄËäÇ„ÄÇ</li>
<li>Ëã•‰Ω†Âè™ÊòØÊó†Êù°‰ª∂ÁöÑÊõ¥Êñ∞Ê¥æÁîüÁä∂ÊÄÅÊàñÊó†ËÆ∫ props ÂíåÁä∂ÊÄÅÊòØÂê¶ÂåπÈÖçÈÉΩËøõË°åÊõ¥Êñ∞Ôºå‰Ω†ÁöÑÁªÑ‰ª∂ÂèØËÉΩÂ§™Ëøá‰∫éÈ¢ëÁπÅÁöÑÈáçÁΩÆÂÆÉÁöÑÂÜÖÈÉ®Áä∂ÊÄÅ„ÄÇÁªßÁª≠ÈòÖËØª‰∫ÜËß£Êõ¥Â§öÁªÜËäÇ„ÄÇ</li>
</ul>
<h2 id="‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅÁöÑ‰∏Ä‰∫õÂ∏∏ËßÅÈóÆÈ¢ò"><a href="#%E4%BD%BF%E7%94%A8%E6%B4%BE%E7%94%9F%E7%8A%B6%E6%80%81%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅÁöÑ‰∏Ä‰∫õÂ∏∏ËßÅÈóÆÈ¢ò</h2>
<p>ÊúØËØ≠ <a href="/docs/forms.html#controlled-components">‚ÄúÂèóÊéß‚Äù</a> Âíå <a href="/docs/uncontrolled-components.html">‚ÄúÈùûÂèóÊéß‚Äù</a> ÈÄöÂ∏∏ÊåáÁöÑÊòØË°®ÂçïÁöÑËæìÂÖ•Ê°ÜÔºå‰ΩÜÂÆÉ‰ª¨‰πüÂèØÁî®‰∫éÊèèËø∞ÁªÑ‰ª∂ÁöÑÊï∞ÊçÆÁöÑÁîüÂëΩÂë®Êúü„ÄÇ‰Ωú‰∏∫ props ‰º†ÈÄíÁªÑ‰ª∂ÂèØ‰ª•ËÆ§‰∏∫ÊòØ <strong>ÂèóÊéß</strong>ÁöÑÔºàÂõ†‰∏∫Áà∂ÁªÑ‰ª∂<em>ÊéßÂà∂</em>ÈÇ£√ü‰∫õÊï∞ÊçÆÔºâ„ÄÇ‰ªÖÂ≠òÂú®‰∫éÂÜÖÈÉ®Áä∂ÊÄÅÁöÑÊï∞ÊçÆÂàôÂèØ‰ª•ËÆ§‰∏∫ÊòØ<strong>ÈùûÂèóÊéßÁöÑ</strong>ÔºàÂõ†‰∏∫Áà∂ÁªÑ‰ª∂Êó†Ê≥ïÁõ¥Êé•ÊîπÂèòÂÆÉÔºâ„ÄÇ</p>
<p>Ê¥æÁîüÁªÑ‰ª∂ÊúÄÂ∏∏ËßÅÁöÑÈîôËØØÊòØÊ∑∑Ê∑Ü‰∫ÜËøô‰∏§ËÄÖÔºõÂΩì‰∏Ä‰∏™Ê¥æÁîüÁä∂ÊÄÅÁöÑÂÄº‰πüËÉΩÈÄöËøá <code class="gatsby-code-text">setState</code> Ë∞ÉÁî®Êù•Êõ¥Êñ∞Êó∂Ôºå‰πãÂâçÂú®<a href="/blog/2018/03/27/update-on-async-rendering.html#fetching-external-data-when-props-change">È¢ùÂ§ñÁöÑÊï∞ÊçÆÂä†ËΩΩ‰æãÂ≠ê</a>ÂèØËÉΩÂê¨Ëµ∑Êù•Êúâ‰∫õÁ±ª‰ººÔºå‰ΩÜÂú®‰∏Ä‰∫õÈáçË¶ÅÁöÑÊñπÂºè‰∏äÂ≠òÂú®ÁùÄÂ∑ÆÂºÇ„ÄÇÂú®Âä†ËΩΩÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂØπ‰∫é ‚Äúsource‚Äù prop Âíå ‚Äúloading‚Äù Áä∂ÊÄÅÈÉΩÊúâ‰∏Ä‰∏™Ê∏ÖÊô∞ÁöÑÊù•Ê∫ê„ÄÇÂΩì source prop ÂèëÁîüÊîπÂèòÔºåloading Áä∂ÊÄÅÂàôÂ∫îÂΩì<strong>Ê∞∏Ëøú</strong>Ë¢´ÈáçÂÜô„ÄÇÂèçËøáÊù•Ôºå‰ªÖÂΩì prop <strong>ÂèëÁîüÊîπÂèò</strong>Âπ∂‰∏îÁî±ÁªÑ‰ª∂ÁÆ°ÁêÜÊó∂ÔºåÁä∂ÊÄÅÊâç‰ºöË¢´ÈáçÂÜô„ÄÇ</p>
<p>ÂΩìËøô‰∫õÁ∫¶ÊùüÁöÑ‰ªª‰Ωï‰∏ÄÊù°Ë¢´ÊîπÂèòÈÉΩ‰ºöÂºïÂèëÈóÆÈ¢ò„ÄÇÂÖ∏ÂûãÁöÑÊÉÖÂÜµÊòØÂú®‰∏§‰∏™Ë°®Âçï‰∏ã„ÄÇËÆ©Êàë‰ª¨Êù•Áúã‰∏™‰æãÂ≠ê„ÄÇ</p>
<h3 id="ÂèçÊ®°ÂºèÔºöÊó†Êù°‰ª∂Âú∞Â∞Ü-props-Êã∑Ë¥ùÂà∞Áä∂ÊÄÅ‰∏ä"><a href="#%E5%8F%8D%E6%A8%A1%E5%BC%8F%EF%BC%9A%E6%97%A0%E6%9D%A1%E4%BB%B6%E5%9C%B0%E5%B0%86-props-%E6%8B%B7%E8%B4%9D%E5%88%B0%E7%8A%B6%E6%80%81%E4%B8%8A" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂèçÊ®°ÂºèÔºöÊó†Êù°‰ª∂Âú∞Â∞Ü props Êã∑Ë¥ùÂà∞Áä∂ÊÄÅ‰∏ä</h3>
<p>‰∏Ä‰∏™ÊôÆÈÅçÁöÑËØØËß£ÊòØ <code class="gatsby-code-text">getDerivedStateFromProps</code> Âíå <code class="gatsby-code-text">componentWillReceiveProps</code> ‰ªÖÂú® props ÊîπÂèòÊó∂Ë¢´Ë∞ÉÁî®„ÄÇËøô‰∫õÁîüÂëΩÂë®Êúü‰ºöÂú®Áà∂ÁªÑ‰ª∂ÈáçÊñ∞Ê∏≤ÊüìÊó∂Ë¢´Ë∞ÉÁî®ÔºåÊó†ËÆ∫ÂÖ∂ props ÊòØÂê¶Âíå‰πãÂâçÊúâ‰∏çÂêå„ÄÇÁî±‰∫éËøô‰∏ÄÂéüÂõ†ÔºåÊÄªÊòØ<em>Êó†Êù°‰ª∂</em>Âú∞‰ΩøÁî®Ëøô‰∫õÁîüÂëΩÂë®ÊúüÈáçËΩΩÁä∂ÊÄÅÊòØ‰∏çÂÆâÂÖ®ÁöÑ„ÄÇ<strong>Ëøô‰πàÂÅöÂèØËÉΩ‰ºöÂØºËá¥Êõ¥Êñ∞Áä∂ÊÄÅÁöÑ‰∏¢Â§±„ÄÇ</strong></p>
<p>ËÄÉËôë‰∏Ä‰∏™ÊèèËø∞‰∫ÜËøô‰∏ÄÈóÆÈ¢òÁöÑ‰æãÂ≠ê„ÄÇÊúâ‰∏Ä‰∏™Â∞Ü email prop Â§çÂà∂Âà∞Áä∂ÊÄÅÁöÑ <code class="gatsby-code-text">EmailInput</code> ÁöÑÁªÑ‰ª∂Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">EmailInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>email <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>email<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> event <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> email<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// This will erase any local state updates!</span>
    <span class="token comment">// Do not do this.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> email<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>email <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>È¶ñÂÖàÔºåËØ•ÁªÑ‰ª∂ÁúãËµ∑Êù•Ê≤°ÈóÆÈ¢ò„ÄÇÁä∂ÊÄÅÈÄöËøáÁâπÂÆöÁöÑ prop ËøõË°åÂàùÂßãÂåñÂπ∂ÂΩìÊàë‰ª¨Âú® <code class="gatsby-code-text">&lt;input&gt;</code> ‰∏≠ËæìÂÖ•Êó∂ËøõË°åÊõ¥Êñ∞„ÄÇ‰ΩÜÂ¶ÇÊûúÊàë‰ª¨ÁªÑ‰ª∂ÁöÑÁà∂ÂÖÉÁ¥†ÈáçÊ∏≤Ôºå‰ªª‰ΩïÊàë‰ª¨Âú® <code class="gatsby-code-text">&lt;input&gt;</code> ‰∏≠ÁöÑËæìÂÖ•ÈÉΩÂ∞Ü‰∏¢Â§±ÔºÅÔºà<a href="https://codesandbox.io/s/m3w9zn1z8x">Êü•ÁúãËøô‰∏Ä‰æãÂ≠ê„ÄÇ</a>ÔºâÂç≥‰ΩøÊàë‰ª¨Âú®ÈáçÁΩÆÂâçÂØπ <code class="gatsby-code-text">nextProps.email !== this.state.email</code> ËøõË°åÊØîËæÉÔºå‰ªçËøîÂõûÁúü„ÄÇ</p>
<p>Âú®Ëøô‰∏Ä‰æãÂ≠ê‰∏≠ÔºåÂ¢ûÂä† <code class="gatsby-code-text">shouldComponentUpdate</code> ÊñπÊ≥ï‰øùËØÅÂΩì‰∏î‰ªÖÂΩì email prop ÂèëÁîüÂèòÊõ¥Êó∂ÊâçËøõË°åÈáçÊ∏≤ÂèØËÉΩËÉΩ‰øÆÂ§çËØ•ÈóÆÈ¢ò„ÄÇÁÑ∂ËÄåÂú®ÂÆûË∑µ‰∏≠ÔºåÁªÑ‰ª∂ÈÄöÂ∏∏ÂèØ‰ª•Êé•ÂèóÂ§ö‰∏™ propsÔºõÂè¶‰∏Ä‰∏™ prop ÁöÑÂèòÊõ¥‰ªç‰ºöÂØºËá¥ÈáçÊ∏≤Âπ∂ËøõË°åÈîôËØØÁöÑÈáçÁΩÆ„ÄÇÂáΩÊï∞ÂíåÂØπË±°Á±ªÂûãÁöÑ props Â∏∏ÈÄöËøáÂÜÖËÅîÁöÑÂΩ¢ÂºèÂàõÂª∫Ôºå‰ΩøÂæóÂÖ∂ÂæàÈöæÂÆûÁé∞‰∏Ä‰∏™ÂèØÈù†ÁöÑ <code class="gatsby-code-text">shouldComponentUpdate</code> ‰øùËØÅÂΩì‰∏î‰ªÖÂΩìÂÖÉÁ¥†ÂèòÊõ¥Êó∂ÊâçËøîÂõûÁúüÂÄº„ÄÇ<a href="https://codesandbox.io/s/jl0w6r9w59">Ëøô‰∏Ä‰æãÂ≠êÊèèËø∞‰∫ÜÂÖ∑‰ΩìÁöÑÂÜÖÂÆπ„ÄÇ</a>ÊúÄÁªàÔºå<code class="gatsby-code-text">shouldComponentUpdate</code> ÊúÄÂ•ΩÁî®‰∫éÊÄßËÉΩ‰ºòÂåñÔºåËÄå‰∏çÊòØ‰øùËØÅÊ¥æÁîüÁä∂ÊÄÅÁöÑÊ≠£Á°ÆÊÄß„ÄÇ</p>
<p>Â∏åÊúõÁé∞Âú®ÂØπ‰∫é‰∏∫‰Ωï<strong>Êó†Êù°‰ª∂Âú∞Â∞Ü prop Â§çÂà∂Âà∞Áä∂ÊÄÅÊòØ‰∏™Á≥üÁ≥ïÁöÑÁêÜÂøµ</strong>Â∑≤ÁªèËß£ÈáäÊ∏ÖÊ•ö‰∫Ü„ÄÇÂú®ÂõûÈ°æÂèØË°åÁöÑËß£ÂÜ≥ÊñπÊ°àÂâçÔºåÂÖàÊù•Áúã‰∏Ä‰∏™Áõ∏ÂÖ≥ÁöÑÈóÆÈ¢òÊ®°ÂºèÔºöË¶ÅÊòØÊàë‰ª¨‰ªÖÂú® email prop ÂèëÁîüÂèòÊõ¥Êó∂ÊâçÊõ¥Êñ∞Â¶Ç‰ΩïÔºü</p>
<h3 id="ÂèçÊ®°ÂºèÔºöÂΩì-props-Êõ¥Êñ∞Êó∂Êì¶Èô§Áä∂ÊÄÅ"><a href="#%E5%8F%8D%E6%A8%A1%E5%BC%8F%EF%BC%9A%E5%BD%93-props-%E6%9B%B4%E6%96%B0%E6%97%B6%E6%93%A6%E9%99%A4%E7%8A%B6%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂèçÊ®°ÂºèÔºöÂΩì props Êõ¥Êñ∞Êó∂Êì¶Èô§Áä∂ÊÄÅ</h3>
<p>ÁªßÁª≠‰πãÂâçÁöÑ‰æãÂ≠êÔºåÊàë‰ª¨ÂèØ‰ª•‰ªÖÂΩì <code class="gatsby-code-text">props.email</code> ÂèòÊõ¥Êó∂ËøõË°åÊõ¥Êñ∞Êù•ÈÅøÂÖçÊÑèÂ§ñÁöÑÊì¶Èô§Áä∂ÊÄÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">EmailInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>email
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Any time props.email changes, update state.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>email <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>email
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<blockquote>
<p>Ê≥®ÊÑè</p>
<p>Âç≥‰Ωø‰πãÂâçÁöÑ‰æãÂ≠êÂ±ïÁ§∫‰∫Ü <code class="gatsby-code-text">componentWillReceiveProps</code>ÔºåÂÖ∂Âíå‰ΩøÁî® <code class="gatsby-code-text">getDerivedStateFromProps</code> ‰∏ÄÊ†∑ÊòØÂèçÊ®°Âºè„ÄÇ</p>
</blockquote>
<p>Êàë‰ª¨ÂÅö‰∫Ü‰∏Ä‰∏™Â∑®Â§ßÁöÑÊèêÂçá„ÄÇÁé∞Âú®Êàë‰ª¨ÁöÑÁªÑ‰ª∂‰ªÖÂΩì props ÁúüÁöÑÊîπÂèòÊó∂Êâç‰ºöÊì¶Èô§Êàë‰ª¨ÁöÑËæìÂÖ•„ÄÇ</p>
<p>Ëøô‰ªçÁÑ∂Â≠òÂú®‰∏Ä‰∏™ÊΩúÂú®ÁöÑÈóÆÈ¢ò„ÄÇÊÉ≥Ë±°‰∏Ä‰∏™‰ΩøÁî®‰∫Ü‰πãÂâçËæìÂÖ•Ê°ÜÁªÑ‰ª∂ÁöÑÂØÜÁ†ÅÁÆ°ÁêÜÂ∫îÁî®„ÄÇÂΩìÂÆö‰ΩçÂà∞‰∫Ü‰ΩøÁî®Áõ∏ÂêåÈÇÆÁÆ±ÁöÑ‰∏§‰∏™Ë¥¶Êà∑ÔºåËæìÂÖ•Ê°ÜÂ∞ÜÊó†Ê≥ïËøõË°åÈáçËÆæ„ÄÇËøôÊòØÁî±‰∫é‰∏§‰∏™Ë¥¶Êà∑‰º†ÈÄíÁªôÁªÑ‰ª∂ÁöÑÂÄºÈÉΩÊòØÁõ∏ÂêåÁöÑÔºÅËøôÂèØËÉΩ‰ºöËÆ©Áî®Êà∑ÊÑüÂà∞ËØßÂºÇÔºåÁî±‰∫éÁ¢∞Â∑ß‰ΩøÁî®‰∫ÜÁõ∏ÂêåÁöÑÈÇÆÁÆ±ÔºåÂØπ‰∫é‰∏Ä‰∏™Ë¥¶Êà∑ÁöÑ‰∏çÂÆâÂÖ®ÂèòÊõ¥ÁöÑÂá∫Áé∞‰ºöÂΩ±ÂìçÂà∞ÂÖ∂‰ªñË¥¶Êà∑„ÄÇÔºà<a href="https://codesandbox.io/s/mz2lnkjkrx">ÁÇπÂáªÊü•ÁúãÊ°à‰æã„ÄÇ</a>Ôºâ</p>
<p>Ëøô‰∏ÄËÆæËÆ°Â≠òÂú®ÊΩúÂú®ÁöÑÁº∫Èô∑Ôºå‰ΩÜÂç¥ÂæàÂÆπÊòìÁäØ„ÄÇÔºà<a href="https://twitter.com/brian_d_vaughn/status/959600888242307072">ÊàëËá™Â∑±‰πüÊõæÂá∫ÈîôËøáÔºÅ</a>ÔºâÂπ∏ËøêÁöÑÊòØÊúâ‰∏§ÁßçÊõø‰ª£ÊñπÊ°àÊïàÊûúÊõ¥Â•Ω„ÄÇ‰∫åËÄÖÁöÑÂÖ≥ÈîÆÂú®‰∫é <strong>ÂØπ‰∫éÊï∞ÊçÆÁöÑ‰ªª‰ΩïÈÉ®ÂàÜÔºå‰Ω†ÈúÄË¶Å‰øùËØÅÂÖ∂ÊòØ‰∏Ä‰∏™ÁªÑ‰ª∂ÂîØ‰∏ÄÊï∞ÊçÆÊ∫êÔºåÂπ∂ÈÅøÂÖçÂ∞ÜÂÖ∂Â§çÂà∂ÁªôÂÖ∂‰ªñÁªÑ‰ª∂„ÄÇ</strong>Áé∞Âú®Êù•Áúã‰∏Ä‰∏ãÊØèÁßçÊõø‰ª£ÁöÑÊñπÊ°à„ÄÇ</p>
<h2 id="Êõ¥Â•ΩÁöÑËß£ÂÜ≥ÊñπÊ°à"><a href="#%E6%9B%B4%E5%A5%BD%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êõ¥Â•ΩÁöÑËß£ÂÜ≥ÊñπÊ°à</h2>
<h3 id="Êé®ËçêÊñπÊ°àÔºöÂÆåÂÖ®ÂèóÊéßÁªÑ‰ª∂"><a href="#%E6%8E%A8%E8%8D%90%E6%96%B9%E6%A1%88%EF%BC%9A%E5%AE%8C%E5%85%A8%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êé®ËçêÊñπÊ°àÔºöÂÆåÂÖ®ÂèóÊéßÁªÑ‰ª∂</h3>
<p>‰∏ÄÁßçÂèØ‰ª•ÈÅøÂÖç‰πãÂâçÊèêÂà∞ÁöÑÈóÆÈ¢òÁöÑÊñπÂºèÊòØÂ∞ÜÁä∂ÊÄÅ‰ªéÊàë‰ª¨ÁöÑÁªÑ‰ª∂‰∏≠ÂÆåÂÖ®ÁßªÈô§„ÄÇÂ¶ÇÊûúÈÇÆÁÆ±Âú∞ÂùÄ‰ªÖ‰Ωú‰∏∫ prop Â≠òÂú®ÔºåËÄåÂêéÊàë‰ª¨Â∞±‰∏çÈúÄË¶ÅÊãÖÂøÉÂíåÁä∂ÊÄÅ‰∫ßÁîüÂÜ≤Á™ÅÁöÑÈóÆÈ¢ò„ÄÇÊàë‰ª¨ÁîöËá≥ÂèØ‰ª•Â∞Ü <code class="gatsby-code-text">EmailInput</code> Âèò‰∏∫‰∏Ä‰∏™ËΩªÈáèÁöÑÂáΩÊï∞ÁªÑ‰ª∂Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">function</span> <span class="token function">EmailInput</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>onChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>email<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Ëøô‰∏ÄÊñπÊ≥ïÁÆÄÂåñ‰∫ÜÊàë‰ª¨ÁöÑÁªÑ‰ª∂ÂÆûÁé∞Ôºå‰ΩÜÂ¶ÇÊûú‰ªçÊÉ≥Ë¶Å‰øùÂ≠ò‰∏Ä‰∏™‰∏¥Êó∂ÁöÑÂÄºÔºåÁé∞Âú®ÈúÄË¶ÅÁà∂ÁªÑ‰ª∂ÂéªÊâãÂä®ËøõË°åË∞ÉÊï¥„ÄÇÔºà<a href="https://codesandbox.io/s/7154w1l551">ÁÇπÂáªÊü•ÁúãËøô‰∏ÄÊ®°ÂºèÁ§∫‰æã„ÄÇ</a>Ôºâ</p>
<h3 id="Êé®ËçêÊñπÊ°àÔºöÂ∏¶-key-ÁöÑÂÆåÂÖ®‰∏çÂèóÊéßÁªÑ‰ª∂"><a href="#%E6%8E%A8%E8%8D%90%E6%96%B9%E6%A1%88%EF%BC%9A%E5%B8%A6-key-%E7%9A%84%E5%AE%8C%E5%85%A8%E4%B8%8D%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êé®ËçêÊñπÊ°àÔºöÂ∏¶ <code class="gatsby-code-text">key</code> ÁöÑÂÆåÂÖ®‰∏çÂèóÊéßÁªÑ‰ª∂</h3>
<p>Âè¶‰∏Ä‰∏™ÂØπ‰∫éÊàë‰ª¨ÁªÑ‰ª∂Êù•ËØ¥ÂèØË°åÁöÑÊõø‰ª£ÊñπÊ°àÊòØÂÆåÂÖ®Áî±Êàë‰ª¨ÁöÑÁªÑ‰ª∂Êù•‚ÄúÂÆö‰πâ‚Äù email Áä∂ÊÄÅ„ÄÇÂú®Ëøô‰∏ÄÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÁöÑÁªÑ‰ª∂‰ªçÊé•Âèó‰∏Ä‰∏™ prop ‰Ωú‰∏∫<em>ÂàùÂßã</em>ÂÄºÔºå‰ΩÜÂÖ∂‰ºöÂøΩÁï•ËØ• prop ÂèØËÉΩÁöÑÂèòÊõ¥Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">EmailInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultEmail <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> event <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> email<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>email<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>‰∏∫‰∫Ü‰øùËØÅÂΩì‰º†ÂÖ•‰∏Ä‰∏™‰∏çÂêåÁöÑÂÜÖÂÆπÊó∂ËÉΩÈáçËÆæËØ•ÂÄºÔºàÁ±ª‰ººÊàë‰ª¨ÁöÑÂØÜÁ†ÅÁÆ°ÁêÜÂô®ÁöÑÂú∫ÊôØÔºâÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™Ë¢´Áß∞‰∏∫ <code class="gatsby-code-text">key</code> ÁöÑÁâπÊÆäÁöÑ React ÁâπÊÄß„ÄÇÂΩì‰∏Ä‰∏™ <code class="gatsby-code-text">key</code> ÂèòÊõ¥Êó∂ÔºåReact Â∞Ü <a href="/docs/reconciliation.html#keys"><em>ÂàõÂª∫</em>‰∏Ä‰∏™Êñ∞ÁöÑÁªÑ‰ª∂ÂÆû‰æãËÄå‰∏çÊòØÊõ¥Êñ∞ÂΩìÂâçÁªÑ‰ª∂</a>„ÄÇKeys ÈÄöÂ∏∏Ë¢´Áî®‰∫éÂä®ÊÄÅÂàóË°®‰ΩÜ‰πüÈÄÇÁî®‰∫éËøôÈáåÁöÑÂú∫ÊôØ„ÄÇÂú®Êàë‰ª¨ÁöÑÊ°à‰æã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®‰ªªÊÑèÊó∂Èó¥‰∏äÂΩìÊñ∞Áî®Êà∑Ë¢´ÈÄâÂÆöÊó∂‰ΩøÁî®Áî®Êà∑ÁöÑ ID ÈáçÂª∫ÈÇÆ‰ª∂ËæìÂÖ•Ê°ÜÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EmailInput</span>
  <span class="token attr-name">defaultEmail</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">.</span>email<span class="token punctuation">}</span></span>
  <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
<span class="token punctuation">/></span></span>
</code></pre>
      </div>
<p>ÊØèÊ¨° ID ÁöÑÂèòÊõ¥Ôºå<code class="gatsby-code-text">EmailInput</code> ÈÉΩ‰ºöÈáçÊñ∞ÂàõÂª∫‰∏îÂÆÉÁöÑÂÜÖÈÉ®Áä∂ÊÄÅÂ∞Ü‰ºöË¢´ÈáçËÆæ‰∏∫ÊúÄÊñ∞ÁöÑ <code class="gatsby-code-text">defaultEmail</code> ÂÄº„ÄÇÔºà<a href="https://codesandbox.io/s/6v1znlxyxn">ÁÇπÂáªÊü•ÁúãËøô‰∏ÄÊ®°Âºè„ÄÇ</a>ÔºâÈÄöËøáËøô‰∏ÄÊñπÂºèÔºå‰Ω†‰∏çÂøÖÁªôÊØè‰∏™ËæìÂÖ•Ê°ÜÊ∑ªÂä†‰∏Ä‰∏™ <code class="gatsby-code-text">key</code>„ÄÇËÄåÁªôÊï¥‰∏™Ë°®ÂçïËÆæÁΩÆ‰∏Ä‰∏™ <code class="gatsby-code-text">key</code> ‰ºº‰πéÊõ¥ÊúâÊÑè‰πâ„ÄÇÊØèÊ¨° key ÂèòÊõ¥Êó∂ÔºåÊâÄÊúâË°®ÂçïÁöÑÂÜÖÈÉ®ÁªÑ‰ª∂Â∞Ü‰ºöÈáçÂª∫Âπ∂Â∏¶Êúâ‰∏Ä‰∏™ÊúÄÊñ∞ÁöÑÂàùÂßãÂÄº„ÄÇ</p>
<p>Âú®Â§ßÂ§öÊï∞Âú∫ÊôØ‰∏ãÔºåËøôÊòØÊúÄÂ•ΩÁöÑÂ§ÑÁêÜÁä∂ÊÄÅÈúÄË¶ÅÂèòÊõ¥ÁöÑÊñπÂºè„ÄÇ</p>
<blockquote>
<p>Ê≥®ÊÑè</p>
<p>Ëøô‰∏ÄÊñπÊòØÂê¨‰∏äÂéªÂèØËÉΩÊØîËæÉÊÖ¢Ôºå‰ΩÜÊÄßËÉΩ‰∏äÂπ∂Ê≤°ÊúâÊòéÊòæÁöÑÂ∑ÆÂºÇ„ÄÇÂ¶ÇÊûúËØ•ÁªÑ‰ª∂ÂåÖÂê´‰∫ÜÁπÅÈáçÁöÑÈÄªËæëÂ¶ÇÈÄöËøáÂØπÊØî‰º†ÈÄíÁªôÂ≠êÊ†ëÁöÑ prop Êù•ËøõË°åÊõ¥Êñ∞Á≠âÔºå ‰ΩøÁî® key ÁîöËá≥‰ºöÊõ¥Âø´„ÄÇ</p>
</blockquote>
<h4 id="Êõø‰ª£ÊñπÊ°à-1ÔºöÈÄöËøá-id-prop-ÈáçÁΩÆÈùûÂèóÊéßÁªÑ‰ª∂"><a href="#%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88-1%EF%BC%9A%E9%80%9A%E8%BF%87-id-prop-%E9%87%8D%E7%BD%AE%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êõø‰ª£ÊñπÊ°à 1ÔºöÈÄöËøá ID prop ÈáçÁΩÆÈùûÂèóÊéßÁªÑ‰ª∂</h4>
<p>Ëã• <code class="gatsby-code-text">key</code> Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ã‰∏çÁîüÊïàÔºàÂèØËÉΩÊòØ‰π≥Â∞ñÂú®ÂàùÂßãÂåñÊó∂ÈùûÂ∏∏ËÄóÊó∂ÔºâÔºå‰∏Ä‰∏™ÂèØË°å‰ΩÜÈùûÂ∏∏Á¨®ÈáçÁöÑËß£ÂÜ≥ÊñπÊ°àÊòØÂú® <code class="gatsby-code-text">getDerivedStateFromeProps</code> ÊñπÊ≥ïÈáåÁõëÂê¨ ‚ÄúuserID‚Äù ÁöÑÂèòÊõ¥Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">EmailInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultEmail<span class="token punctuation">,</span>
    prevPropsUserID<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>userID
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Any time the current user changes,</span>
    <span class="token comment">// Reset any parts of state that are tied to that user.</span>
    <span class="token comment">// In this simple example, that's just the email.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>userID <span class="token operator">!==</span> state<span class="token punctuation">.</span>prevPropsUserID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        prevPropsUserID<span class="token punctuation">:</span> props<span class="token punctuation">.</span>userID<span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> props<span class="token punctuation">.</span>defaultEmail
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Â¶ÇÊûúÊàë‰ª¨ÈÄâÊã©‰∫ÜËøô‰∏ÄÊñπÂºèÔºåÂÖ∂‰πüÊèê‰æõ‰∫Ü‰∏ÄÁßçÁÅµÊ¥ªÁöÑÊñπÂºèÊù•‰ªÖÈáçÁΩÆÊàë‰ª¨ÁªÑ‰ª∂ÂÜÖÈÉ®ÁöÑÈÉ®ÂàÜÁä∂ÊÄÅ„ÄÇÔºà<a href="https://codesandbox.io/s/rjyvp7l3rq">ÁÇπÂáªÊü•ÁúãËøô‰∏ÄÊ®°Âºè„ÄÇ</a>Ôºâ</p>
<blockquote>
<p>Note</p>
<p>Even though the example above shows <code class="gatsby-code-text">getDerivedStateFromProps</code>, the same technique can be used with <code class="gatsby-code-text">componentWillReceiveProps</code>.</p>
</blockquote>
<blockquote>
<p>Ê≥®ÊÑè</p>
<p>Âç≥‰Ωø‰πãÂâçÁöÑ‰æãÂ≠ê‰ΩøÁî®‰∫Ü <code class="gatsby-code-text">getDerivedStateFromProps</code>ÔºåÂÖ∂ÂêåÊ†∑‰πüÂèØ‰ª•‰ΩøÁî® <code class="gatsby-code-text">componentWillReceiveProps</code>„ÄÇ</p>
</blockquote>
<h4 id="Êõø‰ª£ÊñπÊ°à-2ÔºöÈÄöËøáÂÆû‰æãÊñπÊ≥ïÈáçÁΩÆÈùûÂèóÊéßÁªÑ‰ª∂"><a href="#%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88-2%EF%BC%9A%E9%80%9A%E8%BF%87%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E9%87%8D%E7%BD%AE%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êõø‰ª£ÊñπÊ°à 2ÔºöÈÄöËøáÂÆû‰æãÊñπÊ≥ïÈáçÁΩÆÈùûÂèóÊéßÁªÑ‰ª∂</h4>
<p>Êõ¥Â∞ëËßÅÁöÑÊòØÔºåÂç≥‰ΩøÊ≤°ÊúâÂêàÈÄÇÁöÑ ID ‰Ωú‰∏∫ <code class="gatsby-code-text">key</code>Ôºå‰Ω†‰πüÈúÄË¶ÅÈáçÁΩÆÁä∂ÊÄÅ„ÄÇ‰∏ÄÁßçËß£ÂÜ≥ÊñπÊ°àÊòØÈáçËÆæ key ‰∏∫‰∏Ä‰∏™ÈöèÊú∫ÂÄºÊàñÊØèÊ¨°ËÆæÁΩÆ‰∏Ä‰∏™‰Ω†ÊúüÊúõÁöÑËá™Â¢ûÁöÑÊï∞Â≠ó„ÄÇÂè¶‰∏ÄÁßçÂèØË°åÁöÑÊõø‰ª£ÊñπÊ°àÊòØÊö¥Èú≤‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ïÊù•Âº∫Âà∂ÈáçÁΩÆÂÜÖÈÉ®Áä∂ÊÄÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">EmailInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    email<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultEmail
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">resetEmailForNewUser</span><span class="token punctuation">(</span>newEmail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> email<span class="token punctuation">:</span> newEmail <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Áà∂Ë°®ÂçïÁªÑ‰ª∂ËÄåÂêéÂèØ‰ª•ÈÄöËøá<a href="/docs/glossary.html#refs">‰ΩøÁî® <code class="gatsby-code-text">ref</code> Êù•Ë∞ÉÁî®Ëøô‰∏ÄÊñπÊ≥ï</a>„ÄÇ(<a href="https://codesandbox.io/s/l70krvpykl">ÁÇπÂáªÊü•ÁúãËøô‰∏Ä‰æãÂ≠ê„ÄÇ</a>)</p>
<p>Ref Âú®ÁâπÂÆöÁöÑÊÉÖÂÜµ‰∏ãÈùûÂ∏∏ÊúâÁî®ÔºåÂ¶ÇËøô‰∏ÄÂú∫ÊôØÔºå‰ΩÜÈÄöÂ∏∏Êàë‰ª¨Êé®Ëçê‰Ω†Â∞ΩÈáè‰∏çË¶Å‰ΩøÁî®„ÄÇÁîöËá≥Âú®Ëøô‰∏ÄÊÉÖÂÜµÔºåËøô‰∏ÄÂº∫Âà∂ÁöÑÊñπÊ≥ïÂπ∂‰∏çÁêÜÊÉ≥ÔºåÂõ†‰∏∫‰ºöÂºïÂèë‰∏§Ê¨°Ê∏≤ÊüìËÄå‰∏çÊòØ‰∏ÄÊ¨°„ÄÇ</p>
<hr>
<h3 id="ÊÄªÁªì"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÊÄªÁªì</h3>
<p>‰Ωú‰∏∫Ê¶ÇÊã¨ÔºåÂΩìÂú®ËÆæËÆ°‰∏Ä‰∏™ÁªÑ‰ª∂Êó∂ÔºåÂÜ≥ÂÆöÂÖ∂Êï∞ÊçÆÊòØÂèóÊéßËøòÊòØÈùûÂèóÊéßÈùûÂ∏∏ÂÖ≥ÈîÆ„ÄÇ</p>
<p>ËÆ©ÁªÑ‰ª∂ÂèòÂæó<strong>ÂèØÊéß</strong>Ôºå‰ª•ÂèäÂú®Áà∂ÁªÑ‰ª∂‰∏≠Â∞Ü‰∏§‰∏™‰∏çÂêåÁöÑÂÄºËøõË°åÂêàÂπ∂ÔºåËÄå‰∏çÊòØ‰ªÖ‰ªÖÂ∞ùËØïÂ∞Ü<strong>prop ÁöÑÂÄº‚ÄúÂ§çÂà∂‚ÄùÂà∞Áä∂ÊÄÅ‰∏≠</strong>„ÄÇ‰æãÂ¶ÇÔºå‰∏éÂÖ∂ËÆ©Â≠êÁªÑ‰ª∂Êé•Âèó‰∏Ä‰∏™‚ÄúÊèê‰∫§‚ÄùÁöÑ <code class="gatsby-code-text">props.value</code> Âπ∂ËøΩË∏™‚ÄúÂèòÊõ¥(draft)‚ÄùÁöÑ <code class="gatsby-code-text">state.value</code>Ôºå‰∏çÂ¶ÇËÆ©Áà∂ÁªÑ‰ª∂ÂêåÊó∂ÁÆ°ÁêÜ <code class="gatsby-code-text">state.draftValue</code> Âíå <code class="gatsby-code-text">state.committedValue</code> Âπ∂Áõ¥Êé•ÊéßÂà∂Â≠êÁªÑ‰ª∂ÁöÑÂÄº„ÄÇËøôËÆ©Êï∞ÊçÆÊµÅÊõ¥‰∏∫Áõ¥Êé•ÂíåÂèØÈ¢ÑÊµã„ÄÇ</p>
<p>ÂØπ‰∫é<strong>ÈùûÂèóÊéß</strong>ÁªÑ‰ª∂ÔºåÂ¶ÇÊûú‰Ω†Â∞ùËØïÂΩì‰∏Ä‰∏™ÁâπÊÆäÁöÑ propÔºàÈÄöÂ∏∏ÊòØ IDÔºâ ÊîπÂèòÊó∂ÈáçÁΩÆÁä∂ÊÄÅÔºåÈÄöÂ∏∏Êúâ‰ª•‰∏ã‰∏Ä‰∫õÈÄâÊã©Ôºö</p>
<ul>
<li><strong>Âª∫ËÆÆÔºö‰ΩøÁî® <code class="gatsby-code-text">key</code> Â±ûÊÄßÊù•ÈáçÁΩÆ<em>ÊâÄÊúâÂÜÖÈÉ®Áä∂ÊÄÅ</em>„ÄÇ</strong></li>
<li>ÊñπÊ°à1ÔºöÁõëÂê¨‰∏Ä‰∫õÁâπÊÆäÂ±ûÊÄßÁöÑÂèòÊõ¥ÔºàÂ¶ÇÔºö<code class="gatsby-code-text">props.userID</code>ÔºâÔºåÈáçÁΩÆ<em>ÁâπÂÆöÁöÑÁä∂ÊÄÅ</em>„ÄÇ</li>
<li>ÊñπÊ°à2ÔºöÂèØ‰ª•ËÄÉËôëÈÄöËøá refs Âº∫Âà∂Ë∞ÉÁî®ÂÆû‰æãÊñπÊ≥ïÊù•ËøõË°åÂà∑Êñ∞„ÄÇ</li>
</ul>
<h2 id="ËÆ∞ÂøÜÂåñÔºàmemoizationÔºâÊòØÂê¶ÂèØË°åÔºü"><a href="#%E8%AE%B0%E5%BF%86%E5%8C%96%EF%BC%88memoization%EF%BC%89%E6%98%AF%E5%90%A6%E5%8F%AF%E8%A1%8C%EF%BC%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËÆ∞ÂøÜÂåñÔºàmemoizationÔºâÊòØÂê¶ÂèØË°åÔºü</h2>
<p>Êàë‰ª¨Â∑≤ÁªèÁúãÂà∞‰∫ÜÊ¥æÁîüÁä∂ÊÄÅË¢´Áî®‰∫éÁ°Æ‰øùÂú® <code class="gatsby-code-text">render</code> ÊñπÊ≥ï‰∏≠‰ªÖÂΩìËæìÂÖ•ÊîπÂèòÊó∂ËøõË°åÈáçÊñ∞ËÆ°ÁÆó„ÄÇËøô‰∏ÄÊäÄÊúØ‰πüË¢´ËÆ§‰∏∫ÊòØ <a href="https://en.wikipedia.org/wiki/Memoization">ËÆ∞ÂøÜÂåñ</a>„ÄÇ</p>
<p>ÂØπ‰∫éËÆ∞ÂøÜÂåñÊù•ËØ¥Ôºå‰ΩøÁî®Ê¥æÁîüÁä∂ÊÄÅÂπ∂‰∏çÁÆóÁ≥üÁ≥ïÔºå‰ΩÜÈÄöÂ∏∏Êù•ËØ¥‰πü‰∏çÁÆóÊúÄ‰Ω≥ÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇÂú®ÁÆ°ÁêÜÊ¥æÁîüÁä∂ÊÄÅÂ≠òÂú®ÁùÄÂÜÖÊ∂µÁöÑÂ§çÊùÇÊÄßÔºåËÄåËøô‰∏ÄÂ§çÊùÇÊÄßÈöèÁùÄÂ¢ûÂä†ÁöÑÂ±ûÊÄß‰πüÂú®‰∏çÊñ≠Âú∞ÊèêÂçá„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúÊàë‰ª¨ÁªôÊàë‰ª¨ÁöÑÁªÑ‰ª∂Â¢ûÂä†‰∫ÜÁ¨¨‰∫å‰∏™Ê¥æÁîüÁä∂ÊÄÅÔºåËÄåÂêéÊàë‰ª¨‰πüÂ∞ÜÂú®ÂàÜÂà´Ë∑üË∏™Ëøô‰∫åËÄÖÁöÑÂèòÊõ¥„ÄÇ</p>
<p>Áé∞Âú®Êù•Áúã‰∏Ä‰∏™Êé•Âèó‰∏Ä‰∏™ props ÁöÑÁªÑ‰ª∂ÁöÑ‰æãÂ≠ê-Â±ïÁ§∫‰∏ÄÁ≥ªÂàóÂÜÖÂÆπÁöÑÂàóË°®-Âπ∂Â∞Ü‰∏éÁî®Êà∑ËæìÂÖ•ÂåπÈÖçÁöÑÊü•ËØ¢Ê∏≤ÊüìÂá∫Êù•„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî®Ê¥æÁîüÁä∂ÊÄÅÊù•Â≠òÂÇ®ËøáÊª§ÂêéÁöÑÂàóË°®Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    filterText<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// *******************************************************</span>
  <span class="token comment">// NOTE: this example is NOT the recommended approach.</span>
  <span class="token comment">// See the examples below for our recommendations instead.</span>
  <span class="token comment">// *******************************************************</span>

  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Re-run the filter whenever the list array or filter text change.</span>
    <span class="token comment">// Note we need to store prevPropsList and prevFilterText to detect changes.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      props<span class="token punctuation">.</span>list <span class="token operator">!==</span> state<span class="token punctuation">.</span>prevPropsList <span class="token operator">||</span>
      state<span class="token punctuation">.</span>prevFilterText <span class="token operator">!==</span> state<span class="token punctuation">.</span>filterText
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        prevPropsList<span class="token punctuation">:</span> props<span class="token punctuation">.</span>list<span class="token punctuation">,</span>
        prevFilterText<span class="token punctuation">:</span> state<span class="token punctuation">.</span>filterText<span class="token punctuation">,</span>
        filteredList<span class="token punctuation">:</span> props<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=></span> item<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> event <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> filterText<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Fragment</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filteredList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Fragment</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>ËØ•ÂÆûÁé∞ÈÅøÂÖç‰∫ÜÊõ¥È¢ëÁπÅÂú∞ÈáçÂ§çËÆ°ÁÆó <code class="gatsby-code-text">filteredList</code>„ÄÇ‰ΩÜÂÖ∂‰πüÊõ¥Â§çÊùÇÔºåÂõ†‰∏∫‰∏çÂæó‰∏çÂçïÁã¨Âú∞ËøΩË∏™ÂíåÁõëÊµãÊØè‰∏Ä‰∏™ prop ÂíåÁä∂ÊÄÅÁöÑÂèòÊõ¥‰ª•‰∏∫‰∫ÜÊ≠£Á°ÆÂú∞Êõ¥Êñ∞ËøáÊª§ÂàóË°®„ÄÇÂú®Ëøô‰∏Ä‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ΩøÁî® <code class="gatsby-code-text">PureComponent</code> ‰ª•ÂèäÂ∞ÜËøáÊª§Êìç‰ΩúÊîæËøõÊ∏≤ÊüìÊñπÊ≥ïÈáåÊù•ËøõË°åÁÆÄÂåñÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token comment">// PureComponents only rerender if at least one state or prop value changes.</span>
<span class="token comment">// Change is determined by doing a shallow comparison of state and prop keys.</span>
<span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>
  <span class="token comment">// State only needs to hold the current filter text value:</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    filterText<span class="token punctuation">:</span> <span class="token string">""</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> event <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> filterText<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The render method on this PureComponent is called only if</span>
    <span class="token comment">// props.list or state.filterText has changed.</span>
    <span class="token keyword">const</span> filteredList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
      item <span class="token operator">=></span> item<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Fragment</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>filteredList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Fragment</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>‰πãÂâçÊèêÂà∞ÁöÑÊñπÊ≥ïÁõ∏ËæÉ‰∫éÊ¥æÁîüÁä∂ÊÄÅÁöÑÁâàÊú¨Ë¶ÅÊõ¥‰∏∫ÁöÑÊ∏ÖÊô∞ÂíåÁÆÄÂçï„ÄÇÊúâÊó∂ÔºåËøôÂØπ‰∫éÂ§ßÂûãÂàóË°®Êù•ËØ¥Ëøô‰∏ÄÊñπÊ≥ïÂ∞±ÂèØËÉΩ‰∏çÈÇ£‰πàÂ•Ω‰∫ÜÊúâÂèØËÉΩ‰ºöÊØîËæÉÊÖ¢Ôºå<code class="gatsby-code-text">PureComponent</code> ‰πüÊúâÂèØËÉΩÊó†Ê≥ïÈòªÊ≠¢ÈáçÊ∏≤ÊüìËã•Âè¶Â§ñÁöÑ prop ÂèëÁîü‰∫ÜÊîπÂèò„ÄÇ‰∏∫‰∫ÜÂ§ÑÁêÜËøô‰∫õÈóÆÈ¢òÔºåÊàë‰ª¨ÂèØ‰ª•Â¢ûÂä†‰∏Ä‰∏™ËÆ∞ÂøÜÂåñÁöÑÂ∏ÆÂä©ÂáΩÊï∞Êù•ÈÅøÂÖç‰∏çÂøÖË¶ÅÁöÑÈáçÊñ∞ËøáÊª§Êàë‰ª¨ÁöÑÂàóË°®È°πÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">import</span> memoize <span class="token keyword">from</span> <span class="token string">"memoize-one"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// State only needs to hold the current filter text value:</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> filterText<span class="token punctuation">:</span> <span class="token string">""</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Re-run the filter whenever the list array or filter text changes:</span>
  filter <span class="token operator">=</span> <span class="token function">memoize</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>list<span class="token punctuation">,</span> filterText<span class="token punctuation">)</span> <span class="token operator">=></span> list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=></span> item<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>filterText<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> event <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> filterText<span class="token punctuation">:</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Calculate the latest filtered list. If these arguments haven't changed</span>
    <span class="token comment">// since the last render, `memoize-one` will reuse the last return value.</span>
    <span class="token keyword">const</span> filteredList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Fragment</span><span class="token punctuation">></span></span> 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>filterText<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>filteredList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Fragment</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Ëøô‰∏ÄÂÆûÁé∞ÂàôÊõ¥‰∏∫ÁÆÄÂçï‰∏îÂíå‰πãÂâçÊ¥æÁîüÁä∂ÊÄÅÁöÑÁâàÊú¨Ë°å‰∏∫‰∏ÄËá¥ÔºÅ</p>
<p>ÂΩìÂú®‰ΩøÁî®ËÆ∞ÂøÜÂåñÊó∂ÔºåËÆ∞‰ΩèÂá†ÁÇπÈôêÂà∂Ôºö</p>
<ol>
<li>Â§ßÂ§öÊï∞Âú∫ÊôØÔºå‰Ω†ÊÉ≥Ë¶Å<strong>ËÆ∞ÂøÜÂáΩÊï∞Êù•Ê†áËÆ∞ÁªÑ‰ª∂ÂÆû‰æã</strong>„ÄÇËøô‰∏ÄË°å‰∏∫ÈòªÊ≠¢‰∫ÜÁªÑ‰ª∂Â§ö‰∏™ÂÆû‰æãÈÄöËøáÊØè‰∏Ä‰∏™‰∏çÂêåÁöÑ key ËøõË°åÈáçÁΩÆ„ÄÇ</li>
<li>ÂÖ∏ÂûãÂú∞‰Ω†ÊÉ≥Ë¶ÅÁî®‰∏Ä‰∏™ÁºìÂ≠òÂáΩÊï∞Êù•<strong>ÈôêÂà∂ÁºìÂ≠òÂ§ßÂ∞è</strong>‰ª•ÈÅøÂÖçÊó∂‰∏çÊó∂Âú∞ÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇÔºàÂú®Ââç‰∏Ä‰∏™‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨‰ΩøÁî®‰∫Ü <code class="gatsby-code-text">memoize-one</code>ÔºåÂõ†‰∏∫ÂÆÉ‰ªÖÁºìÂ≠òÊúÄÊñ∞ÁöÑÂèÇÊï∞ÂíåÁªìÊûú„ÄÇÔºâ</li>
<li>Â¶ÇÊûúÂú®ÊØèÊ¨°Áà∂ÁªÑ‰ª∂Ê∏≤ÊüìÊó∂ <code class="gatsby-code-text">prop.list</code> ÈÉΩÈáçÊñ∞ÂàõÂª∫ÔºåÈÇ£‰πàÊú¨ËäÇÊèêÂà∞ÁöÑÊâÄÊúâÊñπÊ≥ïÈÉΩÂ∞Ü‰∏ç‰ºöËµ∑‰ΩúÁî®„ÄÇ‰ΩÜÂ§ßÂ§öÊï∞Âú∫ÊôØ‰∏ãÔºåËøô‰∏ÄËÆæÁΩÆÊòØÂêàÁêÜÁöÑ„ÄÇ</li>
</ol>
<h2 id="Â∞æÂ£∞"><a href="#%E5%B0%BE%E5%A3%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Â∞æÂ£∞</h2>
<p>ÁúüÊòØ‰∏ñÁïåÁöÑÂ∫îÁî®ÈáåÔºåÁªÑ‰ª∂ÈÄöÂ∏∏Ê∑∑Âêà‰∫ÜÂèóÊéßÂíåÈùûÂèóÊéßÁöÑË°å‰∏∫„ÄÇËøôÊòØÊ≤°ÈóÆÈ¢òÁöÑÔºÅÂ¶ÇÊûúÊØè‰∏Ä‰∏™ÂÄºÈÉΩÂè™Êúâ‰∏Ä‰∏™Ê∏ÖÊô∞ÁöÑÊù•Ê∫êÔºåÂàôÂèØ‰ª•ÈÅøÂÖç‰πãÂâçÊèêÂèäÁöÑÂèçÊ®°Âºè„ÄÇ</p>
<p>ÂÄºÂæóÈáçÁî≥ÁöÑÊòØ <code class="gatsby-code-text">getDerivedStateFromProps</code>ÔºàÈÄöÂ∏∏ÊòØÊ¥æÁîüÁä∂ÊÄÅÔºâÊòØ‰∏Ä‰∏™È´òÁ∫ßÁâπÊÄßÔºåÁî±‰∫éÂÖ∂ Â§çÊùÇÊÄßÂ∫îÂ∞ΩÂèØËÉΩÂú∞ÈÅøÂÖç‰ΩøÁî®„ÄÇÂ¶ÇÊûú‰Ω†Âú®‰ΩøÁî®Ëøô‰∫õÊ®°Âºè‰∏≠Âá∫Áé∞‰∫ÜÊàë‰ª¨Êú™ÊõæÊèêÂèäÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•ÈÄöËøá <a href="https://github.com/reactjs/reactjs.org/issues/new">Github</a> Êàñ <a href="https://twitter.com/reactjs">Tiwtter</a> ‰∏éÊàë‰ª¨ÂàÜ‰∫´ÔºÅ</p>]]></description><link>https://doc.react-china.org/blog/2018/06/07/you-probably-dont-need-derived-state.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/06/07/you-probably-dont-need-derived-state.html</guid><pubDate>Thu, 07 Jun 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[React v16.4.0: Pointer Events]]></title><description><![CDATA[<p>ÊúÄÊñ∞ÁöÑÁâàÊú¨Ôºà16.4.0ÔºâÂ¢ûÂä†‰∫ÜÂØπÁªèÂ∏∏ËØ∑Ê±ÇÁöÑÁâπÊÄß‚Äî‚ÄîÊåáÈíà‰∫ã‰ª∂ÁöÑÊîØÊåÅÔºõ</p>
<p>Ëøô‰∏™ÁâàÊú¨‰πüÂåÖÂê´‰∫ÜÂØπ‰∫é <code class="gatsby-code-text">getDerivedStateFromProps</code> ÁöÑbug‰øÆÂ§çÂ∑•‰Ωú„ÄÇ</p>
<p>It also includes a bugfix for <code class="gatsby-code-text">getDerivedStateFromProps</code>. Êü•Áúã‰∏ãÈù¢ÂÆåÊï¥ÁöÑ<a href="#changelog">Êõ¥Êñ∞Êó•Âøó</a> „ÄÇ</p>
<h2 id="ÊåáÈíà‰∫ã‰ª∂"><a href="#%E6%8C%87%E9%92%88%E4%BA%8B%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÊåáÈíà‰∫ã‰ª∂</h2>
<p>Âú® React DOM ‰∏≠ÔºåÁé∞Âú®ÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÊåáÈíà‰∫ã‰ª∂Ôºö</p>
<ul>
<li><code class="gatsby-code-text">onPointerDown</code></li>
<li><code class="gatsby-code-text">onPointerMove</code></li>
<li><code class="gatsby-code-text">onPointerUp</code></li>
<li><code class="gatsby-code-text">onPointerCancel</code></li>
<li><code class="gatsby-code-text">onGotPointerCapture</code></li>
<li><code class="gatsby-code-text">onLostPointerCapture</code></li>
<li><code class="gatsby-code-text">onPointerEnter</code></li>
<li><code class="gatsby-code-text">onPointerLeave</code></li>
<li><code class="gatsby-code-text">onPointerOver</code></li>
<li><code class="gatsby-code-text">onPointerOut</code></li>
</ul>
<p>ËØ∑Ê≥®ÊÑèÔºåËøô‰∫õ‰∫ã‰ª∂Âè™ËÉΩÂú®ÊîØÊåÅ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events">ÊåáÈíà‰∫ã‰ª∂</a> ËßÑËåÉÁöÑÊµèËßàÂô®‰∏≠Â∑•‰Ωú„ÄÇ(Âú®ÁºñÂÜôÊú¨ÊñáÊó∂ÔºåÂåÖÊã¨Chrome„ÄÅFirefox„ÄÅEdgeÂíåInternet ExplorerÁöÑÊúÄÊñ∞ÁâàÊú¨„ÄÇ) Â¶ÇÊûú‰Ω†ÁöÑÂ∫îÁî®Á®ãÂ∫è‰æùËµñ‰∫éÊåáÈíà‰∫ã‰ª∂ÔºåÊàë‰ª¨Âª∫ËÆÆ‰ΩøÁî®Á¨¨‰∏âÊñπÊåáÈíà‰∫ã‰ª∂ polyfill „ÄÇ‰∏∫‰∫ÜÈÅøÂÖçÂ¢ûÂä†ÂåÖÊñá‰ª∂ÁöÑÂ§ßÂ∞èÔºåÊàë‰ª¨Âú® React DOM ‰∏≠‰∏çÂåÖÂê´ËøôÊ†∑ÁöÑ polyfill„ÄÇÔºàËØëËÄÖÊ≥®ÔºöPolyfill ÊòØ‰∏ÄÂùó‰ª£Á†ÅÔºåÁî®Êù•‰∏∫ÊóßÊµèËßàÂô®Êèê‰æõÂÆÉÊ≤°ÊúâÂéüÁîüÊîØÊåÅÁöÑËæÉÊñ∞ÁöÑÂäüËÉΩ„ÄÇÔºâ</p>
<p><a href="https://codesandbox.io/api/v1/sandboxes/define?parameters=N4IgZglgNgpgziAXKADgQwMYGs0HMYB0AVnAPYB2SoGFALjObVSACYwoNvkYTxUC-ggDQgI5NgA9iCZCBqMGTRKIC2KUgCdaAAgBKMTDrAbSK7QHINBjLXMBuADrkIazTv2GAIgHkAstuNTCytDAFoWU3snJ3k4HQBhAEldeIAZAFEAfQBlRIAtdO0AXm0ADgBWR3IYqDQ4OG1PDTwAIVIJbRgJenEGjxsCeNN1ckVtYCdtbTi0emLxyantAAs6-LQUWgBXK0QAtCg4GCFFqZ4NDFhUmDBaPdKABhPyJe1zy5gAFVIUe6fF_hVKYQOBNPC4MS4eZgA5HIHaFBWABuEFIWzg11u8we8MRMBRaLg3xQ2KqiwonlIAHcXiV8WMigA-BYvJa0ZYggggsG4CHkKElWgaLYweFTemMAi0NAafC0AhHWgABVIYnoGnWmx2MAAFBL5eo1TANIkWABKMmsqYAemt2gA6jBprRNE72U6xBBaBADm9SJoWGJZvBtC7tAAjJ1ocOwUOkN4HDBbWpzd1vVb8-CnbS27Qp43aCgEbPszldIWGFVwL2o8ieGBQaV6pGKC0Ay1TCi-Ugt-b64rMiZW7QQMDaHUAQlLcC5oOavMhZpZrymVm2GnIYu0_GzsR0wFgtyEcZQ_Hm04I5eaNirNYpDab-rb1WHF8V2Wl9B1OuA7yuN1oY8_y-H5-CXJlxyHFc3ggC5_1uPZgMxHQAGo8wA55oOA4lENgj5iW0NCXRQTCljA58pkBaJWQoABVEk6RbRgB3HC9uXnPkBX2Q4YAowtyAAcVIWhNXXJ1GIZZk3xgWgP2DH9VjgUTtT2IURTA-EKFSUg4mUqw-yYnQmRLDkZ3fT9dWARS9JgPYYR4jTqPFbpr2VHS7zrB80AMyTlyWPd0KxCTJXQfAAA0twC4ifJCvAYAATUiig4m0NhG28kooJXQ87kCnRQlDUyCDxAl0WQ0jXmI1Sfm0AqLxK1F0WJCrty3erkUajEAPmHK2qKhrCQIwUfi3NcdheNLpXhKiX1XThjR1JcsrOZL92sjYxKAvD4MAmC4JA09zyKmZ6A7fzVojdoPwAT1jTLsymcMA2NPZzAARhQDoyCgCAWG0ABiFgAE5geB8wWqmFQZT5V63oeT7tAebQACZ4YkcGHu0FQxAACRgCBcGWXKABYHn-YcpipX72VhsmAFIMYphF3O9ChXqsFMIBbRnXhm3cLuAm67r814qZYGntCSFIMhyfJ0ghlZ8cJ3KpbSLJcgKBWno0NgNF0NBA3RPZVZljXCjtZGFfUatWfIV7o2-rZ6B57KANw_bysxqq9vwn4tcwLBcBMLZxCGKBND2datX0gB-CwYxFcxtFeoOYAYF3KrRDBlgAQRsWtXvICgYAz1qnKWMaN3HTGAB5AyRZ1bpgIpgCeiQhZgfhGUxqY665nuljiJuW8F2gm53JnXgoFUjQ0SkaRbi8KWpcgJ-gqfyBnhQNG7FtF6Krse07gfO031Vt_o_fOTo08T_4rf1XWbgGyvmcb7X9fT6EtzZ5s1-CAoN_GyH9P5aR0j_bef9gBL3INpXSG1tQgJXNabuTMa7Wnrqg14fEJ4TycP0WgPhfAECsOIBaiwa48jaB0FBpEIhJhUIoAgcp0iwEYYwFo11TQ6ksP6WwZonDPhAPwEQYhJAECJioKAzB5A9CUCAPuDdfpFAcCAEwwlVGMnQZg4RgggA" target="_blank" rel="noreferrer">Âú®Ê≤ôÁÆ±‰∏≠Êü•ÁúãËøêË°åËøô‰∏™Ê°à‰æã„ÄÇ</a></p>
<p>ÈùûÂ∏∏ÊÑüË∞¢ <a href="https://github.com/philipp-spiess">Philipp Spiess</a> ÂØπ‰∫éËøô‰∏™ÊîπÂèòÁöÑÂ∑®Â§ßË¥°ÁåÆÔºÅ</p>
<h2 id="‰øÆÂ§ç-getderivedstatefromprops-bug"><a href="#%E4%BF%AE%E5%A4%8D-getderivedstatefromprops-bug" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>‰øÆÂ§ç <code class="gatsby-code-text">getDerivedStateFromProps</code> bug</h2>
<p>‰∏çÁÆ°Êõ¥Êñ∞ÁöÑÂéüÂõ†ÊòØ‰ªÄ‰πàÔºå<code class="gatsby-code-text">getDerivedStateFromProps</code> Ëøô‰∏™ÂáΩÊï∞Âú®ÁªÑ‰ª∂ÁöÑÊØè‰∏ÄÊ¨°Ê∏≤Êüì‰∏≠ÈÉΩ‰ºöË¢´Ë∞ÉÁî®„ÄÇ‰ª•ÂâçÔºåÂè™ÊúâÂΩìÁà∂ÁªÑ‰ª∂ÈáçÊñ∞Ê∏≤ÊüìÊó∂ÔºåÊâç‰ºöË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞„ÄÇÂêåÊó∂ÔºåÂΩìËøô‰∏™ÁªÑ‰ª∂ÊâßË°å<code class="gatsby-code-text">setState</code>Êó∂‰∏ç‰ºöËß¶ÂèëËøô‰∏™ÂáΩÊï∞„ÄÇËøôÊòØÂú®ÊúÄÂàùÂÆûÊñΩÊó∂ÁöÑÁñèÂøΩÈÄ†ÊàêÁöÑ bugÔºåÁé∞Âú®Â∑≤Áªè‰øÆÂ§ç„ÄÇËøô‰∏™ÂáΩÊï∞‰πãÂâçÁöÑË°å‰∏∫Êõ¥Á±ª‰ºº‰∫é<code class="gatsby-code-text">compoenentWillReceiveProps</code>Ëøô‰∏™ÂáΩÊï∞„ÄÇ‰ΩÜÊòØÔºåÊîπËøõÂêéÁöÑË°å‰∏∫Á°Æ‰øù‰∫Ü‰∏é React Ê°ÜÊû∂Âç≥Â∞ÜÊé®Âá∫ÁöÑÂºÇÊ≠•Ê∏≤ÊüìÊ®°ÂºèÁöÑÂÖºÂÆπ„ÄÇ</p>
<p><strong>Ëøô‰∏™ bug ‰øÆÂ§ç‰∏ç‰ºöÂΩ±ÂìçÂ§ßÈÉ®ÂàÜÂ∫îÁî®„ÄÇ</strong>‰ΩÜÊòØÂèØËÉΩ‰ºöÈÄ†Êàê‰∏ÄÂ∞èÈÉ®ÂàÜÁªÑ‰ª∂ÈÉ®ÂàÜÁöÑÈóÆÈ¢ò„ÄÇËøô‰∫õÁΩïËßÅÁöÑÊ°à‰æã‰∏ªË¶ÅÂΩ±ÂìçÂú®‰∏§‰∏™Â§ßÁ±ªÔºö</p>
<h3 id="1-ÈÅøÂÖçgetderivedstatefrompropsÂáΩÊï∞ÁöÑÂâØ‰ΩúÁî®"><a href="#1-%E9%81%BF%E5%85%8Dgetderivedstatefromprops%E5%87%BD%E6%95%B0%E7%9A%84%E5%89%AF%E4%BD%9C%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. ÈÅøÂÖç<code class="gatsby-code-text">getDerivedStateFromProps</code>ÂáΩÊï∞ÁöÑÂâØ‰ΩúÁî®</h3>
<p>Â∞±ÂÉèÊ∏≤ÊüìÁöÑÊñπÊ≥ïÔºå<code class="gatsby-code-text">getDerivedStateFromProps</code> ÂáΩÊï∞Â∫îËØ•ÊòØ‰∏Ä‰∏™Á∫ØÂáÄÁöÑ props Âíå state ÁöÑÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞ÁöÑÂâØ‰ΩúÁî®Âú® <code class="gatsby-code-text">getDerivedStateFromProps</code>‰ªéÊù•Ê≤°ÊúâÊîØÊåÅ„ÄÇ‰ΩÜÁî±‰∫éÂÆÉÁé∞Âú®ÊØîËøáÂéªÁöÑ‰ªª‰ΩïÊó∂ÂÄôÊõ¥ÂèóÊ¨¢ËøéÔºåÊúÄËøëÁöÑÂèòÂåñÂèØËÉΩÊö¥Èú≤Âá∫‰πãÂâçÊú™Ë¢´ÂèëÁé∞ÁöÑ‰∏Ä‰∫õbug„ÄÇ</p>
<p>ÂáΩÊï∞‰∫ßÁîüÂâØ‰ΩúÁî®ÁöÑ‰ª£Á†ÅÔºåÂ∫îËØ•ÁßªÂä®Âà∞ÂÖ∂‰ªñÊñπÊ≥ï‰∏≠„ÄÇ‰æãÂ¶ÇÔºåÊµÅÈáèÂàÜÊ¥æÊñπÊ≥ïÔºåÈÄöÂ∏∏Â±û‰∫éÂéüÂßã‰∫ã‰ª∂Â§ÑÁêÜÁ®ãÂ∫èÂÜÖÔºõÊâãÂä®DOMÂèòÂåñÊñπÊ≥ïÔºåÈÄöÂ∏∏Â±û‰∫éÂÜÖÈÉ® componentDidMount Êàñ componentDidUpdate ÁîüÂëΩÂë®ÁêºÂáΩÊï∞‰∏≠„ÄÇ‰Ω†ÂèØ‰ª•Âú®Êàë‰ª¨ÊúÄËøëÂÖ≥‰∫éÂáÜÂ§áÂèëÂ∏ÉÁöÑ<a href="/blog/2018/03/27/update-on-async-rendering.html">ÂºÇÊ≠•ÂëàÁé∞ÊñáÁ´†</a>‰∏≠Ôºå‰∫ÜËß£Êõ¥Â§ö‰ø°ÊÅØ„ÄÇ</p>
<h3 id="2-ËÆ°ÁÆóÂèóÊéßÂ±ûÊÄßÊó∂ÔºåÂ∞ÜÊñ∞-props-Âíå‰∏ä‰∏Ä‰∏™-props-ËøõË°åÊØîËæÉ"><a href="#2-%E8%AE%A1%E7%AE%97%E5%8F%97%E6%8E%A7%E5%B1%9E%E6%80%A7%E6%97%B6%EF%BC%8C%E5%B0%86%E6%96%B0-props-%E5%92%8C%E4%B8%8A%E4%B8%80%E4%B8%AA-props-%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. ËÆ°ÁÆóÂèóÊéßÂ±ûÊÄßÊó∂ÔºåÂ∞ÜÊñ∞ props Âíå‰∏ä‰∏Ä‰∏™ props ËøõË°åÊØîËæÉ</h3>
<p>‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂÅáËÆæ <code class="gatsby-code-text">getDerivedStateFromProps</code> ÂáΩÊï∞Âè™Âú® props Êõ¥Êñ∞ÁöÑÊó∂ÂÄôËß¶ÂèëÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value <span class="token operator">!==</span> state<span class="token punctuation">.</span>controlledValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// Since this method fires on both props and state changes, local updates</span>
      <span class="token comment">// to the controlled value will be ignored, because the props version</span>
      <span class="token comment">// always overrides it. Oops!</span>
      controlledValue<span class="token punctuation">:</span> props<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÂèØËÉΩÁöÑÊñπÊ≥ïÊòØÔºöÂ∞Ü‰º†ÂÖ•ÂÄº‰∏éÂâç‰∏Ä‰∏™ÂÄºËøõË°åÊØîËæÉ„ÄÇÂÖ∑‰ΩìÊñπÊ≥ïÊòØÂ∞ÜÂâçÈù¢ÁöÑ propsÂ≠òÂÇ®Âú® state ‰∏≠„ÄÇ</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prevProps <span class="token operator">=</span> state<span class="token punctuation">.</span>prevProps<span class="token punctuation">;</span>
  <span class="token comment">// Compare the incoming prop to previous prop</span>
  <span class="token keyword">const</span> controlledValue <span class="token operator">=</span>
    prevProps<span class="token punctuation">.</span>value <span class="token operator">!==</span> props<span class="token punctuation">.</span>value
      <span class="token operator">?</span> props<span class="token punctuation">.</span>value
      <span class="token punctuation">:</span> state<span class="token punctuation">.</span>controlledValue<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// Store the previous props in state</span>
    prevProps<span class="token punctuation">:</span> props<span class="token punctuation">,</span>
    controlledValue<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>ÁÑ∂ËÄåÔºå <strong>Âú® state ‰∏≠Â≠òÂÇ®‚ÄúÈïúÂÉè‚Äù props ÈÄöÂ∏∏‰ºöÂåÖÂê´ bug</strong>Ôºå ‰∏çÁÆ°‰Ω†‰ΩøÁî®Êñ∞ÁöÑ <code class="gatsby-code-text">getDerivedStateFromProps</code> ÂáΩÊï∞ÔºåÊàñËÄÖÊóßÁöÑ <code class="gatsby-code-text">componentWillReceiveProps</code> ÂáΩÊï∞„ÄÇÊàë‰ª¨ÂèëË°®‰∫Ü‰∏ÄÁØáÂêéÁª≠ÁöÑÂçöÂÆ¢ÊñáÁ´†ÔºåÊõ¥ËØ¶ÁªÜÂú∞Ëß£Èáä‰∫ÜËøô‰∫õÈóÆÈ¢òÔºå Âπ∂‰∏îÊèêÂá∫‰∫Ü<a href="/blog/2018/06/07/you-probably-dont-need-derived-state.html">‰∏çÊ∂âÂèä<code class="gatsby-code-text">getDerivedStateFromProps()</code>ÂáΩÊï∞ÁöÑÊõ¥ÁÆÄÂçïÁöÑËß£ÂÜ≥ÊñπÊ°à</a>„ÄÇ</p>
<h2 id="ÂÆâË£Ö"><a href="#%E5%AE%89%E8%A3%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂÆâË£Ö</h2>
<p>‰Ω†ÂèØ‰ª•ÈÄöËøá npm Ëé∑Âèñ React 16.4.0 ÁâàÊú¨„ÄÇ</p>
<p>‰ΩøÁî® Yarn ÂÆâË£Ö React 16 ÁâàÊú¨ÔºåËøêË°å‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash">yarn add react@^16.4.0 react-dom@^16.4.0
</code></pre>
      </div>
<p>‰ΩøÁî® npm ÂÆâË£ÖÂÆâË£Ö React 16 ÁâàÊú¨ÔºåËøêË°å‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash"><span class="token function">npm</span> <span class="token function">install</span> --save react@^16.4.0 react-dom@^16.4.0
</code></pre>
      </div>
<p>Êàë‰ª¨‰πüÊèê‰æõ‰∫ÜÈÄöËøá CDN ÁöÑ UMD ÊñπÂºèÊê≠Âª∫‰∏Ä‰∏™ ReactÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-html"><code class="gatsby-code-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react@16/umd/react.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/react-dom@16/umd/react-dom.production.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
      </div>
<p>ËØ∑ÂèÇÈòÖÊñáÊ°£Ëé∑ÂèñËØ¶ÁªÜÁöÑ<a href="/docs/installation.html">ÂÆâË£ÖÊñπÊ≥ï</a>„ÄÇ</p>
<h2 id="Êõ¥Êñ∞Êó•Âøó"><a href="#%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Êõ¥Êñ∞Êó•Âøó</h2>
<h3 id="react"><a href="#react" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React</h3>
<ul>
<li>Add a new <a href="https://github.com/reactjs/rfcs/pull/51">experimental</a> <code class="gatsby-code-text">React.unstable_Profiler</code> component for measuring performance. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/12745">#12745</a>)</li>
</ul>
<h3 id="react-dom"><a href="#react-dom" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React DOM</h3>
<ul>
<li>Add support for the Pointer Events specification. (<a href="https://github.com/philipp-spiess">@philipp-spiess</a> in <a href="https://github.com/facebook/react/pull/12507">#12507</a>)</li>
<li>Properly call <code class="gatsby-code-text">getDerivedStateFromProps()</code> regardless of the reason for re-rendering. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/12600">#12600</a> and <a href="https://github.com/facebook/react/pull/12802">#12802</a>)</li>
<li>Fix a bug that prevented context propagation in some cases. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12708">#12708</a>)</li>
<li>Fix re-rendering of components using <code class="gatsby-code-text">forwardRef()</code> on a deeper <code class="gatsby-code-text">setState()</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12690">#12690</a>)</li>
<li>Fix some attributes incorrectly getting removed from custom element nodes. (<a href="https://github.com/airamrguez">@airamrguez</a> in <a href="https://github.com/facebook/react/pull/12702">#12702</a>)</li>
<li>Fix context providers to not bail out on children if there‚Äôs a legacy context provider above. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12586">#12586</a>)</li>
<li>Add the ability to specify <code class="gatsby-code-text">propTypes</code> on a context provider component. (<a href="https://github.com/nicolevy">@nicolevy</a> in <a href="https://github.com/facebook/react/pull/12658">#12658</a>)</li>
<li>Fix a false positive warning when using <code class="gatsby-code-text">react-lifecycles-compat</code> in <code class="gatsby-code-text">&lt;StrictMode&gt;</code>. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/12644">#12644</a>)</li>
<li>Warn when the <code class="gatsby-code-text">forwardRef()</code> render function has <code class="gatsby-code-text">propTypes</code> or <code class="gatsby-code-text">defaultProps</code>. (<a href="https://github.com/bvaughn">@bvaughn</a> in <a href="https://github.com/facebook/react/pull/12644">#12644</a>)</li>
<li>Improve how <code class="gatsby-code-text">forwardRef()</code> and context consumers are displayed in the component stack. (<a href="https://github.com/sophiebits">@sophiebits</a> in <a href="https://github.com/facebook/react/pull/12777">#12777</a>)</li>
<li>Change internal event names. This can break third-party packages that rely on React internals in unsupported ways. (<a href="https://github.com/philipp-spiess">@philipp-spiess</a> in <a href="https://github.com/facebook/react/pull/12629">#12629</a>)</li>
</ul>
<h3 id="react-test-renderer"><a href="#react-test-renderer" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Test Renderer</h3>
<ul>
<li>Fix the <code class="gatsby-code-text">getDerivedStateFromProps()</code> support to match the new React DOM behavior. (<a href="https://github.com/koba04">@koba04</a> in <a href="https://github.com/facebook/react/pull/12676">#12676</a>)</li>
<li>Fix a <code class="gatsby-code-text">testInstance.parent</code> crash when the parent is a fragment or another special node. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12813">#12813</a>)</li>
<li><code class="gatsby-code-text">forwardRef()</code> components are now discoverable by the test renderer traversal methods. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12725">#12725</a>)</li>
<li>Shallow renderer now ignores <code class="gatsby-code-text">setState()</code> updaters that return <code class="gatsby-code-text">null</code> or <code class="gatsby-code-text">undefined</code>. (<a href="https://github.com/koba04">@koba04</a> in <a href="https://github.com/facebook/react/pull/12756">#12756</a>)</li>
</ul>
<h3 id="react-art"><a href="#react-art" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React ART</h3>
<ul>
<li>Fix reading context provided from the tree managed by React DOM. (<a href="https://github.com/acdlite">@acdlite</a> in <a href="https://github.com/facebook/react/pull/12779">#12779</a>)</li>
</ul>
<h3 id="react-call-return-experimental"><a href="#react-call-return-experimental" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Call Return (Experimental)</h3>
<ul>
<li>This experiment was deleted because it was affecting the bundle size and the API wasn‚Äôt good enough. It‚Äôs likely to come back in the future in some other form. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12820">#12820</a>)</li>
</ul>
<h3 id="react-reconciler-experimental"><a href="#react-reconciler-experimental" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Reconciler (Experimental)</h3>
<ul>
<li>The <a href="https://github.com/facebook/react/blob/c601f7a64640290af85c9f0e33c78480656b46bc/packages/react-noop-renderer/src/createReactNoop.js#L82-L285">new host config shape</a> is flat and doesn‚Äôt use nested objects. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/12792">#12792</a>)</li>
</ul>]]></description><link>https://doc.react-china.org/blog/2018/05/23/react-v-16-4.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/05/23/react-v-16-4.html</guid><pubDate>Wed, 23 May 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[React v16.3.0: New lifecycles and context API]]></title><description><![CDATA[<p>A few days ago, we <a href="/blog/2018/03/27/update-on-async-rendering.html">wrote a post about upcoming changes to our legacy lifecycle methods</a>, including gradual migration strategies. In React 16.3.0, we are adding a few new lifecycle methods to assist with that migration. We are also introducing new APIs for long requested features: an official context API, a ref forwarding API, and an ergonomic ref API.</p>
<p>Read on to learn more about the release.</p>
<h2 id="official-context-api"><a href="#official-context-api" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Official Context API</h2>
<p>For many years, React has offered an experimental API for context. Although it was a powerful tool, its use was discouraged because of inherent problems in the API, and because we always intended to replace the experimental API with a better one.</p>
<p>Version 16.3 introduces a new context API that is more efficient and supports both static type checking and deep updates.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>The old context API will keep working for all React 16.x releases, so you will have time to migrate.</p>
</blockquote>
<p>Here is an example illustrating how you might inject a ‚Äútheme‚Äù using the new context API:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>
<span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>theme<span class="token punctuation">:</span> <span class="token string">'light'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThemeContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
</span><span class="gatsby-highlight-code-line">        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ThemeContext.Provider</span><span class="token punctuation">></span></span>
</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ThemedButton</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
</span><span class="gatsby-highlight-code-line">        <span class="token punctuation">{</span>theme <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">theme</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p><a href="/docs/context.html">Learn more about the new context API here.</a></p>
<h2 id="createref-api"><a href="#createref-api" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="gatsby-code-text">createRef</code> API</h2>
<p>Previously, React provided two ways of managing refs: the legacy string ref API and the callback API. Although the string ref API was the more convenient of the two, it had <a href="https://github.com/facebook/react/issues/1373">several downsides</a> and so our official recommendation was to use the callback form instead.</p>
<p>Version 16.3 adds a new option for managing refs that offers the convenience of a string ref without any of the downsides:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>inputRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>inputRef<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</span>  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>inputRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<blockquote>
<p><strong>Note:</strong></p>
<p>Callback refs will continue to be supported in addition to the new <code class="gatsby-code-text">createRef</code> API.</p>
<p>You don‚Äôt need to replace callback refs in your components. They are slightly more flexible, so they will remain as an advanced feature.</p>
</blockquote>
<p><a href="/docs/refs-and-the-dom.html">Learn more about the new <code class="gatsby-code-text">createRef</code> API here.</a></p>
<h2 id="forwardref-api"><a href="#forwardref-api" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="gatsby-code-text">forwardRef</code> API</h2>
<p><a href="/docs/higher-order-components.html">Higher-order components</a> (or HOCs) are a common way to reuse code between components. Building on the theme context example from above, we might create an HOC that injects the current ‚Äútheme‚Äù as a prop:</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">function</span> <span class="token function">withTheme</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">ThemedComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
</span><span class="gatsby-highlight-code-line">        <span class="token punctuation">{</span>theme <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">theme</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>We can use the above HOC to wire components up to the theme context without having to use <code class="gatsby-code-text">ThemeContext</code> directly. For example:</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">FancyButton</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  buttonRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>buttonRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span>label<span class="token punctuation">,</span> theme<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">rest</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>theme<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-button`</span></span><span class="token punctuation">}</span></span>
<span class="gatsby-highlight-code-line">        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>buttonRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
</span>        <span class="token punctuation">{</span>label<span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> FancyThemedButton <span class="token operator">=</span> <span class="token function">withTheme</span><span class="token punctuation">(</span>FancyButton<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>
<span class="token comment">// We can render FancyThemedButton as if it were a FancyButton</span>
<span class="token comment">// It will automatically receive the current "theme",</span>
<span class="token comment">// And the HOC will pass through our other props.</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FancyThemedButton</span>
  <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Click me!<span class="token punctuation">"</span></span>
  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span>
<span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</code></pre>
        </div></p>
<p>HOCs typically <a href="/docs/higher-order-components.html#convention-pass-unrelated-props-through-to-the-wrapped-component">pass props through</a> to the components they wrap. Unfortunately, <a href="/docs/higher-order-components.html#refs-arent-passed-through">refs are not passed through</a>. This means that we can‚Äôt attach a ref to <code class="gatsby-code-text">FancyButton</code> if we use <code class="gatsby-code-text">FancyThemedButton</code>‚Äî so there‚Äôs no way for us to call <code class="gatsby-code-text">focus()</code>.</p>
<p>The new <code class="gatsby-code-text">forwardRef</code> API solves this problem by providing a way for us to intercept a <code class="gatsby-code-text">ref</code> and forward it as a normal prop:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">function</span> <span class="token function">withTheme</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Note the second param "ref" provided by React.forwardRef.</span>
  <span class="token comment">// We can attach this to Component directly.</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">function</span> <span class="token function">ThemedComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span>theme <span class="token operator">=></span> <span class="token punctuation">(</span>
<span class="gatsby-highlight-code-line">          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Component</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token attr-name">theme</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
</span>        <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ThemeContext.Consumer</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// These next lines are not necessary,</span>
  <span class="token comment">// But they do give the component a better display name in DevTools,</span>
  <span class="token comment">// e.g. "ForwardRef(withTheme(MyComponent))"</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> name <span class="token operator">=</span> Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  ThemedComponent<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`withTheme(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">;</span>
</span>
  <span class="token comment">// Tell React to pass the "ref" to ThemedComponent.</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span>ThemedComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> fancyButtonRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>
<span class="token comment">// fancyButtonRef will now point to FancyButton</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FancyThemedButton</span>
  <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Click me!<span class="token punctuation">"</span></span>
  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span>
<span class="gatsby-highlight-code-line">  <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>fancyButtonRef<span class="token punctuation">}</span></span>
</span><span class="token punctuation">/></span></span><span class="token punctuation">;</span>
</code></pre>
        </div></p>
<h2 id="component-lifecycle-changes"><a href="#component-lifecycle-changes" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Component Lifecycle Changes</h2>
<p>React‚Äôs class component API has been around for years with little change. However, as we add support for more advanced features (such as <a href="/docs/react-component.html#componentdidcatch">error boundaries</a> and the upcoming <a href="/blog/2018/03/01/sneak-peek-beyond-react-16.html">async rendering mode</a>) we stretch this model in ways that it was not originally intended.</p>
<p>For example, with the current API, it is too easy to block the initial render with non-essential logic. In part this is because there are too many ways to accomplish a given task, and it can be unclear which is best. We‚Äôve observed that the interrupting behavior of error handling is often not taken into consideration and can result in memory leaks (something that will also impact the upcoming async rendering mode). The current class component API also complicates other efforts, like our work on <a href="https://twitter.com/trueadm/status/944908776896978946">prototyping a React compiler</a>.</p>
<p>Many of these issues are exacerbated by a subset of the component lifecycles (<code class="gatsby-code-text">componentWillMount</code>, <code class="gatsby-code-text">componentWillReceiveProps</code>, and <code class="gatsby-code-text">componentWillUpdate</code>). These also happen to be the lifecycles that cause the most confusion within the React community. For these reasons, we are going to deprecate those methods in favor of better alternatives.</p>
<p>We recognize that this change will impact many existing components. Because of this, the migration path will be as gradual as possible, and will provide escape hatches. (At Facebook, we maintain more than 50,000 React components. We depend on a gradual release cycle too!)</p>
<blockquote>
<p><strong>Note:</strong></p>
<p>Deprecation warnings will be enabled with a future 16.x release, <strong>but the legacy lifecycles will continue to work until version 17</strong>.</p>
<p>Even in version 17, it will still be possible to use them, but they will be aliased with an ‚ÄúUNSAFE_‚Äù prefix to indicate that they might cause issues. We have also prepared an <a href="https://github.com/reactjs/react-codemod#rename-unsafe-lifecycles">automated script to rename them</a> in existing code.</p>
</blockquote>
<p>In addition to deprecating unsafe lifecycles, we are also adding a couple of new lifecyles:</p>
<ul>
<li><a href="/docs/react-component.html#static-getderivedstatefromprops"><code class="gatsby-code-text">getDerivedStateFromProps</code></a> is being added as a safer alternative to the legacy <code class="gatsby-code-text">componentWillReceiveProps</code>.</li>
<li><a href="/docs/react-component.html#getsnapshotbeforeupdate"><code class="gatsby-code-text">getSnapshotBeforeUpdate</code></a> is being added to support safely reading properties from e.g. the DOM before updates are made.</li>
</ul>
<p><a href="/blog/2018/03/27/update-on-async-rendering.html">Learn more about these lifecycle changes here.</a></p>
<h2 id="strictmode-component"><a href="#strictmode-component" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="gatsby-code-text">StrictMode</code> Component</h2>
<p><code class="gatsby-code-text">StrictMode</code> is a tool for highlighting potential problems in an application. Like <code class="gatsby-code-text">Fragment</code>, <code class="gatsby-code-text">StrictMode</code> does not render any visible UI. It activates additional checks and warnings for its descendants.</p>
<blockquote>
<p><strong>Note:</strong></p>
<p><code class="gatsby-code-text">StrictMode</code> checks are run in development mode only; <em>they do not impact the production build</em>.</p>
</blockquote>
<p>Although it is not possible for strict mode to catch all problems (e.g. certain types of mutation), it can help with many. If you see warnings in strict mode, those things will likely cause bugs for async rendering.</p>
<p>In version 16.3, <code class="gatsby-code-text">StrictMode</code> helps with:</p>
<ul>
<li>Identifying components with unsafe lifecycles</li>
<li>Warning about legacy string ref API usage</li>
<li>Detecting unexpected side effects</li>
</ul>
<p>Additional functionality will be added with future releases of React.</p>
<p><a href="/docs/strict-mode.html">Learn more about the <code class="gatsby-code-text">StrictMode</code> component here.</a></p>]]></description><link>https://doc.react-china.org/blog/2018/03/29/react-v-16-3.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/03/29/react-v-16-3.html</guid><pubDate>Thu, 29 Mar 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[Update on Async Rendering]]></title><description><![CDATA[<p>For over a year, the React team has been working to implement asynchronous rendering. Last month during his talk at JSConf Iceland, <a href="/blog/2018/03/01/sneak-peek-beyond-react-16.html">Dan unveiled some of the exciting new possibilities async rendering unlocks</a>. Now we‚Äôd like to share with you some of the lessons we‚Äôve learned while working on these features, and some recipes to help prepare your components for async rendering when it launches.</p>
<p>One of the biggest lessons we‚Äôve learned is that some of our legacy component lifecycles tend to encourage unsafe coding practices. They are:</p>
<ul>
<li><code class="gatsby-code-text">componentWillMount</code></li>
<li><code class="gatsby-code-text">componentWillReceiveProps</code></li>
<li><code class="gatsby-code-text">componentWillUpdate</code></li>
</ul>
<p>These lifecycle methods have often been misunderstood and subtly misused; furthermore, we anticipate that their potential misuse may be more problematic with async rendering. Because of this, we will be adding an ‚ÄúUNSAFE_‚Äù prefix to these lifecycles in an upcoming release. (Here, ‚Äúunsafe‚Äù refers not to security but instead conveys that code using these lifecycles will be more likely to have bugs in future versions of React, especially once async rendering is enabled.)</p>
<h2 id="gradual-migration-path"><a href="#gradual-migration-path" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gradual Migration Path</h2>
<p><a href="/blog/2016/02/19/new-versioning-scheme.html">React follows semantic versioning</a>, so this change will be gradual. Our current plan is:</p>
<ul>
<li><strong>16.3</strong>: Introduce aliases for the unsafe lifecycles, <code class="gatsby-code-text">UNSAFE_componentWillMount</code>, <code class="gatsby-code-text">UNSAFE_componentWillReceiveProps</code>, and <code class="gatsby-code-text">UNSAFE_componentWillUpdate</code>. (Both the old lifecycle names and the new aliases will work in this release.)</li>
<li><strong>A future 16.x release</strong>: Enable deprecation warning for <code class="gatsby-code-text">componentWillMount</code>, <code class="gatsby-code-text">componentWillReceiveProps</code>, and <code class="gatsby-code-text">componentWillUpdate</code>. (Both the old lifecycle names and the new aliases will work in this release, but the old names will log a DEV-mode warning.)</li>
<li><strong>17.0</strong>: Remove <code class="gatsby-code-text">componentWillMount</code>, <code class="gatsby-code-text">componentWillReceiveProps</code>, and <code class="gatsby-code-text">componentWillUpdate</code> . (Only the new ‚ÄúUNSAFE_‚Äù lifecycle names will work from this point forward.)</li>
</ul>
<p><strong>Note that if you‚Äôre a React application developer, you don‚Äôt have to do anything about the legacy methods yet. The primary purpose of the upcoming version 16.3 release is to enable open source project maintainers to update their libraries in advance of any deprecation warnings. Those warnings will not be enabled until a future 16.x release.</strong></p>
<p>We maintain over 50,000 React components at Facebook, and we don‚Äôt plan to rewrite them all immediately. We understand that migrations take time. We will take the gradual migration path along with everyone in the React community.</p>
<hr>
<h2 id="migrating-from-legacy-lifecycles"><a href="#migrating-from-legacy-lifecycles" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migrating from Legacy Lifecycles</h2>
<p>If you‚Äôd like to start using the new component APIs introduced in React 16.3 (or if you‚Äôre a maintainer looking to update your library in advance) here are a few examples that we hope will help you to start thinking about components a bit differently. Over time, we plan to add additional ‚Äúrecipes‚Äù to our documentation that show how to perform common tasks in a way that avoids the problematic lifecycles.</p>
<p>Before we begin, here‚Äôs a quick overview of the lifecycle changes planned for version 16.3:</p>
<ul>
<li>We are <strong>adding the following lifecycle aliases</strong>: <code class="gatsby-code-text">UNSAFE_componentWillMount</code>, <code class="gatsby-code-text">UNSAFE_componentWillReceiveProps</code>, and <code class="gatsby-code-text">UNSAFE_componentWillUpdate</code>. (Both the old lifecycle names and the new aliases will be supported.)</li>
<li>We are <strong>introducing two new lifecycles</strong>, static <code class="gatsby-code-text">getDerivedStateFromProps</code> and <code class="gatsby-code-text">getSnapshotBeforeUpdate</code>.</li>
</ul>
<h3 id="new-lifecycle-getderivedstatefromprops"><a href="#new-lifecycle-getderivedstatefromprops" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>New lifecycle: <code class="gatsby-code-text">getDerivedStateFromProps</code></h3>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>The new static <code class="gatsby-code-text">getDerivedStateFromProps</code> lifecycle is invoked after a component is instantiated as well as when it receives new props. It can return an object to update <code class="gatsby-code-text">state</code>, or <code class="gatsby-code-text">null</code> to indicate that the new <code class="gatsby-code-text">props</code> do not require any <code class="gatsby-code-text">state</code> updates.</p>
<p>Together with <code class="gatsby-code-text">componentDidUpdate</code>, this new lifecycle should cover all use cases for the legacy <code class="gatsby-code-text">componentWillReceiveProps</code>.</p>
<h3 id="new-lifecycle-getsnapshotbeforeupdate"><a href="#new-lifecycle-getsnapshotbeforeupdate" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>New lifecycle: <code class="gatsby-code-text">getSnapshotBeforeUpdate</code></h3>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>The new <code class="gatsby-code-text">getSnapshotBeforeUpdate</code> lifecycle is called right before mutations are made (e.g. before the DOM is updated). The return value for this lifecycle will be passed as the third parameter to <code class="gatsby-code-text">componentDidUpdate</code>. (This lifecycle isn‚Äôt often needed, but can be useful in cases like manually preserving scroll position during rerenders.)</p>
<p>Together with <code class="gatsby-code-text">componentDidUpdate</code>, this new lifecycle should cover all use cases for the legacy <code class="gatsby-code-text">componentWillUpdate</code>.</p>
<p>You can find their type signatures <a href="https://gist.github.com/gaearon/88634d27abbc4feeb40a698f760f3264">in this gist</a>.</p>
<p>We‚Äôll look at examples of how both of these lifecycles can be used below.</p>
<h2 id="examples"><a href="#examples" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<ul>
<li><a href="#initializing-state">Initializing state</a></li>
<li><a href="#fetching-external-data">Fetching external data</a></li>
<li><a href="#adding-event-listeners-or-subscriptions">Adding event listeners (or subscriptions)</a></li>
<li><a href="#updating-state-based-on-props">Updating <code class="gatsby-code-text">state</code> based on props</a></li>
<li><a href="#invoking-external-callbacks">Invoking external callbacks</a></li>
<li><a href="#side-effects-on-props-change">Side effects on props change</a></li>
<li><a href="#fetching-external-data-when-props-change">Fetching external data when props change</a></li>
<li><a href="#reading-dom-properties-before-an-update">Reading DOM properties before an update</a></li>
</ul>
<blockquote>
<p>Note</p>
<p>For brevity, the examples below are written using the experimental class properties transform, but the same migration strategies apply without it.</p>
</blockquote>
<h3 id="initializing-state"><a href="#initializing-state" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initializing state</h3>
<p>This example shows a component with <code class="gatsby-code-text">setState</code> calls inside of <code class="gatsby-code-text">componentWillMount</code>:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      currentColor<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultColor<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      palette<span class="token punctuation">:</span> <span class="token string">'rgb'</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>The simplest refactor for this type of component is to move state initialization to the constructor or to a property initializer, like so:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  state <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    currentColor<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>defaultColor<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    palette<span class="token punctuation">:</span> <span class="token string">'rgb'</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<h3 id="fetching-external-data"><a href="#fetching-external-data" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fetching external data</h3>
<p>Here is an example of a component that uses <code class="gatsby-code-text">componentWillMount</code> to fetch external data:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token function">asyncLoadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      externalData <span class="token operator">=></span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render loading state ...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render real UI ...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>The above code is problematic for both server rendering (where the external data won‚Äôt be used) and the upcoming async rendering mode (where the request might be initiated multiple times).</p>
<p>The recommended upgrade path for most use cases is to move data-fetching into <code class="gatsby-code-text">componentDidMount</code>:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token function">asyncLoadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      externalData <span class="token operator">=></span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render loading state ...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render real UI ...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>There is a common misconception that fetching in <code class="gatsby-code-text">componentWillMount</code> lets you avoid the first empty rendering state. In practice this was never true because React has always executed <code class="gatsby-code-text">render</code> immediately after <code class="gatsby-code-text">componentWillMount</code>. If the data is not available by the time <code class="gatsby-code-text">componentWillMount</code> fires, the first <code class="gatsby-code-text">render</code> will still show a loading state regardless of where you initiate the fetch. This is why moving the fetch to <code class="gatsby-code-text">componentDidMount</code> has no perceptible effect in the vast majority of cases.</p>
<blockquote>
<p>Note</p>
<p>Some advanced use-cases (e.g. libraries like Relay) may want to experiment with eagerly prefetching async data. An example of how this can be done is available <a href="https://gist.github.com/bvaughn/89700e525ff423a75ffb63b1b1e30a8f">here</a>.</p>
<p>In the longer term, the canonical way to fetch data in React components will likely be based on the ‚Äúsuspense‚Äù API <a href="/blog/2018/03/01/sneak-peek-beyond-react-16.html">introduced at JSConf Iceland</a>. Both simple data fetching solutions and libraries like Apollo and Relay will be able to use it under the hood. It is significantly less verbose than either of the above solutions, but will not be finalized in time for the 16.3 release.</p>
<p>When supporting server rendering, it‚Äôs currently necessary to provide the data synchronously ‚Äì <code class="gatsby-code-text">componentWillMount</code> was often used for this purpose but the constructor can be used as a replacement. The upcoming suspense APIs will make async data fetching cleanly possible for both client and server rendering.</p>
</blockquote>
<h3 id="adding-event-listeners-or-subscriptions"><a href="#adding-event-listeners-or-subscriptions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding event listeners (or subscriptions)</h3>
<p>Here is an example of a component that subscribes to an external event dispatcher when mounting:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      subscribedValue<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// This is not safe; it can leak!</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubscriptionChange
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubscriptionChange
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">handleSubscriptionChange</span> <span class="token operator">=</span> dataSource <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      subscribedValue<span class="token punctuation">:</span> dataSource<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>Unfortunately, this can cause memory leaks for server rendering (where <code class="gatsby-code-text">componentWillUnmount</code> will never¬†be called) and async rendering (where rendering might be interrupted before it completes, causing <code class="gatsby-code-text">componentWillUnmount</code> not to be called).</p>
<p>People often assume that <code class="gatsby-code-text">componentWillMount</code> and <code class="gatsby-code-text">componentWillUnmount</code> are always paired, but that is not guaranteed. Only once <code class="gatsby-code-text">componentDidMount</code> has been called does React guarantee that <code class="gatsby-code-text">componentWillUnmount</code> will later be called for clean up.</p>
<p>For this reason, the recommended way to add listeners/subscriptions is to use the <code class="gatsby-code-text">componentDidMount</code> lifecycle:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  state <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    subscribedValue<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">
</span><span class="gatsby-highlight-code-line">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Event listeners are only safe to add after mount,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// So they won't leak if mount is interrupted or errors.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubscriptionChange
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// External values could change between render and mount,</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// In some cases it may be important to handle this case.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>subscribedValue <span class="token operator">!==</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span>value
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        subscribedValue<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>dataSource<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubscriptionChange
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">handleSubscriptionChange</span> <span class="token operator">=</span> dataSource <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      subscribedValue<span class="token punctuation">:</span> dataSource<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>Sometimes it is important to update subscriptions in response to property changes. If you‚Äôre using a library like Redux or MobX, the library‚Äôs container component should handle this for you. For application authors, we‚Äôve created a small library, <a href="https://github.com/facebook/react/tree/master/packages/create-subscription"><code class="gatsby-code-text">create-subscription</code></a>, to help with this. We‚Äôll publish it along with React 16.3.</p>
<p>Rather than passing a subscribable <code class="gatsby-code-text">dataSource</code> prop as we did in the example above, we could use <code class="gatsby-code-text">create-subscription</code> to pass in the subscribed value:</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createSubscription<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'create-subscription'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Subscription <span class="token operator">=</span> <span class="token function">createSubscription</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">getCurrentValue</span><span class="token punctuation">(</span>sourceProp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Return the current value of the subscription (sourceProp).</span>
    <span class="token keyword">return</span> sourceProp<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">subscribe</span><span class="token punctuation">(</span>sourceProp<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleSubscriptionChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>sourceProp<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Subscribe (e.g. add an event listener) to the subscription (sourceProp).</span>
    <span class="token comment">// Call callback(newValue) whenever a subscription changes.</span>
    sourceProp<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>handleSubscriptionChange<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Return an unsubscribe method.</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sourceProp<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span>handleSubscriptionChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Rather than passing the subscribable source to our ExampleComponent,</span>
<span class="token comment">// We could just pass the subscribed value directly:</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Subscription</span> <span class="token attr-name">source</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dataSource<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">{</span>value <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ExampleComponent</span> <span class="token attr-name">subscribedValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Subscription</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</code></pre>
        </div></p>
<blockquote>
<p>Note</p>
<p>Libraries like Relay/Apollo should manage subscriptions manually with the same techniques as <code class="gatsby-code-text">create-subscription</code> uses under the hood (as referenced <a href="https://gist.github.com/bvaughn/d569177d70b50b58bff69c3c4a5353f3">here</a>) in a way that is most optimized for their library usage.</p>
</blockquote>
<h3 id="updating-state-based-on-props"><a href="#updating-state-based-on-props" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating <code class="gatsby-code-text">state</code> based on <code class="gatsby-code-text">props</code></h3>
<p>Here is an example of a component that uses the legacy <code class="gatsby-code-text">componentWillReceiveProps</code> lifecycle to update <code class="gatsby-code-text">state</code> based on new <code class="gatsby-code-text">props</code> values:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    isScrollingDown<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>currentRow <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>currentRow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        isScrollingDown<span class="token punctuation">:</span>
</span><span class="gatsby-highlight-code-line">          nextProps<span class="token punctuation">.</span>currentRow <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>currentRow<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>Although the above code is not problematic in itself, the <code class="gatsby-code-text">componentWillReceiveProps</code> lifecycle is often mis-used in ways that <em>do</em> present problems. Because of this, the method will be deprecated.</p>
<p>As of version 16.3, the recommended way to update <code class="gatsby-code-text">state</code> in response to <code class="gatsby-code-text">props</code> changes is with the new <code class="gatsby-code-text">static getDerivedStateFromProps</code> lifecycle. (That lifecycle is called when a component is created and each time it receives new props):
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// Initialize state in constructor,</span>
  <span class="token comment">// Or with a property initializer.</span>
<span class="gatsby-highlight-code-line">  state <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    isScrollingDown<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">    lastRow<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>currentRow <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>lastRow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        isScrollingDown<span class="token punctuation">:</span>
</span><span class="gatsby-highlight-code-line">          nextProps<span class="token punctuation">.</span>currentRow <span class="token operator">></span> prevState<span class="token punctuation">.</span>lastRow<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">        lastRow<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>currentRow<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span>
    <span class="token comment">// Return null to indicate no change to state.</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>You may notice in the example above that <code class="gatsby-code-text">props.currentRow</code> is mirrored in state (as <code class="gatsby-code-text">state.lastRow</code>). This enables <code class="gatsby-code-text">getDerivedStateFromProps</code> to access the previous props value in the same way as is done in <code class="gatsby-code-text">componentWillReceiveProps</code>.</p>
<p>You may wonder why we don‚Äôt just pass previous props as a parameter to <code class="gatsby-code-text">getDerivedStateFromProps</code>. We considered this option when designing the API, but ultimately decided against it for two reasons:</p>
<ul>
<li>A <code class="gatsby-code-text">prevProps</code> parameter would be null the first time <code class="gatsby-code-text">getDerivedStateFromProps</code> was called (after instantiation), requiring an if-not-null check to be added any time <code class="gatsby-code-text">prevProps</code> was accessed.</li>
<li>Not passing the previous props to this function is a step toward freeing up memory in future versions of React. (If React does not need to pass previous props to lifecycles, then it does not need to keep the previous <code class="gatsby-code-text">props</code> object in memory.)</li>
</ul>
<blockquote>
<p>Note</p>
<p>If you‚Äôre writing a shared component, the <a href="https://github.com/reactjs/react-lifecycles-compat"><code class="gatsby-code-text">react-lifecycles-compat</code></a> polyfill enables the new <code class="gatsby-code-text">getDerivedStateFromProps</code> lifecycle to be used with older versions of React as well. <a href="#open-source-project-maintainers">Learn more about how to use it below.</a></p>
</blockquote>
<h3 id="invoking-external-callbacks"><a href="#invoking-external-callbacks" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Invoking external callbacks</h3>
<p>Here is an example of a component that calls an external function when its internal state changes:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentWillUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>someStatefulValue <span class="token operator">!==</span>
</span><span class="gatsby-highlight-code-line">      nextState<span class="token punctuation">.</span>someStatefulValue
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      nextProps<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>nextState<span class="token punctuation">.</span>someStatefulValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>Sometimes people use <code class="gatsby-code-text">componentWillUpdate</code> out of a misplaced fear that by the time <code class="gatsby-code-text">componentDidUpdate</code> fires, it is ‚Äútoo late‚Äù to update the state of other components. This is not the case. React ensures that any <code class="gatsby-code-text">setState</code> calls that happen during <code class="gatsby-code-text">componentDidMount</code> and <code class="gatsby-code-text">componentDidUpdate</code> are flushed before the user sees the updated UI. In general, it is better to avoid cascading updates like this, but in some cases they are necessary (for example, if you need to position a tooltip after measuring the rendered DOM element).</p>
<p>Either way, it is unsafe to use <code class="gatsby-code-text">componentWillUpdate</code> for this purpose in async mode, because the external callback might get called multiple times for a single update. Instead, the <code class="gatsby-code-text">componentDidUpdate</code> lifecycle should be used since it is guaranteed to be invoked only once per update:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>someStatefulValue <span class="token operator">!==</span>
</span><span class="gatsby-highlight-code-line">      prevState<span class="token punctuation">.</span>someStatefulValue
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>someStatefulValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<h3 id="side-effects-on-props-change"><a href="#side-effects-on-props-change" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Side effects on props change</h3>
<p>Similar to the <a href="#invoking-external-callbacks">example above</a>, sometimes components have side effects when <code class="gatsby-code-text">props</code> change.</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isVisible <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token function">logVisibleChange</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>Like <code class="gatsby-code-text">componentWillUpdate</code>, <code class="gatsby-code-text">componentWillReceiveProps</code> might get called multiple times for a single update. For this reason it is important to avoid putting side effects in this method. Instead, <code class="gatsby-code-text">componentDidUpdate</code> should be used since it is guaranteed to be invoked only once per update:</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isVisible <span class="token operator">!==</span> prevProps<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token function">logVisibleChange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span><span class="token punctuation">}</span>
</code></pre>
        </div></p>
<h3 id="fetching-external-data-when-props-change"><a href="#fetching-external-data-when-props-change" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fetching external data when <code class="gatsby-code-text">props</code> change</h3>
<p>Here is an example of a component that fetches external data based on <code class="gatsby-code-text">props</code> values:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render loading state ...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render real UI ...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">_loadAsyncData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token function">asyncLoadData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
      externalData <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>The recommended upgrade path for this component is to move data updates into <code class="gatsby-code-text">componentDidUpdate</code>. You can also use the new <code class="gatsby-code-text">getDerivedStateFromProps</code> lifecycle to clear stale data before rendering the new props:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Store prevId in state so we can compare when props change.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Clear out previously-loaded data (so we don't render stale stuff).</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>prevId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">        externalData<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">        prevId<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
</span><span class="gatsby-highlight-code-line">      <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// No state update necessary</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render loading state ...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Render real UI ...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">_loadAsyncData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token function">asyncLoadData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
      externalData <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<blockquote>
<p>Note</p>
<p>If you‚Äôre using an HTTP library that supports cancellation, like <a href="https://www.npmjs.com/package/axios">axios</a>, then it‚Äôs simple to cancel an in-progress request when unmounting. For native Promises, you can use an approach like <a href="https://gist.github.com/bvaughn/982ab689a41097237f6e9860db7ca8d6">the one shown here</a>.</p>
</blockquote>
<h3 id="reading-dom-properties-before-an-update"><a href="#reading-dom-properties-before-an-update" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reading DOM properties before an update</h3>
<p>Here is an example of a component that reads a property from the DOM before an update in order to maintain scroll position within a list:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">ScrollingList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  listRef <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  previousScrollHeight <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">componentWillUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Are we adding new items to the list?</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Capture the current height of the list so we can adjust scroll later.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> nextProps<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>previousScrollHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// If previousScrollHeight is set, we've just added new items.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Adjust scroll so these new items don't push the old ones out of view.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>previousScrollHeight <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollTop <span class="token operator">+=</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>previousScrollHeight<span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>previousScrollHeight <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>setListRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span><span class="token comment">/* ...contents... */</span><span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">setListRef</span> <span class="token operator">=</span> ref <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listRef <span class="token operator">=</span> ref<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<p>In the above example, <code class="gatsby-code-text">componentWillUpdate</code> is used to read the DOM property. However with async rendering, there may be delays between ‚Äúrender‚Äù phase lifecycles (like <code class="gatsby-code-text">componentWillUpdate</code> and <code class="gatsby-code-text">render</code>) and ‚Äúcommit‚Äù phase lifecycles (like <code class="gatsby-code-text">componentDidUpdate</code>). If the user does something like resize the window during this time, the <code class="gatsby-code-text">scrollHeight</code> value read from <code class="gatsby-code-text">componentWillUpdate</code> will be stale.</p>
<p>The solution to this problem is to use the new ‚Äúcommit‚Äù phase lifecycle, <code class="gatsby-code-text">getSnapshotBeforeUpdate</code>. This method gets called <em>immediately before</em> mutations are made (e.g. before the DOM is updated). It can return a value for React to pass as a parameter to <code class="gatsby-code-text">componentDidUpdate</code>, which gets called <em>immediately after</em> mutations.</p>
<p>The two lifecycles can be used together like this:</p>
<p><div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">class</span> <span class="token class-name">ScrollingList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  listRef <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Are we adding new items to the list?</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Capture the current height of the list so we can adjust scroll later.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span>
</span>
<span class="gatsby-highlight-code-line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// If we have a snapshot value, we've just added new items.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// Adjust scroll so these new items don't push the old ones out of view.</span>
</span><span class="gatsby-highlight-code-line">    <span class="token comment">// (snapshot here is the value returned from getSnapshotBeforeUpdate)</span>
</span><span class="gatsby-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="gatsby-highlight-code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollTop <span class="token operator">+=</span>
</span><span class="gatsby-highlight-code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> snapshot<span class="token punctuation">;</span>
</span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span>
</span>  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>setListRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">{</span><span class="token comment">/* ...contents... */</span><span class="token punctuation">}</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">setListRef</span> <span class="token operator">=</span> ref <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listRef <span class="token operator">=</span> ref<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
        </div></p>
<blockquote>
<p>Note</p>
<p>If you‚Äôre writing a shared component, the <a href="https://github.com/reactjs/react-lifecycles-compat"><code class="gatsby-code-text">react-lifecycles-compat</code></a> polyfill enables the new <code class="gatsby-code-text">getSnapshotBeforeUpdate</code> lifecycle to be used with older versions of React as well. <a href="#open-source-project-maintainers">Learn more about how to use it below.</a></p>
</blockquote>
<h2 id="other-scenarios"><a href="#other-scenarios" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other scenarios</h2>
<p>While we tried to cover the most common use cases in this post, we recognize that we might have missed some of them. If you are using <code class="gatsby-code-text">componentWillMount</code>, <code class="gatsby-code-text">componentWillUpdate</code>, or <code class="gatsby-code-text">componentWillReceiveProps</code> in ways that aren‚Äôt covered by this blog post, and aren‚Äôt sure how to migrate off these legacy lifecycles, please <a href="https://github.com/reactjs/reactjs.org/issues/new">file a new issue against our documentation</a> with your code examples and as much background information as you can provide. We will update this document with new alternative patterns as they come up.</p>
<h2 id="open-source-project-maintainers"><a href="#open-source-project-maintainers" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Open source project maintainers</h2>
<p>Open source maintainers might be wondering what these changes mean for shared components. If you implement the above suggestions, what happens with components that depend on the new static <code class="gatsby-code-text">getDerivedStateFromProps</code> lifecycle? Do you also have to release a new major version and drop compatibility for React 16.2 and older?</p>
<p>Fortunately, you do not!</p>
<p>When React 16.3 is published, we‚Äôll also publish a new npm package, <a href="https://github.com/reactjs/react-lifecycles-compat"><code class="gatsby-code-text">react-lifecycles-compat</code></a>. This package polyfills components so that the new <code class="gatsby-code-text">getDerivedStateFromProps</code> and <code class="gatsby-code-text">getSnapshotBeforeUpdate</code> lifecycles will also work with older versions of React (0.14.9+).</p>
<p>To use this polyfill, first add it as a dependency to your library:</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-bash"><code class="gatsby-code-bash"><span class="token comment"># Yarn</span>
yarn add react-lifecycles-compat

<span class="token comment"># NPM</span>
<span class="token function">npm</span> <span class="token function">install</span> react-lifecycles-compat --save
</code></pre>
      </div>
<p>Next, update your components to use the new lifecycles (as described above).</p>
<p>Lastly, use the polyfill to make your component backwards compatible with older versions of React:
<div class="gatsby-highlight">
        <pre class="gatsby-code-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> polyfill <span class="token keyword">from</span> <span class="token string">'react-lifecycles-compat'</span><span class="token punctuation">;</span>
</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span>    <span class="token comment">// Your state update logic here ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Polyfill your component to work with older versions of React:</span>
<span class="gatsby-highlight-code-line"><span class="token function">polyfill</span><span class="token punctuation">(</span>ExampleComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ExampleComponent<span class="token punctuation">;</span>
</code></pre>
        </div></p>]]></description><link>https://doc.react-china.org/blog/2018/03/27/update-on-async-rendering.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/03/27/update-on-async-rendering.html</guid><pubDate>Tue, 27 Mar 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[Sneak Peek: Beyond React 16]]></title><description><![CDATA[<p>Êàë‰ª¨Âõ¢ÈòüÊàêÂëò <a href="https://twitter.com/dan_abramov">Dan Abramov</a> ÂàöÂàöÂú® <a href="https://2018.jsconf.is/">JSConf Iceland 2018</a>ÔºåÂ∞±Êàë‰ª¨Ê≠£Âú®ÁùÄÊâãÂÅöÁöÑ‰∏Ä‰∫õ React Êñ∞ÁöÑÂäüËÉΩÁâπÊÄßÂèëË°®‰∫ÜÊºîËÆ≤„ÄÇËøôÊ¨°ÊºîËÆ≤‰ª•‰∏Ä‰∏™ÈóÆÈ¢òÂºÄÂú∫Ôºö‚ÄúÂú®ËÆ°ÁÆóËÉΩÂäõÂíåÁΩëÈÄüÂ≠òÂú®Â∑®Â§ßÂ∑ÆÂºÇÁöÑËÉåÊôØ‰∏ãÔºåÊàë‰ª¨ÊÄéÊ†∑ÊâçËÉΩÁªôÊØè‰∏™‰∫∫Â∏¶Êù•ÊúÄÂ•ΩÁöÑÁî®Êà∑‰ΩìÈ™åÔºü‚Äù</p>
<p>ËøôÊòØ JSConf Iceland Êèê‰æõÁöÑ<a href="https://www.youtube.com/watch?v=v6iR3Zk4oDY">ËßÜÈ¢ë</a>„ÄÇËã•Êûú‰Ω†Áé∞Âú®ÂÅú‰∏ãÊú¨ÊñáÁöÑÈòÖËØªÂéªÁúãËßÜÈ¢ëÔºåÊàëËßâÂæó‰Ω†‰∏ÄÂÆö‰ºöÊõ¥Âä†ÂñúÊ¨¢Ëøô‰∏™ÊºîËÆ≤ËßÜÈ¢ë„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰Ω†Ê≤°ÊúâÊó∂Èó¥ËßÇÁúãÔºå‰∏ãÈù¢ÊòØÂØπËøôÊ¨°ÊºîËÆ≤ÁöÑ‰∏Ä‰∏™ÔºàÈùûÂ∏∏ÔºâÁÆÄË¶ÅÁöÑÊÄªÁªì„ÄÇ</p>
<h2 id="ÂÖ≥‰∫é‰∏§‰∏™ÊºîÁ§∫"><a href="#%E5%85%B3%E4%BA%8E%E4%B8%A4%E4%B8%AA%E6%BC%94%E7%A4%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂÖ≥‰∫é‰∏§‰∏™ÊºîÁ§∫</h2>
<p>Á¨¨‰∏Ä‰∏™ÊºîÁ§∫‰∏≠ÔºåDan ËØ¥ÈÅìÔºö ‚ÄúÊàë‰ª¨Â∑≤ÁªèÊûÑÂª∫‰∫Ü‰∏ÄÁßçÈÄöÁî®ÁöÑÊñπÊ≥ïÊù•Á°Æ‰øùÈ´ò‰ºòÂÖàÁ∫ßÁöÑÊõ¥Êñ∞‰∏ç‰ºöË¢´‰Ωé‰ºòÂÖàÁ∫ßÊõ¥Êñ∞ÊâÄÈòªÂ°ûÔºåËøôÁßçÊäÄÊúØÂè´Êó∂Èó¥ÂàÜÁâá„ÄÇÂ¶ÇÊûúÊàëÁöÑËÆæÂ§áË∂≥Â§üÂø´ÔºåÊÑüËßâÂ∞±ÂÉèÊòØÂêåÊ≠•ÁöÑÔºõÂ¶ÇÊûúÊàëÁöÑËÆæÂ§áÂæàÊÖ¢ÔºåÊàë‰ª¨‰ªçÁÑ∂ËÉΩÊÑüËßâÂà∞Â∫îÁî®Âú®ÁßØÊûÅÂìçÂ∫îÊàë‰ª¨ÁöÑÊìç‰Ωú„ÄÇËøôÂ§ö‰∫è‰∫Ü <a href="https://developers.google.com/web/updates/2015/08/using-requestidlecallback">requestIdleCallback API</a> ‰ΩøÂæóÂ∫îÁî®ÂèØ‰ª•ÈÄÇÂ∫î‰∏çÂêåÈÖçÁΩÆÁöÑËÆæÂ§á„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÂè™ÊúâÊúÄÁªàÁä∂ÊÄÅË¢´Ê∏≤ÊüìÂá∫Êù•‰∫ÜÔºåÂ±èÂπïÁöÑÊ∏≤ÊüìÂßãÁªà‰øùÊåÅ‰∏ÄËá¥ÔºåÂπ∂Ê≤°ÊúâËÆ©Êàë‰ª¨ÊÑüËßâÂà∞Ê∏≤ÊüìÈÄüÂ∫¶ÂæàÊÖ¢Ôºå‰ªéËÄåÂØºËá¥Áî®Êà∑‰ΩìÈ™å‰∏ç‰Ω≥„ÄÇ‚Äù</p>
<p>Âú®Á¨¨‰∫å‰∏™ÊºîÁ§∫‰∏≠ÔºåDanËß£ÈáäËØ¥Ôºö‚ÄúÊàë‰ª¨Â∑≤ÁªèÊûÑÂª∫‰∫Ü‰∏ÄÁßçÈÄöÁî®ÁöÑÊñπÊ≥ïÔºåËÆ©ÁªÑ‰ª∂Âú®Âä†ËΩΩÂºÇÊ≠•Êï∞ÊçÆÊó∂ÊöÇÂÅúÊ∏≤ÊüìÔºåËøôÂ∞±ÊòØÊàë‰ª¨ÊâÄËØ¥ÁöÑ <strong>suspense</strong>„ÄÇ‰Ω†ÂèØ‰ª•ÊöÇÂÅú‰ªª‰ΩïÁä∂ÊÄÅÊõ¥Êñ∞ÔºåÁõ¥Âà∞Êï∞ÊçÆÂáÜÂ§áÂ∞±Áª™ÔºåÂπ∂‰∏îÂèØ‰ª•Â∞ÜÂºÇÊ≠•Âä†ËΩΩÊ∑ªÂä†Âà∞ÁªÑ‰ª∂Ê†ë‰∏≠ÁöÑ‰ªª‰ΩïÁªÑ‰ª∂ÔºåËÄåÊó†ÈúÄÈÄöËøáÂ∫îÁî®ÁÆ°ÁêÜÊâÄÊúâÂ±ûÊÄßÂíåÁä∂ÊÄÅÔºåÈÅøÂÖçÂ¢ûÂä†ÈÄªËæëÂ§çÊùÇÂ∫¶„ÄÇÂú®ÁΩëÈÄüÂæàÂø´ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊõ¥Êñ∞ÊòæÁ§∫ÈùûÂ∏∏ÊµÅÁïÖ‰∏îÁû¨Êó∂Ôºå‰∏ç‰ºöËÆ©Êàë‰ª¨ÁúãÁùÄ‰∏ÄÂ†ÜÊÅº‰∫∫ÁöÑÂä†ËΩΩÂõæÊ†áËΩ¨Êù•ËΩ¨ÂéªÊúÄÂêéÊ∂àÂ§±„ÄÇÂΩìÁΩëÈÄüÊÖ¢ÁöÑÊó∂ÂÄôÔºå‰Ω†ÂèØ‰ª•‰∏ìÈó®ËÆæËÆ°‰∏Ä‰∏ãÁî®Êà∑Â∫îËØ•ÁúãÂà∞Âì™‰∫õÂä†ËΩΩÁä∂ÊÄÅÔºå‰ª•ÂèäÂÆÉ‰ª¨Â∫îËØ•ÂëàÁé∞ÁöÑÁ≤íÂ∫¶ÔºåËÄå‰∏çÊòØÊ†πÊçÆ‰Ω†ÂÜôÁöÑ‰ª£Á†ÅÁöÑÊù•ÂÜ≥ÂÆöÊòæÁ§∫‰ªÄ‰πà spinner„ÄÇËÆ©Á®ãÂ∫èÂßãÁªà‰øùÊåÅÂìçÂ∫î„ÄÇ‚Äù</p>
<p>‚ÄúÈáçË¶ÅÁöÑÊòØÔºåËøô‰ªçÁÑ∂ÊòØ‰Ω†‰∫ÜËß£ÁöÑÈÇ£‰∏™ React„ÄÇËøô‰ªçÁÑ∂ÊòØÈÇ£‰∏™Â£∞ÊòéÂºèÁöÑÁªÑ‰ª∂ÂåñÁöÑ‰Ω†ÂñúÊ¨¢ÁöÑ React„ÄÇ‚Äù</p>
<p>Êàë‰ª¨Â∑≤ÁªèËø´‰∏çÂèäÂæÖÂú∞ÊÉ≥Âú®Âú®‰ªäÂπ¥Êôö‰∫õÊó∂ÂÄôÂèëÂ∏ÉËøô‰∫õÊñ∞ÁöÑÂºÇÊ≠•Ê∏≤ÊüìÂäüËÉΩ„ÄÇËØ∑Âú® Twitter ‰∏äÂÖ≥Ê≥® <a href="https://twitter.com/reactjs">@reactjs</a> ‰ª•Ëé∑ÂèñÊõ¥Êñ∞„ÄÇ</p>]]></description><link>https://doc.react-china.org/blog/2018/03/01/sneak-peek-beyond-react-16.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2018/03/01/sneak-peek-beyond-react-16.html</guid><pubDate>Thu, 01 Mar 2018 00:00:00 GMT</pubDate></item><item><title><![CDATA[Behind the Scenes: Improving the Repository Infrastructure]]></title><description><![CDATA[<p>ÈöèÁùÄÊàë‰ª¨‰∏çÊñ≠Âú∞Âú® <a href="/blog/2017/09/26/react-v16.0.html">React 16</a> ÁöÑÊäïÂÖ•ÔºåÊàë‰ª¨Âú® React ‰ªìÂ∫ì‰∏≠ÂØπÂÖ∂ÁõÆÂΩïÁªìÊûÑÂíåÂ§ßÈáèÁöÑÊûÑÂª∫Â∑•ÂÖ∑ËøõË°å‰∫ÜÊîπÁâà„ÄÇÊ≠§Â§ñÔºåÊàë‰ª¨Â∞ÜÁ±ª‰ºº <a href="https://rollupjs.org/">Rollup</a>Ôºå <a href="https://prettier.io/">Prettier</a>ÔºåÂíå <a href="https://developers.google.com/closure/compiler/">Google Closure Compiler</a> ÂºïÂÖ•Âà∞Êàë‰ª¨ÁöÑÂ∑•‰ΩúÊµÅ‰∏≠„ÄÇÂÖ∂‰ªñÂºÄÂèëËÄÖÈÄöÂ∏∏‰ºöÈóÆÊàë‰ª¨Âú®È°πÁõÆ‰∏≠Â¶Ç‰Ωï‰ΩøÁî®Ëøô‰∫õÂ∑•ÂÖ∑Á≠âÈóÆÈ¢ò„ÄÇÂú®Êú¨ÁØáÂçöÂÆ¢‰∏≠ÔºåÊàë‰ª¨Â∞ÜÂàÜ‰∫´‰∏Ä‰∫õÊàë‰ª¨Âú® 2017 Âπ¥Âú®ÊûÑÂª∫Â∑•ÂÖ∑ÂíåÊµãËØïÁ≠âÂü∫Á°ÄÊû∂ÊûÑ‰∏äÊâÄÂÅöÁöÑ‰∏Ä‰∫õÊîπÂèòÔºå‰ª•ÂèäÊøÄÂä±‰ªñ‰ª¨Â∞ùËØïÁöÑÂéüÂõ†„ÄÇ</p>
<p>Â∞ΩÁÆ°Ëøô‰∫õÊîπÂèòÂ∏ÆÂä©Êàë‰ª¨Â∞Ü React ÂèòÂæóÊõ¥Â•ΩÔºå‰ΩÜ‰ªñ‰ª¨Âπ∂‰∏ç‰ºöÁõ¥Êé•ÂΩ±ÂìçÂ§ßÂ§öÊï∞ React Áî®Êà∑„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨Â∏åÊúõËÉΩÂ§üÂú®ÂçöÂÆ¢‰∏≠Â∞ÜÂÖ∂ËÆ∞ÂΩï‰∏ãÊù•‰ª•ËÉΩÂ§üÂ∏ÆÂä©Âà∞ÂÖ∂‰ªñÂ∫ìÁöÑ‰ΩúËÄÖÊù•Ëß£ÂÜ≥Á±ª‰ººÈóÆÈ¢ò„ÄÇÊàë‰ª¨ÁöÑË¥°ÁåÆËÄÖÂèØËÉΩ‰πü‰ºöÂèëÁé∞Ëøô‰∫õËÆ∞ÂΩïÈùûÂ∏∏ÊúâÁî®„ÄÇ</p>
<h2 id="ÈÄöËøá-prettier-Ê†ºÂºèÂåñ‰ª£Á†Å"><a href="#%E9%80%9A%E8%BF%87-prettier-%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÈÄöËøá Prettier Ê†ºÂºèÂåñ‰ª£Á†Å</h2>
<p>React ÊòØÁ¨¨‰∏Ä‰∏™<a href="https://github.com/facebook/react/pull/9101">ÂÆåÂÖ®Êã•Êä±</a><a href="https://prettier.io/">Prettier</a>ÁöÑÂ§ßÂûãËΩØ‰ª∂Â∫ì‰πã‰∏ÄÔºåÈÄöËøáÂÖ∂Êù•Ëá™Âä®Ê†ºÂºèÂåñ‰ª£Á†Å„ÄÇÊàë‰ª¨ÂΩìÂâçÁöÑ Prettier ÈÖçÁΩÆÁªÑÊàêÔºö</p>
<ul>
<li><a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/prettier/index.js#L71-L77">‰ΩøÁî® Prettier Node API ÁöÑ</a>Êú¨Âú∞ÁöÑ <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/package.json#L115"><code class="gatsby-code-text">yarn prettier</code></a> ÂëΩ‰ª§Êù•Ê†ºÂºèÂåñÊñá‰ª∂„ÄÇÊàë‰ª¨‰∏ÄËà¨Âú®Êèê‰∫§ÂèòÊõ¥‰πãÂâçËøêË°å„ÄÇÂÖ∂ÈùûÂ∏∏Âø´ÔºåÂõ†‰∏∫ÂÖ∂‰ªÖÊ£ÄÊü•<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/shared/listChangedFiles.js#L29-L33">‰πãÂâç‰ªéËøúÁ®ãÊúçÂä°Âô®‰∏ãÂèëÁöÑÂèòÊõ¥Êñá‰ª∂</a>„ÄÇ</li>
<li><a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/prettier/index.js#L79-L90">ËøêË°å Prettier</a> ËÑöÊú¨ÊòØÊàë‰ª¨<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/scripts/circleci/test_entry_point.sh#L10">ÊåÅÁª≠ÈõÜÊàêÊ£ÄÊü•</a>ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂÖ∂‰∏ç‰ºöÂ∞ùËØïÈáçÂÜôÊñá‰ª∂Ôºå‰ΩÜÂÖ∂‰ªçÊúâÂèØËÉΩÊûÑÂª∫Â§±Ë¥•Ëã•‰ªª‰ΩïÊñá‰ª∂Âíå Prettier ËæìÂá∫ÁöÑÊñá‰ª∂‰∏çÂêå„ÄÇËøôÁ°Æ‰øù‰∫ÜÈô§ÈùûÂÖ∂Â∑≤ÁªèË¢´ÂÆåÂÖ®Ê†ºÂºèÂåñÔºåÂê¶ÂàôÊàë‰ª¨Êó†Ê≥ïÂêàÂπ∂Êèê‰∫§ËØ∑Ê±Ç„ÄÇ</li>
</ul>
<p>‰∏ÄÈÉ®ÂàÜÂõ¢ÈòüÊàêÂëò‰πüÂ∑≤ÁªèÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫<a href="https://prettier.io/docs/en/editors.html">ÁºñËØëÂô®ÈõÜÊàê</a>„ÄÇÊàë‰ª¨ÂØπ Prettier ÁöÑ‰ΩìÈ™åÈùûÂ∏∏Ê£íÔºåÊàë‰ª¨‰πüÊé®ËçêÁªôÂÖ∂‰ªñ‰ªª‰ΩïÂÜô JavaScript ÁöÑÂõ¢Èòü„ÄÇ</p>
<h2 id="ÈáçÁªÑÊàêÂçï‰∏Ä‰ªìÂ∫ì"><a href="#%E9%87%8D%E7%BB%84%E6%88%90%E5%8D%95%E4%B8%80%E4%BB%93%E5%BA%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÈáçÁªÑÊàêÂçï‰∏Ä‰ªìÂ∫ì</h2>
<p>Ëá™‰ªé React Ë¢´ÂàÜËß£ÊàêÂåÖÔºåÂÖ∂Â∑≤ÁªèÊàê‰∏∫‰∫ÜÁöÑ<a href="https://danluu.com/monorepo/">Áã¨Á´ãÂ∫ìÔºàmonorepoÔºâ</a>Ôºö‰∏ÄÁ≥ªÂàóÁöÑÂåÖË¢´ÊîæÂú®‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂ∫ì‰∏ã„ÄÇËøô‰ΩøÂæóÂÖ∂Êõ¥ÂÆπÊòìËøõË°åË∞ÉÊï¥ÂíåÂÖ±Áî®Â∑•ÂÖ∑Ôºå‰ΩÜÊàë‰ª¨ÁöÑÁõÆÂΩïÁªìÊûÑÂµåÂ•óËøáÊ∑±‰ª•Ëá¥‰∫éÈöæ‰ª•ÁêÜËß£„ÄÇÂì™‰∏™Êñá‰ª∂ÂΩíÂ±û‰∫éÂì™‰∏™ÂåÖÂπ∂‰∏çÊòØÂæàÊ∏ÖÊô∞„ÄÇËá™ React 16 ÂèëÂ∏É‰πãÂêéÔºåÊàë‰ª¨ÂÜ≥ÂÆöÂÆåÂÖ®ÈáçÊñ∞Ë∞ÉÊï¥‰ªìÂ∫ìÁªìÊûÑ„ÄÇËøôÂ∞±ÊòØÊàë‰ª¨ÁöÑÊàêÊûú„ÄÇ</p>
<h3 id="ËøÅÁßªÂà∞-yarn"><a href="#%E8%BF%81%E7%A7%BB%E5%88%B0-yarn" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËøÅÁßªÂà∞ Yarn</h3>
<p>Yarn ÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑Âú®Âá†‰∏™ÊúàÂâç<a href="https://yarnpkg.com/blog/2017/08/02/introducing-workspaces/">ÂºïÂÖ•‰∫Ü‰∏ÄÁßçÁß∞‰∏∫Â∑•‰ΩúÈó¥ÔºàWorkspacesÔºâÁöÑÁâπÊÄß</a>„ÄÇËøô‰∏ÄÁâπÊÄßËÉΩÂ§üËÆ©‰Ω†ÂëäËØâ Yarn ‰Ω†ÁöÑÁã¨Á´ãÂ∫ìÁöÑÂåÖÂú®Êñá‰ª∂ÁõÆÂΩïÁöÑ‰ªÄ‰πà‰ΩçÁΩÆ„ÄÇÊØè‰∏ÄÊ¨°‰Ω†ËøêË°å <code class="gatsby-code-text">yarn</code>ÔºåÈô§‰∫ÜÂÆâË£Ö‰Ω†ÁöÑ‰æùËµñÂÆÉËøò‰ºöËÆæÁΩÆ‰ªé‰Ω†È°πÁõÆÁöÑ <code class="gatsby-code-text">node_modules</code> ÊåáÂêë‰Ω†ÁöÑÂåÖÁöÑËµÑÊ∫êÊñá‰ª∂ÁöÑÁ¨¶Âè∑ÈìæÊé•ÔºàsymlinkÔºâ„ÄÇ</p>
<p>Áî±‰∫éÊúâÂ∑•‰ΩúÈó¥ÔºåÊàë‰ª¨Ëá™Â∑±ÁöÑÂåÖ‰πãÈó¥ÁöÑÂÆåÂÖ®ÂºïÂÖ•Ôºà‰æãÂ¶Ç‰ªé <code class="gatsby-code-text">react-dom</code> ‰∏≠ÂºïÂÖ• <code class="gatsby-code-text">react</code>Ôºâ‰ªÖËÉΩÂ§üÂíå‰ªª‰ΩïÊîØÊåÅ Node Ëß£ÊûêÊú∫Âà∂ÁöÑÂ∑•ÂÖ∑‰∏ÄËµ∑‰ΩøÁî®„ÄÇÊàë‰ª¨ÈÅáÂà∞ÁöÑÂîØ‰∏ÄÈóÆÈ¢òÂàôÊòØ Jest Ê≤°ÊúâÂú®ÈìæÊé•ÂåÖÂÜÖÈÉ®ËøõË°åËΩ¨Êç¢Ôºå‰ΩÜÊàë‰ª¨<a href="https://github.com/facebook/jest/pull/4761">ÂèëÁé∞‰∫Ü‰øÆÂ§çÂäûÊ≥ï</a>ÔºåÂπ∂Â∞ÜÂÖ∂ÂêàÂπ∂Âà∞ Jest ‰∏≠„ÄÇ</p>
<p>‰∏∫ÊîØÊåÅ Yarn Â∑•‰ΩúÈó¥ÔºåÊàë‰ª¨Â¢ûÂä†‰∫Ü <code class="gatsby-code-text">&quot;workspaces&quot;: [&quot;packages/*&quot;]</code> Âà∞Êàë‰ª¨ÁöÑ <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/package.json#L4-L6"><code class="gatsby-code-text">package.json</code></a> ‰∏≠ÔºåÂπ∂Â∞ÜÊâÄÊúâÁöÑ‰ª£Á†ÅÁßªÂÖ•Âà∞<a href="https://github.com/facebook/react/tree/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages">È°∂Â±ÇÁöÑ <code class="gatsby-code-text">packages/*</code> Êñá‰ª∂Â§π‰∏≠</a>ÔºåÊØè‰∏™ÈÉΩÊúâÂçïÁã¨ÁöÑ <code class="gatsby-code-text">package.json</code> Êñá‰ª∂</p>
<p>ÊØè‰∏™ÂåÖ‰ª•Áõ∏ÂêåÁöÑÊñπÂºèÁªÑÁªá„ÄÇÂØπ‰∫éÊØè‰∏Ä‰∏™ÂÖ¨ÂºÄÁöÑ API ÂÖ•Âè£Â¶Ç <code class="gatsby-code-text">react-dom</code> Êàñ <code class="gatsby-code-text">react-dom/server</code>ÔºåÂú®ÂåÖÁöÑÊ†πÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™Êñá‰ª∂ÂØπÊù•Ëá™ <code class="gatsby-code-text">/src/</code> ‰∏ãÁöÑÂ≠êÁõÆÂΩïÈáçÊñ∞Êö¥Èú≤„ÄÇÂ∞ÜÂÖ•Âè£ÊåáÂêëÊ∫ê‰ª£Á†ÅËÄå‰∏çÊòØÊûÑÂª∫ÁâàÊú¨ÊòØÊúâÊÑèËÄå‰∏∫‰πã„ÄÇÈÄöÂ∏∏ÔºåÊàë‰ª¨Âú®ÂºÄÂèëÊúüÈó¥‰ºöÂú®ÊØè‰∏ÄÊ¨°ÂèòÊõ¥ÂêéÈáçÊñ∞ËøêË°åÈÉ®ÂàÜÊµãËØï„ÄÇÂøÖÈ°ªËøõË°åÊûÑÂª∫È°πÁõÆÊù•ËøêË°åÊµãËØï‰ºöÂá∫Â•áÁöÑÊÖ¢„ÄÇÂΩìÊàë‰ª¨Â∞ÜÂåÖÂèëÂ∏ÉÂà∞ npm Êó∂ÔºåÊàë‰ª¨ÂÜçÂú® <code class="gatsby-code-text">/npm/</code> Êñá‰ª∂Â§π‰∏ãÂ∞ÜÂÖ•Âè£Êñá‰ª∂ÊåáÂêëÊûÑÂª∫ÁâàÊú¨„ÄÇ</p>
<p>Âπ∂‰∏çÊòØÊâÄÊúâÂåÖÈÉΩË¶ÅÂèëÂ∏ÉÂà∞ npm ‰∏ä„ÄÇ‰æãÂ¶ÇÔºåÊàë‰ª¨‰øùÁïô‰∏Ä‰∫õÂæàÂ∞èÁöÑÂ∑•ÂÖ∑ÂáΩÊï∞Âπ∂ÂèØ‰ª•ÂÆâÂÖ®Âú∞Â§çÂà∂Âà∞‰∏Ä‰∏™<a href="https://github.com/facebook/react/tree/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/shared">Áß∞‰∏∫ <code class="gatsby-code-text">shared</code> ÁöÑ‰º™ÂåÖ</a>„ÄÇÊàë‰ª¨ÁöÑÊâìÂåÖÂô®Ë¢´ÈÖçÁΩÆÊàê<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L326-L329">‰ªÖ‰ºöÂ∞ÜÂ£∞ÊòéÂú® <code class="gatsby-code-text">package.json</code> ÁöÑ <code class="gatsby-code-text">dependencies</code> ‰∏≠ÁöÑÈ°πÁõÆ‰Ωú‰∏∫Á¨¨‰∏âÊñπÂ∫ì</a>ÔºåÂõ†Ê≠§ÂÖ∂ÂèØ‰ª•ÂæàÈ°∫Âà©Âú∞Â∞Ü <code class="gatsby-code-text">shared</code> ÁöÑ‰ª£Á†ÅÊâìÂåÖÂà∞ <code class="gatsby-code-text">react</code> Âíå <code class="gatsby-code-text">react-dom</code> ‰∏≠ËÄå‰∏ç‰ºöÂú®ÊûÑÂª∫ÁâàÊú¨‰∏≠Áïô‰∏ã‰ªª‰ΩïÂØπ <code class="gatsby-code-text">shared/</code> ÁöÑÂºïÁî®„ÄÇÂõ†Ê≠§‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® Yarn Â∑•‰ΩúÈó¥Âç≥‰Ωø‰Ω†‰∏çÊâìÁÆóÂèëÂ∏ÉÂÆûÈôÖÁöÑ npm ÂåÖÔºÅ</p>
<h3 id="ÁßªÈô§Ëá™ÂÆö‰πâÊ®°ÂùóÁ≥ªÁªü"><a href="#%E7%A7%BB%E9%99%A4%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÁßªÈô§Ëá™ÂÆö‰πâÊ®°ÂùóÁ≥ªÁªü</h3>
<p>ËøáÂéªÔºåÊàë‰ª¨‰ΩøÁî®‰∫Ü‰∏Ä‰∏™Áß∞‰∏∫ ‚ÄúHaste‚Äù ÁöÑÈùûÊ†áÂáÜÊ®°ÂùóÁ≥ªÁªüÔºåÂÖ∂ËÉΩÂ§üËÆ©Êàë‰ª¨ÈÄöËøáÂîØ‰∏ÄÁöÑ <code class="gatsby-code-text">@providesModule</code> ‰ªéÂÖ∂‰ªñÊñá‰ª∂ÂºïÁî®Âú®ÂÖ∂‰ªñ‰ªª‰ΩïÂú∞ÊñπÁöÑ‰ªª‰ΩïÊñá‰ª∂„ÄÇÂÖ∂ÂÆåÂÖ®ÈÅøÂÖç‰∫ÜÁ±ª‰ºº <code class="gatsby-code-text">../../../../</code> Áõ∏ÂØπË∑ØÂæÑËøáÊ∑±ÁöÑÂºïÁî®ÈóÆÈ¢òÂπ∂‰∏îÂØπ‰∫éÁîü‰∫ß‰ª£Á†ÅÊù•ËØ¥ÂæàÊ£í„ÄÇÁÑ∂ËÄåÔºåËøô‰ΩøÂæóÂú®ÂåÖ‰πãÈó¥ÂæàÈöæÁêÜËß£ÂÖ∂‰æùËµñÂÖ≥Á≥ª„ÄÇÊàë‰ª¨‰πü‰∏çÂæó‰∏çÈáçÊñ∞Ë∞ÉÊï¥Ëøô‰∏ÄÈªëÁßëÊäÄ‰ΩøÂÖ∂ËÉΩÂíå‰∏çÂêåÁöÑÂ∑•ÂÖ∑‰∏ÄÂêåËøêË°å„ÄÇ</p>
<p>Êàë‰ª¨ÂÜ≥ÂÆö <a href="https://github.com/facebook/react/pull/11303">ÁßªÈô§ Haste</a> Âπ∂‰ΩøÁî® Node ÁöÑÁõ∏ÂØπÂºïÁî®ÁöÑËß£ÊûêÊú∫Âà∂Êù•‰ª£Êõø„ÄÇ‰∏∫ÈÅøÂÖçÁõ∏ÂØπË∑ØÂæÑËøáÊ∑±ÁöÑÈóÆÈ¢òÔºåÊàë‰ª¨Â∞Ü<a href="https://github.com/facebook/react/pull/11304">Êàë‰ª¨ÁöÑ‰ªìÂ∫ìÁªìÊûÑËøõË°åÊâÅÂπ≥ÂåñÂ§ÑÁêÜ</a> ÊâÄ‰ª•Âú®ÊØè‰∏™ÂåÖÂÜÖÈÉ®‰πãÂ§öÊúâ‰∏ÄÂ±ÇÊ∑±Â∫¶Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-text"><code class="gatsby-code-text">|-react
|  |-npm
|  |-src
|-react-dom
|  |-npm
|  |-src
|  |  |-client
|  |  |-events
|  |  |-server
|  |  |-shared</code></pre>
      </div>
<p>ËøôÊ†∑ÔºåÂÖ∂Áõ∏ÂØπË∑ØÂæÑÂè™‰ºöÂåÖÂê´‰∏Ä‰∏™ <code class="gatsby-code-text">./</code> Êàñ <code class="gatsby-code-text">../</code>ÔºåÂêéË∑üÊñá‰ª∂Âêç„ÄÇËã•‰∏Ä‰∏™ÂåÖÈúÄË¶ÅÂºïÂÖ•Âè¶Â§ñ‰∏Ä‰∏™ÔºåÂÖ∂ÂèØ‰ª•ÈÄöËøáÁªùÂØπË∑ØÂæÑ‰ªéÈ°∂Â±ÇÂÖ•Âè£Êù•ÂºïÂÖ•„ÄÇ</p>
<p>ÂÆûË∑µ‰∏≠ÔºåÊàë‰ª¨‰ªçÁÑ∂‰ºöÊúâ<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/react-dom/src/client/ReactDOMFiberComponent.js#L10-L11">‰∏Ä‰∫õË∑®ÂåÖÈó¥ÁöÑ‚ÄúÂÜÖÈÉ®‚ÄùÂºïÂÖ•</a>„ÄÇÂÖ∂ÊâìÁ†¥‰∫ÜËøô‰∏ÄÂéüÂàôÔºå‰ΩÜÂæàÊòéÁ°ÆÔºåÊàë‰ª¨ËÆ°ÂàíÈÄêÊ∏êÊëÜËÑ±Ëøô‰∏ÄÊñπÂºè„ÄÇ</p>
<h2 id="ÁºñËØëÊàêÊâÅÂπ≥ÂåñÁöÑÂåÖ"><a href="#%E7%BC%96%E8%AF%91%E6%88%90%E6%89%81%E5%B9%B3%E5%8C%96%E7%9A%84%E5%8C%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÁºñËØëÊàêÊâÅÂπ≥ÂåñÁöÑÂåÖ</h2>
<p>ÂéÜÂè≤‰∏äÔºåReact Ë¢´ÂàÜÊàê‰∏§Áßç‰∏çÂêåÁöÑÂΩ¢ÂºèÔºö‰Ωú‰∏∫‰∏Ä‰∏™ÂçïÊñá‰ª∂ÊûÑÂª∫ÁâàÊú¨‰ª•ËÆ©‰Ω†ËÉΩÂ§üÂú®ÊµèËßàÂô®‰∏≠ÈÄöËøá‰∏Ä‰∏™ <code class="gatsby-code-text">&lt;script&gt;</code> Ê†áÁ≠æÂºïÁî®ÔºåÂíå‰Ωú‰∏∫ CommonJS Ê®°ÂùóÁöÑÈõÜÂêà‰ª•ËÆ©‰Ω†ËÉΩÂ§üÈÄöËøáÁ±ª‰ºº webpack Êàñ Browserify Êù•ËøõË°åÊâìÂåÖ„ÄÇ</p>
<p>React 16 ‰πãÂâçÔºå‰Ωú‰∏∫ npm ÂåÖÂèëÂ∏ÉÁöÑÁªÑÊàêÈÉ®ÂàÜÁöÑÊØè‰∏™ React Ê∫êÊñá‰ª∂ÂØπÂ∫îÁùÄ‰∏Ä‰∏™ CommonJS Ê®°Âùó„ÄÇÂØºÂÖ• <code class="gatsby-code-text">react</code> Êàñ <code class="gatsby-code-text">react-dom</code> ‰ΩøÂæóÊâìÂåÖÂô®‰ªéÂÆÉ‰ª¨ÈÄöËøá CommonJS Ê®°ÂùóÂú®<a href="https://unpkg.com/react@15/lib/">ÂÜÖÈÉ®ÁöÑ <code class="gatsby-code-text">lib</code> Êñá‰ª∂Â§π</a>ÊûÑÂª∫ÁöÑ‰æùËµñÊ†ë‰Ωú‰∏∫<a href="https://unpkg.com/react@15/lib/">ÂÖ•Âè£</a>„ÄÇ</p>
<p>ÁÑ∂ËÄåÔºåËøô‰∏ÄÊñπÂºèÊúâËØ∏Â§öÁº∫ÁÇπÔºö</p>
<ul>
<li><strong>‰∏ç‰∏ÄËá¥</strong> ‰∏çÂêåÁöÑÂ∑•ÂÖ∑ÂØπ‰∫éÂºïÂÖ•Áõ∏ÂêåÁöÑ React ‰ª£Á†Å‰ºö‰∫ßÁîü‰∏çÂêåÁöÑÂ∞∫ÂØ∏ÔºåÁõ∏Â∑ÆÊúÄÂ§ö‰ºöËææÂà∞ 30 kBÔºàgzip ‰πãÂâçÔºâ„ÄÇ</li>
<li><strong>ÂØπ‰∫éÊâìÂåÖÂô®Áî®Êà∑Êù•ËØ¥ÈùûÂ∏∏‰ΩéÊïà</strong> Áé∞‰ªäÂ§ßÂ§öÊï∞ÊâìÂåÖÂô®‰ºöÂú®Ê®°ÂùóËæπÁïå‰∫ßÁîüÂ§ßÈáèÁöÑ ‚ÄúËÉ∂Ê∞¥‰ª£Á†Å‚Äù„ÄÇÂÖ∂ËÆ©Ê®°ÂùóÈó¥ËÉΩÂ§üÁõ∏‰∫íÁã¨Á´ãÔºå‰ΩÜÂ¢ûÂä†‰∫ÜËß£ÊûêÊó∂Èó¥ÔºåÂåÖÁöÑÂ∞∫ÂØ∏‰ª•ÂèäÊûÑÂª∫Êó∂Èó¥„ÄÇ</li>
<li><strong>ÂØπ‰∫é Node Áî®Êà∑Êù•ËØ¥ÈùûÂ∏∏‰ΩéÊïà</strong> ÂΩìÂú® Node ÁéØÂ¢É‰∏ãËøêË°åÊó∂ÔºåÂú®ÈíàÂØπÂºÄÂèëÊ®°ÂºèÁöÑ‰ª£Á†ÅÊâßË°åÂâçËøêË°å <code class="gatsby-code-text">process.env.NODE_ENV</code> ‰ºöÁî±‰∫éÂÖ∂Ê£ÄÊü•ÁéØÂ¢ÉÂèòÈáèËÄåÂ∏¶Êù•‰∫åÂ®ÉÁöÑÂºÄÈîÄ„ÄÇËøôÊãñÊÖ¢‰∫Ü React ÊúçÂä°Á´ØÊ∏≤Êüì„ÄÇÊàë‰ª¨‰πüÊó†Ê≥ïÁºìÂ≠òÂà∞‰∏Ä‰∏™ÂèòÈáèÂÜÖÔºåÂõ†‰∏∫ÂÖ∂Â¶®Á¢ç‰∫Ü Uglify ËøõË°åÊó†Áî®‰ª£Á†ÅÁöÑÊì¶Èô§„ÄÇ</li>
<li><strong>Á†¥Âùè‰∫ÜÂ∞ÅË£Ö</strong> React ÂÜÖÈÉ®Êñá‰ª∂ÂêåÊó∂Ë¢´Êö¥Èú≤Âú®ÂºÄÊ∫êÁ§æÂå∫ÔºàÈÄöËøá <code class="gatsby-code-text">react-dom/lib/*</code> ÂºïÂÖ•ÔºâÂíå Facebook ÂÜÖÈÉ®„ÄÇÈ¶ñÂÖàÂÖ∂ÊòØ‰∏ÄÁßçÈùûÂ∏∏Êñπ‰æøÂú®È°πÁõÆÂÜÖÂÖ±‰∫´Â∑•ÂÖ∑ÂáΩÊï∞ÁöÑÊñπÂºèÔºå‰ΩÜÂêåÊó∂Ëøô‰πüÂ¢ûÂä†‰∫ÜÁª¥Êä§ÊàêÊú¨ÔºåÂõ†‰∏∫ÈáçÂëΩÂêçÊàñÊîπÂèòÂÜÖÈÉ®ÂáΩÊï∞ÁöÑÂèÇÊï∞Á±ªÂûãÈÉΩÂèØËÉΩ‰ºöÁ†¥Âùè‰∏çÁõ∏ÂÖ≥ÁöÑÈ°πÁõÆ„ÄÇ</li>
<li><strong>Â¶®Á¢çÊñ∞ÁâπÊÄßÂÆûÈ™å</strong> ÂØπ‰∫é React Âõ¢ÈòüÊù•ËØ¥Ê≤°ÊúâÂÖ∂‰ªñÊñπÂºèÊù•ÂÆûÈ™å‰ªª‰ΩïÊñ∞ÁöÑÁºñËØëÊäÄÊúØ„ÄÇ‰æãÂ¶ÇÔºåÁêÜËÆ∫‰∏äÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÊÉ≥Ë¶ÅÂ∫îÁî®<a href="https://developers.google.com/closure/compiler/docs/api-tutorial3">Êñ∞ÁöÑ Google Closure Compiler</a> ÂéãÁº©Êàñ <a href="https://prepack.io/">Prepack</a> Êù•Â§ÑÁêÜÊàë‰ª¨ÁöÑÈÉ®ÂàÜ‰ª£Á†ÅÔºå‰ΩÜ‰ªñ‰ª¨Ë¢´ËÆæËÆ°ÊàêÊòØÈíàÂØπÂÆåÊï¥ÁöÑÂåÖËÄå‰∏çÊòØÊàë‰ª¨ÊõæÁªèÂèëÂ∏ÉÂà∞ npm ÁöÑÂ∞èÁöÑÁã¨Á´ãÊ®°Âùó„ÄÇ</li>
</ul>
<p>Áî±‰∫éËøôÊ†∑ÈÇ£Ê†∑ÁöÑÈóÆÈ¢òÔºåÊàë‰ª¨Âú® React 16 Ë∞ÉÊï¥‰∫ÜÁ≠ñÁï•„ÄÇÂØπ‰∫é Node.js ÂíåÊâìÂåÖÂô®Êàë‰ª¨‰ªçÂèëÂ∏ÉÂà∞ CommonJS Ê®°ÂùóÔºåÊØè‰∏Ä‰∏™ÂÖ•Âè£Êàë‰ª¨‰ªÖÂèëÂ∏É‰∏§‰∏™ CommonJS ÂåÖËÄå‰∏çÊòØÂú® npm ÂåÖ‰∏≠ÂèëÂ∏ÉËÆ∏Â§öÁã¨Á´ãÁöÑÊñá‰ª∂</p>
<p>‰æãÂ¶ÇÔºåÂΩì‰Ω†Âú® React 16 ÂºïÂÖ• <code class="gatsby-code-text">react</code> Êó∂ÔºåÊâìÂåÖÂô®‰ºöÂèëÁé∞<a href="https://unpkg.com/react@16/index.js">ÂÖ•Âè£</a>ÔºåÂè™ÈúÄË¶ÅÈáçÊñ∞ÂØºÂá∫‰∏§‰∏™Êñá‰ª∂‰∏≠ÁöÑ‰∏Ä‰∏™Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.production.min.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.development.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Âú® React Êèê‰æõÁöÑÊØè‰∏™ÂåÖÈáåÔºå <a href="https://unpkg.com/react@16/cjs/"><code class="gatsby-code-text">cjs</code> Êñá‰ª∂Â§π</a> (‚ÄúCommonJS‚Äù ÁöÑÁÆÄÂÜô) ‰∏ãÈù¢ÂåÖÂê´‰∫Ü‰∏∫ÊØè‰∏™ÂÖ•Âè£Ëµ∑ÁÇπÊèê‰æõÁöÑÂºÄÂèëÁâàÊú¨ÂíåÈ¢ÑÂèëÂ∏ÉÁâàÊú¨ÁöÑ bundle„ÄÇ</p>
<p>ÊØîÂ¶ÇËØ¥Ôºå<a href="https://unpkg.com/react@16/cjs/react.development.js"><code class="gatsby-code-text">react.development.js</code></a> ÊòØ‰æõÂºÄÂèëÁâà‰ΩøÁî®ÁöÑ„ÄÇÂÆÉÂÖ∑ÊúâËæÉÂº∫ÁöÑÂèØËØªÊÄßÂπ∂‰∏îÊúâ‰∏Ä‰∫õÊ≥®Èáä„ÄÇÂè¶‰∏ÄÊñπÈù¢Ôºå<a href="https://unpkg.com/react@16/cjs/react.production.min.js"><code class="gatsby-code-text">react.production.min.js</code></a> Âú®Ë¢´ÂèëÂ∏ÉÂà∞ npm ‰πãÂâçÊòØÁªèËøáÂéãÁº©‰ºòÂåñÁöÑ„ÄÇ</p>
<p>Ê≥®ÊÑèËøôÂíåÊàë‰ª¨‰πãÂâç‰ΩøÁî®ÁöÑÂçïÊñá‰ª∂ÁöÑÊµèËßàÂô®ÊûÑÂª∫Á≠ñÁï•ÂÆûË¥®‰∏äÊòØÈùûÂ∏∏Áõ∏‰ººÁöÑÔºàÁé∞Âú®‰ªÖÊòØÈáçÊñ∞ËßÑÂàíÂà∞ <a href="https://unpkg.com/react@16/umd/"><code class="gatsby-code-text">umd</code> ÁõÆÂΩï</a>‰∏ãÔºå<a href="https://www.davidbcalhoun.com/2014/what-is-amd-commonjs-and-umd/">ÈÄöÁî®Ê®°ÂùóÂÆö‰πâÔºàUniversal Module DefinitionÔºâ</a>ÁöÑÁº©ÂÜôÔºâ„ÄÇÁé∞Âú®Êàë‰ª¨‰πüÂØπ CommonJS ÊûÑÂª∫ÈááÁî®ÂêåÊ†∑ÁöÑÁ≠ñÁï•„ÄÇ</p>
<h3 id="ËøÅÁßªËá≥-rollup"><a href="#%E8%BF%81%E7%A7%BB%E8%87%B3-rollup" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËøÅÁßªËá≥ Rollup</h3>
<p>‰ªÖ‰ªÖÊòØÂ∞Ü CommonJS Ê®°ÂùóÁºñËØëÊàêÂçïÊñá‰ª∂ÂåÖÂπ∂‰∏çËÉΩËß£ÂÜ≥‰πãÂâçÁöÑÊâÄÊúâÈóÆÈ¢ò„ÄÇËÄåÁúüÊ≠£Ê†áÂøóÊÄßÁöÑËÉúÂà©ÊòØÂ∞ÜÊàë‰ª¨ÁöÑÊâìÂåÖÁ≥ªÁªü‰ªé Browserify Âà∞ <a href="https://rollupjs.org/">Rollup</a><a href="https://github.com/facebook/react/pull/9327">ËøÅÁßª</a>„ÄÇ</p>
<p><a href="https://medium.com/webpack/webpack-and-rollup-the-same-but-different-a41ad427058c">Rollup Êú¨Ë¥®‰∏äË¢´ËÆæËÆ°ÊàêÈíàÂØπÂ∫ìËÄå‰∏çÊòØÂ∫îÁî®</a>ÔºåÂÖ∂ÈùûÂ∏∏ÈÄÇÂêà React ËøôÊ†∑ÁöÑÁî®‰æã„ÄÇÂÆÉÈùûÂ∏∏Â•ΩÁöÑËß£ÂÜ≥‰∫Ü‰∏Ä‰∏™ÈóÆÈ¢òÔºöÂ¶Ç‰ΩïÂ∞ÜÂ§ö‰∏™Ê®°ÂùóÁöÑ‰ª£Á†ÅÈÄöËøáÈùûÂ∏∏Â∞èÁöÑÂûÉÂúæ‰ª£Á†ÅÊï¥ÂêàÂà∞‰∏Ä‰∏™ÊâÅÂπ≥ÂåñÊñá‰ª∂‰∏≠„ÄÇ‰∏∫‰∫ÜËææÂà∞Ëøô‰∏ÄË¶ÅÊ±ÇÔºåÂÖ∂Â∞ÜÊâÄÊúâÁöÑ‰ª£Á†ÅÊîæÂà∞Âêå‰∏Ä‰ΩúÁî®Âüü‰∏ãÂπ∂ÈáçÂëΩÂêçÂèòÈáè‰ª•‰øùËØÅ‰ªñ‰ª¨‰∏ç‰ºöÂÜ≤Á™ÅÔºåËÄåÈùûÂÉèÂÖ∂‰ªñÊâìÂåÖÂô®‰∏ÄÊ†∑Â∞ÜÊ®°ÂùóÂèòÊàêÂáΩÊï∞„ÄÇËøôÊ†∑‰∫ßÁîüÁöÑ‰ª£Á†ÅÊõ¥Êòì‰∫é JavaScript ÂºïÊìéËß£ÊûêÔºåÊòì‰∫éÈòÖËØªÔºå‰πüÊòì‰∫éÂéãÁº©Âô®‰ºòÂåñ„ÄÇ</p>
<p>Rollup ÁõÆÂâçËøò‰∏çÊîØÊåÅ‰∏Ä‰∫õÂØπ‰∫éÂ∫îÁî®ÊûÑÂª∫Êù•ËØ¥ÈùûÂ∏∏ÈáçË¶ÅÁöÑÁâπÊÄßÔºå‰æãÂ¶Ç‰ª£Á†ÅÂàÜÈöî„ÄÇÁÑ∂ËÄåÔºåÂÖ∂Âπ∂‰∏çÁÆóËá¥Âäõ‰∫éÊõøÊç¢ÊéâËØ∏Â¶ÇÈùûÂ∏∏ÊìÖÈïøÂ§ÑÁêÜËøôÁ±ªÂ∑•‰ΩúÁöÑ webpack„ÄÇRollup ÈùûÂ∏∏ÈÄÇÂêàÂ¶Ç React Á≠â <em>Ê°ÜÊû∂</em>ÔºåÂõ†‰∏∫ÂÖ∂ËÉΩÂ§üË¢´È¢ÑÊûÑÂª∫ËÄåÂêéË¢´ÈõÜÊàêÂà∞Â∫îÁî®‰∏≠„ÄÇ</p>
<p>‰Ω†ÂèØ‰ª•Âú®<a href="https://github.com/facebook/react/blob/8ec146c38ee4f4c84b6ecf59f52de3371224e8bd/scripts/rollup/build.js#L336-L362">ËøôÈáå</a>ÊâæÂà∞Êàë‰ª¨ÁöÑ Rollup ÊûÑÂª∫ÈÖçÁΩÆÔºåÂíå<a href="https://github.com/facebook/react/blob/8ec146c38ee4f4c84b6ecf59f52de3371224e8bd/scripts/rollup/build.js#L196-L273">ÂΩìÂâçÊàë‰ª¨Âú®Áî®ÁöÑ‰∏ÄÁ≥ªÂàóÊèí‰ª∂</a>„ÄÇ</p>
<h3 id="ËøÅÁßªËá≥-google-closure-compiler"><a href="#%E8%BF%81%E7%A7%BB%E8%87%B3-google-closure-compiler" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËøÅÁßªËá≥ Google Closure Compiler</h3>
<p>Âú®ËøÅÁßªËá≥ÊâÅÂπ≥ÂåñÂåÖ‰πãÂêéÔºåÊàë‰ª¨ÂºÄÂßãÂú® <a href="https://github.com/google/closure-compiler-js">JavaScript ÁâàÊú¨ÁöÑ Google Closure Compiler</a> ‰∏ã‰ΩøÁî®ÂÆÉÁöÑ‚ÄúÁÆÄÂçï‚ÄùÊ®°Âºè„ÄÇÊ†πÊçÆÊàë‰ª¨ÁöÑÁªèÈ™åÔºåÂç≥‰ΩøÂÖàËøõÁöÑÂéãÁº©ÊäÄÊúØ‰∏çÂèØÁî®ÔºåÂÖ∂‰ªçÁÑ∂ËÉΩÂ§üÊòéÊòæ‰ºò‰∫é UglifyÔºåÁî±‰∫éÂÖ∂ËÉΩÂ§üÊõ¥Â•ΩÁöÑÊ∂àÈô§Êó†Áî®‰ª£Á†ÅÂíåÂú®ÈÄÇÂΩìÁöÑÊó∂ÂÄôÂÜÖËÅîÂáΩÊï∞„ÄÇ</p>
<p>È¶ñÂÖàÔºåÊàë‰ª¨ÂèØ‰ª•ÂØπÊàë‰ª¨ÂèëÂ∏ÉÂà∞ÂºÄÊ∫êÁ§æÂå∫‰ªÖ‰ΩøÁî® Google Closure Compiler„ÄÇÂú® FacebookÔºåÊàë‰ª¨‰ªçÁÑ∂ÈúÄË¶ÅÊ£ÄÊü•ÂåÖÊù•Ëß£ÂéãÔºå‰ª•ËÆ©Êàë‰ª¨ËÉΩÂ§üÂú® React Áîü‰∫ßÁéØÂ¢ÉÂ¥©Ê∫ÉÊó∂ÂÄôËÉΩÂ§üÈÄöËøáÊàë‰ª¨ÁöÑÈîôËØØÊä•ÂëäÂ∑•ÂÖ∑ËøõË°åÂÆö‰ΩçÔºàsymbolicateÔºâ„ÄÇÊàë‰ª¨ÈÄöËøáËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ÂÆåÂÖ®Á¶ÅÊ≠¢ÁºñËØëÂô®ÈáçÂëΩÂêçÁöÑ<a href="https://github.com/google/closure-compiler/pull/2707">Ê†áÂøó</a>Êù•ÂÆåÊàêÂºÄÂèë„ÄÇËøô‰ΩøÂæóÊàë‰ª¨Â∫îÁî®ÂÖ∂‰ªñÂ¶ÇÂáΩÊï∞ÂÜÖËÅîÔºàfunction inliningÔºâÔºå‰ΩÜ‰∏∫ Facebook ÁâπÂÆöÁöÑ React ÊûÑÂª∫ÁâàÊú¨‰øùÁïô‰∫ÜÂÆåÊï¥ÁöÑ‰ª£Á†ÅÂèØËØªÊÄß„ÄÇ‰∏∫‰∫ÜÊèêÈ´òËæìÂá∫ÁöÑÂèØËØªÊÄßÔºåÊàë‰ª¨<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L249-L250">‰πü‰ΩøÁî® Prettier Êù•Ëá™ÂÆö‰πâÊûÑÂª∫</a>„ÄÇÊúâË∂£ÁöÑÊòØÔºåÂú®Ë∞ÉËØïÊûÑÂª∫ÁöÑËøáÁ®ãÊó∂ËøêË°åÁîü‰∫ßÁâàÊú¨ÁöÑÊûÑÂª∫ÂåÖÊòØÂú®ÊûÑÂª∫ÂåÖÈáåÂèëÁé∞Êó†Áî®‰ª£Á†ÅÁöÑ‰∏ÄÁßçÂæàÂ•ΩÁöÑÊñπÂºè„ÄÇ</p>
<p>ÂΩìÂâçÔºåÊâÄÊúâ React ÁöÑ‰∫ßÂìÅÂåÖ <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L235-L248">ÈÄöËøáÂú® Google Closure Compiler ÁÆÄÂçïÊ®°Âºè‰∏ãËøêË°å</a>ÔºåÂêåÊó∂Êàë‰ª¨‰πüÊúüÊúõËÉΩÂ§üÂú®Êú™Êù•ÊîØÊåÅÊõ¥ÂÖàËøõÁöÑ‰ºòÂåñÊñπÊ°à„ÄÇ</p>
<h3 id="Èò≤Ê≠¢Ëã•Êó†Áî®‰ª£Á†ÅË¢´Êì¶Èô§"><a href="#%E9%98%B2%E6%AD%A2%E8%8B%A5%E6%97%A0%E7%94%A8%E4%BB%A3%E7%A0%81%E8%A2%AB%E6%93%A6%E9%99%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Èò≤Ê≠¢Ëã•Êó†Áî®‰ª£Á†ÅË¢´Êì¶Èô§</h3>
<p>ÂΩìÊàë‰ª¨Âú® React ‰∏ä‰ΩøÁî®‰∏Ä‰∏™ÊúâÊïàÁöÑ<a href="https://en.wikipedia.org/wiki/Dead_code_elimination">Êó†Áî®‰ª£Á†ÅÊì¶Èô§</a>ÊñπÊ°àÊó∂ÔºåÊàë‰ª¨Êó†Ê≥ïÂØπ React Áî®Êà∑‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑ÂÅöËÆ∏Â§öÁöÑÂÅáËÆæ„ÄÇ</p>
<p>ÈÄöÂ∏∏ÔºåÂΩì‰Ω†<a href="/docs/optimizing-performance.html#use-the-production-build">Âú®‰∏∫Áîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ‰∏Ä‰∏™ÊâìÂåÖÂô®</a>Êó∂Ôºå‰Ω†ÈúÄË¶ÅÂëäËØâÂÆÉÈÄöËøá <code class="gatsby-code-text">&quot;production&quot;</code>Â≠óÁ¨¶‰∏≤ÊõøÊç¢Êéâ <code class="gatsby-code-text">process.env.NODE_ENV</code>„ÄÇËøô‰∏ÄÁéØËäÇÊúâÊó∂ÂÄôË¢´Áß∞‰∏∫‚ÄúÁéØÂ¢ÉÊ£ÄÊü•ÔºàenvificationÔºâ‚Äù„ÄÇÊÄùËÄÉËøô‰∏Ä‰ª£Á†ÅÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// development-only code</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Âú®ÁéØÂ¢ÉÊ£ÄÊü•ÂêéÔºåËøô‰∏ÄÂà§Êñ≠Êù°‰ª∂Â∞Ü‰ºöÊ∞∏Ëøú‰∏∫ <code class="gatsby-code-text">false</code>ÔºåÂπ∂‰ºöË¢´Â§ßÂ§öÊï∞ÂéãÁº©Âô®ÂÆåÂÖ®Êì¶Èô§Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"production"</span> <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// development-only code</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>ÁÑ∂ËÄåÔºåËã•ÊâìÂåÖÂô®Ë¢´ËØØÈÖçÁΩÆÔºå‰Ω†ÂèØËÉΩÊÑèÂ§ñÂú∞Â∞ÜÂºÄÂèëÁâàÊú¨ÁöÑ‰ª£Á†ÅÂèëÂ∏ÉÂà∞Áîü‰∫ßÁéØÂ¢É‰∏≠„ÄÇÊàë‰ª¨Êó†Ê≥ïÈòªÊ≠¢Ëøô‰∏ÄÈóÆÈ¢òÔºå‰ΩÜÂΩìÂèëÁîüÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∫õÊ≠•È™§ÂáèÂ∞ë‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁî®‰æã„ÄÇ</p>
<h4 id="Èò≤Ê≠¢ËøáÊôöÁéØÂ¢ÉÊ£ÄÊü•"><a href="#%E9%98%B2%E6%AD%A2%E8%BF%87%E6%99%9A%E7%8E%AF%E5%A2%83%E6%A3%80%E6%9F%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Èò≤Ê≠¢ËøáÊôöÁéØÂ¢ÉÊ£ÄÊü•</h4>
<p>Â¶Ç‰πãÂâçÊèêÂà∞ÔºåÊàë‰ª¨ÁöÑÂÖ•Âè£Áé∞Âú®ÁúãËµ∑Êù•ÂÉèËøôÊ†∑Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.production.min.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./cjs/react.development.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>ÁÑ∂ËÄåÔºå‰∏Ä‰∫õÊâìÂåÖÂô®‰ºöÂú®ÁéØÂ¢ÉÊ£ÄÊü•‰πãÂâçÊâßË°å <code class="gatsby-code-text">require</code>„ÄÇÂú®ËøôÊ†∑ÁöÑÊÉÖÂÜµÔºåÂç≥‰Ωø <code class="gatsby-code-text">else</code> Êó†Ê≥ïÊâßË°åÔºåÊñá‰ª∂ <code class="gatsby-code-text">cjs/react.development.js</code> ‰ªçÁÑ∂‰ºöË¢´ÊâìÂåÖ„ÄÇ</p>
<p>‰∏∫‰∫ÜÈò≤Ê≠¢Ëøô‰∏ÄÊÉÖÂÜµÔºåÊàë‰ª¨‰πüÂ∞ÜÊï¥‰∏™ÂºÄÂèëÁâàÊú¨ÁöÑ <code class="gatsby-code-text">cjs/react.development.js</code>  ÂåÖÂÜÖÂÆπÂåÖË£πÂú®Âè¶Â§ñ‰∏Ä‰∏™ <code class="gatsby-code-text">process.env.NODE_ENV</code> Ê£ÄÊü•Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">!==</span> <span class="token string">"production"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// bundle code</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Ëøô‰∏ÄÊñπÂºèÔºåÂç≥‰ΩøÂ∫îÁî®ÊâìÂåÖ‰∫ÜÂºÄÂèëÁâàÊú¨ÂíåÁîü‰∫ßÁâàÊú¨ÁöÑÊñá‰ª∂ÔºåÂºÄÂèëÁâàÊú¨ÁöÑÊñá‰ª∂Âú®ÁéØÂ¢ÉÊ£ÄÊü•ÂêéÂ∞Ü‰ºöÊòØÁ©∫„ÄÇ</p>
<p>È¢ùÂ§ñÁöÑ <a href="https://en.wikipedia.org/wiki/Immediately-invoked_function_expression">IIFE</a> ÂåÖË£πÊòØÊúâÂøÖË¶ÅÁöÑÔºåÂõ†‰∏∫Âú® JavaScript ‰∏≠ <code class="gatsby-code-text">if</code> ËØ≠Âè•ÂÜÖÈÉ®ÁöÑ‰∏Ä‰∫õÂ£∞ÊòéÔºàÂ¶ÇÂáΩÊï∞ÔºâÊó†Ê≥ïË¢´ÊõøÊç¢„ÄÇ</p>
<h4 id="Ê£ÄÊµãÈîôËØØÁöÑÊó†Áî®‰ª£Á†ÅÊì¶Èô§"><a href="#%E6%A3%80%E6%B5%8B%E9%94%99%E8%AF%AF%E7%9A%84%E6%97%A0%E7%94%A8%E4%BB%A3%E7%A0%81%E6%93%A6%E9%99%A4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ê£ÄÊµãÈîôËØØÁöÑÊó†Áî®‰ª£Á†ÅÊì¶Èô§</h4>
<p>Âç≥‰Ωø<a href="https://twitter.com/iamakulov/status/941336777188696066">ÁéØÂ¢ÉÂèòÊõ¥</a>ÔºåËÆ∏Â§öÊµÅË°åÁöÑÊâìÂåÖÂô®ÁõÆÂâç‰ªçÊó†Ê≥ïÂº∫Âà∂Áî®Êà∑ÊåáÂÆöÊòØÂºÄÂèëÊ®°ÂºèÊàñÁîü‰∫ßÊ®°Âºè„ÄÇÂú®ËøôÊ†∑ÁöÑÊÉÖÂÜµÔºå<code class="gatsby-code-text">process.env.NODE_ENV</code> ÈÄöÂ∏∏Áî±ËøêË°åÊó∂ÁöÑ polyfill ËÆæÁΩÆÔºå‰ΩÜÊó†Áî®‰ª£Á†ÅÊì¶Èô§Ê£ÄÊµãÂπ∂‰∏ç‰ºöÊúâÊïà„ÄÇ</p>
<p>Êàë‰ª¨Êó†Ê≥ïÂÆåÂÖ®ÈòªÊ≠¢ React Áî®Êà∑ÈîôËØØÈÖçÁΩÆ‰ªñ‰ª¨ÁöÑÊâìÂåÖÂô®Ôºå‰ΩÜÊàë‰ª¨ÂèØ‰ª•Âú® <a href="https://github.com/facebook/react-devtools">React DevTools</a> ÈáåÂºïÂÖ•‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÊ£ÄÊü•„ÄÇ</p>
<p>Ëã•ÊâßË°åÁöÑÊòØÂºÄÂèëÂåÖÔºå<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/packages/react-dom/src/client/ReactDOM.js#L1333-L1335">React DOM ‰ºöÊä•ÂëäÁªô React ÂºÄÂèëÂ∑•ÂÖ∑</a>Ôºö</p>
<br>

  <a class="gatsby-resp-image-link" href="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png" style="display: block" target="_blank" rel="noopener">
  
  <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAABI0lEQVQY04WQ3XKCMBCFef+X6k2tkAIGRa1Ox5kOGiCAkt81gtINM73uudicTTaz324w/qfnn9Bi6u739nr9eX8rDvvAzLLWAlitNXqttFJq9to/WOsLAB7OPMfHNE3DOJqm7rsuSJKURITSLM/zMAw3m3WWZXEcRxFZpWmSovxJSPx9WHXNBcBJIWeQMbgwxmteMnY+nxl63vCm5byu8bKsGCs5523TFkXBWFVzXlXV6XQCgGEYAqSaCT2b0lIpibTaeGYAP5EUAiP4RAsh0HjyYXDOBYvFB11RhM2zr3BB42hN413yucvpcUOPOFG4XOJoOAAhZLfdK6mmWb7zvBvci9ES5A1kb2+duXVa9La/GiwFa6XE9gIB8cPr9cLo1+7cL+jygk7PcoV8AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;">
      <img class="gatsby-resp-image-image" style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;" alt="React DevTools on a website with development version of React" title="" src="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png" srcset="/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1cd08.png 210w,
/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-9b07a.png 420w,
/static/devtools-dev-e434ce2f7e64f63e597edf03f4465694-1e9b4.png 600w" sizes="(max-width: 600px) 100vw, 600px">
    </span>
  </span>
  
  </a>
    
<p>‰ªçÁÑ∂Êúâ‰∏Ä‰∫õÊõ¥Á≥üÁ≥ïÁöÑÂú∫ÊôØ„ÄÇÊúâÊó∂Ôºå<code class="gatsby-code-text">process.env.NODE_ENV</code> Âú®ËøêË°åÊó∂Ë¢´ËÆæÁΩÆ‰∏∫ <code class="gatsby-code-text">&quot;production&quot;</code> ËÄå‰∏çÊòØÂú®ÊûÑÂª∫Êó∂Èó¥„ÄÇËøôÂú® Node.js ÊòØÊ≠£Â∏∏ÁöÑÔºå‰ΩÜÂØπ‰∫éÂÆ¢Êà∑Á´ØÊûÑÂª∫Êù•ËØ¥ÂàôÂæàÁ≥üÁ≥ïÔºåÂõ†‰∏∫Êó†Áî®ÁöÑÂºÄÂèë‰ª£Á†Å‰πüË¢´ÊâìÂåÖËøõÂéª‰∫ÜÔºåÂç≥‰ΩøÂÖ∂Ê∞∏Ëøú‰∏ç‰ºöÊâßË°å„ÄÇËøôÊõ¥ÈöæË¢´Ê£ÄÊµãÂà∞Ôºå‰ΩÜÊàë‰ª¨ÂèëÁé∞‰∫ÜÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÊïàÊûú‰∏çÈîôÁöÑ‰∏Ä‰∏™ËØïÊé¢ÊÄßÊñπÊ≥ïÂπ∂‰∏îË≤å‰ºº‰∏ç‰ºö‰∫ßÁîüËØØÂ∑Æ„ÄÇ</p>
<p>Êàë‰ª¨ÂèØ‰ª•ÂÜô‰∏Ä‰∏™ÂáΩÊï∞Ôºå‰ªÖÂú®<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/packages/react-dom/npm/index.js#L11-L20">ÂºÄÂèëÂàÜÊîØ</a>‰∏ãÂåÖÂê´‰ªªÊÑèÂ≠óÁ¨¶‰∏≤„ÄÇËÄåÂêéÔºåËã• <code class="gatsby-code-text">process.env.NODE_ENV</code> Ë¢´ËÆæÁΩÆ‰∏∫ <code class="gatsby-code-text">&quot;production&quot;</code>ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®<a href="https://github.com/facebook/react-devtools/blob/b370497ba6e873c63479408f11d784095523a630/backend/installGlobalHook.js#L143">ÈÇ£‰∏™ÂáΩÊï∞ÈáåË∞ÉÁî® <code class="gatsby-code-text">toString()</code></a>Âπ∂ÂéªÈ™åËØÅ‰ªÖ‰ºöÂú®ÂºÄÂèëÊ®°Âºè‰∏ãÊâç‰ºöË¢´ÊäõÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇËã•‰ªçÁÑ∂Âú®ËøôÈáåÔºåÊó†Áî®‰ª£Á†ÅÁöÑÊì¶Èô§Âπ∂‰∏ç‰ºöÁîüÊïàÔºåËÄå‰∏îÊàë‰ª¨‰πüÈúÄË¶ÅË≠¶ÂëäÂºÄÂèëËÄÖ„ÄÇÁî±‰∫éÂºÄÂèëÂèØËÉΩ‰∏ç‰ºöÊ≥®ÊÑèÂà∞ React DevTool Âú®Áîü‰∫ßÈ°µÈù¢ÂèëÂá∫ÁöÑË≠¶Âëä„ÄÇ Êàë‰ª¨‰πüÂú® React DevTool ‰ªé <a href="https://github.com/facebook/react-devtools/blob/b370497ba6e873c63479408f11d784095523a630/backend/installGlobalHook.js#L143"><code class="gatsby-code-text">setTimeout</code> ÊâîÂá∫‰∏Ä‰∏™ÈîôËØØ</a>Âπ∂Â∏åÊúõËÉΩÂ§üË¢´ÈîôËØØÂàÜÊûêÂ∑•ÂÖ∑ÊçïËé∑„ÄÇ</p>
<p>Êàë‰ª¨ÊÑèËØÜÂà∞ËøôÊñπÊ≥ïÊúâ‰∫õËÑÜÂº±„ÄÇ<code class="gatsby-code-text">toString()</code> ÊñπÊ≥ïÂπ∂‰∏çÂèØÈù†Âπ∂‰∏îÂèØËÉΩÂú®Êú™Êù•Êúâ‰∫õÊµèËßàÂô®‰∏ä‰ºöÊîπÂèòÂÆÉÁöÑË°å‰∏∫„ÄÇËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨Â∞ÜËøô‰∫õÈÄªËæëÊîæÂà∞ React DevTool ÈáåËÄå‰∏çÊòØ React Èáå„ÄÇÂ¶ÇÊûúÂú®‰πãÂêéÂá∫Áé∞‰∫ÜÈóÆÈ¢òÔºåËøôÂÖÅËÆ∏Êàë‰ª¨ËÉΩÁßªÈô§ÂÆÉ„ÄÇÊàë‰ª¨‰πü‰ºöÂèëÂá∫Ë≠¶Âëä‰ªÖÂΩìÊàë‰ª¨<em>ÂèëÁé∞</em>ÁâπÂà´ÁöÑÂ≠óÁ¨¶‰∏≤ËÄå‰∏çÊòØÊàë‰ª¨<em>Ê≤°</em>ÂèëÁé∞ÂÆÉ„ÄÇËøô‰∏ÄÊñπÂºèÔºåÂ¶ÇÊûú <code class="gatsby-code-text">toString()</code> ÁöÑËæìÂá∫ÂèòÂæó‰∏çÂèØÊµãÔºåÊàñË¢´ÈáçÂÜôÔºåËøô‰∏ÄË≠¶Âëä‰πü‰∏ç‰ºöËß¶Âèë„ÄÇ</p>
<h2 id="Â∞ΩÊó©ÊçïËé∑ÈîôËØØ"><a href="#%E5%B0%BD%E6%97%A9%E6%8D%95%E8%8E%B7%E9%94%99%E8%AF%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Â∞ΩÊó©ÊçïËé∑ÈîôËØØ</h2>
<p>Êàë‰ª¨ÊÉ≥Ë¶ÅÂ∞ΩÊó©Âú∞ÊçïËé∑ÈîôËØØ„ÄÇÁÑ∂ËÄåÔºåÂç≥‰ΩøÊâ©Â±ïÊàë‰ª¨ÁöÑÊµãËØïË¶ÜÁõñÁéáÔºåÊàë‰ª¨ÂÅ∂Â∞îËøòÊòØ‰ºöÁäØÈîôËØØ„ÄÇ‰ªäÂπ¥Êàë‰ª¨Âú®Êàë‰ª¨ÁöÑÊûÑÂª∫ÂíåÊµãËØïÁéØËäÇÂÅö‰∫Ü‰∫õË∞ÉÊï¥‰ª•‰ΩøÂÖ∂Êõ¥ÈöæÂá∫Èîô„ÄÇ</p>
<h3 id="ËøÅÁßªËá≥-es-Ê®°Âùó"><a href="#%E8%BF%81%E7%A7%BB%E8%87%B3-es-%E6%A8%A1%E5%9D%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËøÅÁßªËá≥ ES Ê®°Âùó</h3>
<p>ÈÄöËøá CommonsJS ÁöÑ <code class="gatsby-code-text">require()</code> Âíå <code class="gatsby-code-text">module.exports</code>ÔºåÂÖ∂ÂæàÂÆπÊòìÂºïÂÖ•‰∏Ä‰∏™ÂÆûÈôÖ‰∏äÂπ∂‰∏çÂ≠òÂú®ÁöÑÂáΩÊï∞Ôºå‰∏îÁõ¥Âà∞‰Ω†Ë∞ÉÁî®Êâç‰ºöÊÑèËØÜÂà∞„ÄÇÁÑ∂ËÄåÔºåËã•‰Ω†ËæìÂÖ•Èîô‰∫Ü‰∏Ä‰∏™ÂºïÂÖ•ÁöÑÊñπÊ≥ïÂêçÁß∞ÔºåÁ±ª‰ºº Rollup ËøôÊ†∑ÂéüÁîüÊîØÊåÅ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import"><code class="gatsby-code-text">import</code></a> Âíå <a href="https://developer.mozilla.org/en-US/docs/web/javascript/reference/statements/export"><code class="gatsby-code-text">export</code></a> ËØ≠Ê≥ïÁöÑÂ∑•ÂÖ∑Â∞Ü‰ºöÊûÑÂª∫Â§±Ë¥•„ÄÇÂú® React 16 ÂèëÂ∏ÉÂêéÔºåÊàë‰ª¨Â∞ÜÊï¥‰∏™ React ÁöÑÊ∫êÁ†ÅË∞ÉÊï¥Êàê‰∏∫‰∫Ü ES Ê®°ÂùóËØ≠Ê≥ï„ÄÇ</p>
<p>‰∏ç‰ªÖÊèê‰æõ‰∫ÜÈ¢ùÂ§ñÁöÑ‰øùÊä§Ôºå‰πüÁº©Â∞è‰∫ÜÊûÑÂª∫ÂåÖÁöÑ‰ΩìÁßØ„ÄÇËÆ∏Â§ö React Ê®°Âùó‰ªÖÊö¥Èú≤Â∑•ÂÖ∑ÂáΩÊï∞Ôºå‰ΩÜ CommonJS Âº∫Âà∂Ë¶ÅÊ±ÇÊàë‰ª¨Â∞ÜÂÆÉ‰ª¨ÂåÖË£ÖÂà∞ÂØπË±°Èáå„ÄÇÈÄöËøáÂ∞ÜËøô‰∫õÂ∑•ÂÖ∑ÂáΩÊï∞ËΩ¨Êç¢ÊàêÂëΩÂêçÁöÑÊö¥Èú≤Âπ∂Ê∂àÈô§ÂåÖË£ÖÂÆÉ‰ª¨ÁöÑÂØπË±°ÔºåÊàë‰ª¨ËÆ© Rollup Â∞ÜÂÖ∂ÊîæÁΩÆÂú®È°∂Â±Ç‰ΩúÁî®‰∫éÔºåËøôÊ†∑ËÉΩÂ§üËÆ©ÂéãÁº©Âô®Âú®Áîü‰∫ßÁâàÊú¨ÂéãÁº©ÂÆÉ‰ª¨ÁöÑÂêçÁß∞„ÄÇ</p>
<p>ÁõÆÂâçÔºå‰ªÖÂÜ≥ÂÆöÂ∞ÜÊ∫ê‰ª£Á†ÅËΩ¨Êç¢Êàê ES Ê®°ÂùóÔºå‰ΩÜ‰∏çÂåÖÊã¨ÊµãËØï‰ª£Á†Å„ÄÇÊàë‰ª¨‰ΩøÁî®Á±ª‰ºº <code class="gatsby-code-text">jest.resetModules()</code> ËøôÊ†∑Âº∫ÊúâÂäõÁöÑÂ∑•ÂÖ∑Âπ∂ÊÉ≥Ë¶ÅÂú®ÊµãËØï‰∏≠ÂΩìÊ®°ÂùóÂàùÂßãÂåñÊó∂ËÉΩÊúâÊõ¥Á¥ßÂØÜÁöÑÊéßÂà∂Âäõ„ÄÇ‰∏∫‰∫ÜÂú®ÊµãËØï‰∏≠‰ΩøÁî® ES Ê®°ÂùóÔºåÊàë‰ª¨ÊîØÊåÅ‰∫Ü <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/jest/preprocessor.js#L28-L29">Babel CommonJS transform</a> Êèí‰ª∂Ôºå‰ΩÜ‰ªÖÈíàÂØπÊµãËØïÁéØÂ¢É„ÄÇ</p>
<h3 id="Âú®Áîü‰∫ßÊ®°Âºè‰∏ãËøêË°åÊµãËØï"><a href="#%E5%9C%A8%E7%94%9F%E4%BA%A7%E6%A8%A1%E5%BC%8F%E4%B8%8B%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Âú®Áîü‰∫ßÊ®°Âºè‰∏ãËøêË°åÊµãËØï</h3>
<p>ËøáÂéªÔºåÊàë‰ª¨Âú®ÂºÄÂèëÁéØÂ¢É‰∏ãËøêË°åÊâÄÊúâÊµãËØï„ÄÇËøôËÆ©Êàë‰ª¨ÂØπ React ÊâÄ‰∫ßÁîüÁöÑË≠¶Âëä‰ø°ÊÅØËøõË°åÊµãËØïÔºåÂπ∂‰∏îË≤å‰ººÊúâ‰∏ÄÁßçÊôÆÈÄöÁöÑÊÑè‰πâ„ÄÇÁÑ∂ËÄåÔºåÂç≥‰ΩøÊàë‰ª¨Â∞ùËØïÂú®ÂºÄÂèëÁéØÂ¢ÉÂíåÁîü‰∫ßÁéØÂ¢É‰∏ä‰øùÊåÅ‰ª£Á†ÅË∑ØÂæÑÊúÄÂ∞èÂåñÁöÑÂ∑ÆÂºÇÔºå‰ΩÜÊàë‰ª¨‰ªçÁÑ∂‰ºöÊÑèÂ§ñÂú∞Âú®‰ªÖÈíàÂØπÁîü‰∫ßÁéØÂ¢ÉÁöÑ‰ª£Á†Å‰∏äÂá∫Áé∞Êú™Ë¢´ÊµãËØïË¶ÜÁõñÁöÑÈîôËØØÔºåÂπ∂‰∏î‰ºö‰∫ßÁîü‰∏Ä‰∏™ issues Âú® Facebook ÁöÑ React ‰ªìÂ∫ì‰∏ä„ÄÇx</p>
<p>‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºåÊàë‰ª¨Âú®CIÔºàÊåÅÁª≠ÈõÜÊàêÔºâ‰∏äÂ¢ûÂáè‰∫ÜËøêË°åÊâÄÊúâ pull request ÁöÑ <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/package.json#L110"><code class="gatsby-code-text">yarn test-prod</code></a> ÁöÑÊñ∞ÂëΩ‰ª§Ôºå<a href="https://github.com/facebook/react/pull/11616">Âú®Áîü‰∫ßÁéØÂ¢É‰∏ãÊâßË°åÊâÄÊúâÁöÑÊµãËØïÁî®‰æã</a>„ÄÇÊàë‰ª¨Â∞ÜÊâÄÊúâÊµãËØïÈáå‰ªª‰ΩïÊúâÂÖ≥Ë≠¶Âëä‰ø°ÊÅØÁöÑÊµãËØïÊñ≠Ë®ÄÈÉΩÂåÖË£πÂú®ÂºÄÂèëÊ®°ÂºèÁöÑÊù°‰ª∂ÂàÜÊîØ‰∏ãÔºåÂõ†Ê≠§Âú®‰∏§ÁßçÁéØÂ¢É‰∏ãÔºå‰ªñ‰ª¨‰ªçÁÑ∂ÂèØ‰ª•Ê£ÄÊµãÂÖ∂È¢ÑÊúüË°å‰∏∫„ÄÇÁî±‰∫éÊàë‰ª¨Ëá™ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ ÈÄöËøá<a href="/blog/2016/07/11/introducing-reacts-error-code-system.html">ÈîôËØØ‰ª£Á†Å</a>Êù•ÊõøÊç¢Áîü‰∫ßÁéØÂ¢ÉÁöÑÈîôËØØ‰ø°ÊÅØÁöÑ Babel ËΩ¨Êç¢Êèí‰ª∂ÔºåÊàë‰ª¨‰πüÂä†ÂÖ•‰∫Ü‰∏Ä‰∏™<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/jest/setupTests.js#L91-L126">ÈÄÜÂêëËΩ¨Êç¢</a>‰Ωú‰∏∫Áîü‰∫ßÁéØÂ¢ÉÊµãËØïËøêË°åÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ</p>
<h3 id="Âú®ÊµãËØïÁéØÂ¢É‰∏ã‰ΩøÁî®ÂÖ¨ÂÖ±-api"><a href="#%E5%9C%A8%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8%E5%85%AC%E5%85%B1-api" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Âú®ÊµãËØïÁéØÂ¢É‰∏ã‰ΩøÁî®ÂÖ¨ÂÖ± API</h3>
<p>ÂΩìÊàë‰ª¨<a href="https://code.facebook.com/posts/1716776591680069/react-16-a-look-inside-an-api-compatible-rewrite-of-our-frontend-ui-library/">ÈáçÂÜô React reconciler</a>ÔºåÊàë‰ª¨ÊÑèËØÜÂà∞‰∫ÜÂØπÂÖ¨ÂÖ± API ËÄå‰∏çÊòØÈíàÂØπÂØπÂÜÖÈÉ®Ê®°ÂùóÁºñÂÜôÊµãËØïÁöÑÈáçË¶ÅÊÄß„ÄÇËã•ÈíàÂØπÂÖ¨ÂÖ± API ÁºñÂÜôÊµãËØïÔºåÂÖ∂‰ªéÁî®Êà∑ËßÜËßíÊù•Áúã‰ªÄ‰πàÈúÄË¶ÅË¢´ÊµãËØïÊòØÈùûÂ∏∏Ê∏ÖÊô∞ÁöÑÔºåÂç≥‰Ωø‰Ω†ÂÆåÂÖ®‰ªéÈõ∂ÂºÄÂßãÈáçÊñ∞ÂÆûÁé∞Ôºå‰Ω†‰πüÂèØ‰ª•ËøêË°åÂÆÉ„ÄÇ</p>
<p>Êàë‰ª¨Âà∞ÈùûÂ∏∏Ê£íÁöÑ React Á§æÂå∫<a href="https://github.com/facebook/react/issues/11299">ÂØªÊ±ÇÂ∏ÆÂä©</a>Â∞ÜÂâ©‰ΩôÁöÑÊµãËØïË∞ÉÊï¥‰∏∫ÊµãËØïÂÖ¨ÂÖ± API„ÄÇÁõÆÂâçÂ§ßÈÉ®ÂàÜÁöÑÊµãËØïÈÉΩÂ∑≤ÁªèË¢´Ë∞ÉÊï¥‰∫Ü„ÄÇËøô‰∏ÄËøáÁ®ãÂπ∂‰∏çÂÆπÊòì„ÄÇÊúâÊó∂‰∏Ä‰∏™ÂçïÂÖÉÊµãËØï‰ªÖË∞ÉÁî®‰∏Ä‰∏™ÂÜÖÈÉ®ÊñπÊ≥ïÔºåÂπ∂‰∏î‰ªéÁî®Êà∑Âú∞ËßíÂ∫¶Êù•ÁúãÂæàÈöæÊòéÁ°ÆÊåáÂá∫ÂÖ∂ÊúüÊúõÊµãËØïÁöÑË°å‰∏∫„ÄÇÊàë‰ª¨ÊâæÂØªÂá∫‰∫Ü‰∏Ä‰∫õÁ≠ñÁï•Êù•Ëß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢ò„ÄÇÁ¨¨‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØÂ∞ùËØï‰ªé git ÁöÑÂéÜÂè≤ËÆ∞ÂΩï‰∏≠ÊâæÂá∫ËØ•ÊµãËØïË¢´Ê∑ªÂä†ÁöÑÊó∂Èó¥ÁÇπÔºåÂπ∂‰ªé issue Âíå Êèê‰∫§Ôºàpull requestÔºâÁöÑÊèèËø∞‰∏≠ÂèëÁé∞‰∏Ä‰∫õÁ∫øÁ¥¢„ÄÇÈÄöÂ∏∏ÊØîÂéüÊúâÁöÑÊµãËØïÊñá‰ª∂Êõ¥Êúâ‰ª∑ÂÄºÔºÅ‰∏Ä‰∏™ÂæàÂ•ΩÈ™åËØÅÁåúÊµãÁöÑÊñπÂºèÊòØÊ≥®ÈáäÊéâË¢´ÊµãËØïÁöÑ‰ª£Á†Å‰∏≠Êüê‰∏ÄË°å„ÄÇËã•ÊµãËØïÂ§±Ë¥•ÔºåÊàë‰ª¨‰æøÂèØ‰ª•Á°ÆÂÆöÂÖ∂Âú®ÁâπÂÆö‰ª£Á†ÅË∑ØÂæÑÁöÑÈáçË¶ÅÊÄß„ÄÇ</p>
<p>Êàë‰ª¨ÊÉ≥Ë¶ÅÁªô<a href="https://github.com/facebook/react/issues?q=is%3Apr+11299+is%3Aclosed">ÊØè‰∏Ä‰ΩçË¥°ÁåÆËøáÁöÑ‰ºô‰º¥</a>ÁåÆ‰∏äÊàë‰ª¨Ê∑±Ê∑±Âú∞ÊÑüË∞¢„ÄÇ</p>
<h3 id="ÂØπÁºñËØëÂêéÁöÑÂåÖËøêË°åÊµãËØï"><a href="#%E5%AF%B9%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E5%8C%85%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂØπÁºñËØëÂêéÁöÑÂåÖËøêË°åÊµãËØï</h3>
<p>Ëøô‰πüÊòØÂØπÂÖ¨ÂÖ± API ÁºñÂÜôÊµãËØïÁöÑÈ¢ùÂ§ñÊî∂ÁõäÔºöÁé∞Âú®Êàë‰ª¨ÂèØ‰ª•<a href="https://github.com/facebook/react/pull/11633">ÂØπÁºñËØëÂêéÁöÑÂåÖËøêË°åÊµãËØï</a>„ÄÇ</p>
<p>ËøôÂ∏ÆÂä©Êàë‰ª¨Á°Æ‰øùÁ±ª‰ºº Babel„ÄÅRollup Âíå Google Closure Compiler ‰∏ç‰ºöÂºï‰∫∫‰ªª‰ΩïÁöÑ bug„ÄÇËøô‰πü‰∏∫‰πãÂêéÊõ¥‰∏∫ÊøÄËøõÁöÑ‰ºòÂåñÊñπÂºèÊâìÂºÄ‰∫Ü‰∏ÄÊâáÈó®ÔºåÂè™Ë¶ÅÊàë‰ª¨ËÉΩÂ§üÁ°Æ‰øù React Ë¢´‰ºòÂåñ‰πãÂêéËÉΩÂíå‰πãÂâçÈ¢ÑÊúüÁöÑË°å‰∏∫‰øùÊåÅ‰∏ÄËá¥„ÄÇ</p>
<p>‰∏∫‰∫ÜÂÆûÁé∞Ëøô‰∏ÄÊïàÊûúÔºåÊàë‰ª¨ÂàõÂª∫‰∫Ü<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/jest/config.build.js">Á¨¨‰∫å‰∏™ Jest ÈÖçÁΩÆ</a>„ÄÇÂÆÉÈáçÂÜôÊàë‰ª¨ÈªòËÆ§ÁöÑÈÖçÁΩÆÔºåÊääÂÖ•Âè£ÊåáÂêë‰∫Ü <code class="gatsby-code-text">react</code>„ÄÅ<code class="gatsby-code-text">react-dom</code>ÔºåÂπ∂Â∞ÜÂÖ∂‰ªñÂÖ•Âè£ÊåáÂêë <code class="gatsby-code-text">/build/packages/</code> Êñá‰ª∂Â§π„ÄÇËØ•Êñá‰ª∂Â§πÂπ∂‰∏çÂåÖÂê´‰ªª‰Ωï React ÁöÑÊ∫êÁ†ÅÔºåÂπ∂ÂèçÂ∫î‰∫ÜÂèëÂ∏ÉÂà∞ npm ‰∏äÁöÑÂÜÖÂÆπ„ÄÇÂÖ∂Âú®‰Ω†ËøêË°å <code class="gatsby-code-text">yarn build</code> ‰πãÂêéÁîüÊàê„ÄÇ</p>
<p>Ëøô‰ΩøÂæóÊàë‰ª¨ËÉΩÂ§üÂÉèÊàë‰ª¨ÈÄöÂ∏∏Âú®Ê∫ê‰ª£Á†ÅËøêË°åÁöÑÊµãËØï‰∏ÄÊ†∑ËøõË°åÁ≤æÂáÜÁöÑÊµãËØïÔºå‰ΩÜ‰ΩøÁî®ÂºÄÂèëÁéØÂ¢ÉÂíåÈÄöËøá Rollup Âíå Google Closure Compiler ÊûÑÂª∫ÁöÑÁîü‰∫ßÁéØÂ¢ÉÁöÑÈ¢ÑÂèëÂ∏ÉÁöÑ React ÂåÖÊù•ÊâßË°å„ÄÇ</p>
<p>‰∏çÂêå‰∫éÊôÆÈÄöÁöÑÊµãËØïÔºåÂåÖÊµãËØï‰æùËµñ‰∫éÊûÑÂª∫‰∫ßÂìÅÔºåÂõ†Ê≠§ÂÖ∂Êó†Ê≥ïÂæàÂ•ΩÁöÑÂø´ÈÄüËø≠‰ª£„ÄÇÁÑ∂ËÄåÔºåÂÖ∂‰ªçÁÑ∂ËÉΩÂ§üÈÄöËøáÂú® CI ÊúçÂä°‰∏äËøêË°åÔºåÂõ†Ê≠§Ëã•Âá∫Áé∞Â¥©Ê∫ÉÔºåÊµãËØïÂ∞Ü‰ºöÊòæÁ§∫ÊµãËØïÂ§±Ë¥•ÔºåÊàë‰ª¨‰πüÂ∞Ü‰ºöÁü•ÈÅìÊó†Ê≥ïÂÆâÂÖ®Âú∞Â∞ÜÂÖ∂ÂêàÂπ∂Âà∞ master ÂàÜÊîØ‰∏ä„ÄÇ</p>
<p>‰ªçÊúâ‰∏Ä‰∫õÊµãËØïÊñá‰ª∂Êàë‰ª¨ÊïÖÊÑèÊ≤°ÊúâÂú®ÁºñËØëÂåÖ‰∏äËøêË°å„ÄÇÊúâÊó∂Êàë‰ª¨ÊÉ≥Ë¶ÅÊ®°ÊãüÔºàmockÔºâ‰∏Ä‰∏™ÂÜÖÈÉ®Ê®°ÂùóÊàñÈáçÂÜô‰∏Ä‰∏™ÁõÆÂâç‰∏çÂ∏åÊúõÂÖ¨ÂºÄÁöÑÁâπÊÄßÊ†áËÆ∞„ÄÇÂØπ‰∫éËøô‰∫õÊÉÖÂÜµÔºåÊàë‰ª¨ÈÄöËøáÂ∞ÜÊñá‰ª∂Âêç‰ªé <code class="gatsby-code-text">MyModule-test.js</code> ÈáçÂëΩÂêç‰∏∫ <code class="gatsby-code-text">MyModule-test.internal.js</code> Êù•Â∞ÜÂÖ∂ÂàóÂÖ•ÊµãËØïÊñá‰ª∂ÁöÑÈªëÂêçÂçï„ÄÇ</p>
<p>ÁõÆÂâçÔºåÂú® 2,650 ‰∏™ React ÊµãËØï‰∏≠ÊúâË∂ÖËøá 93% ÁöÑÊµãËØïÊòØÈíàÂØπÁºñËØëÂêéÁöÑÂåÖ„ÄÇ</p>
<h3 id="Ê†ºÂºèÂåñÁºñËØëÂêéÁöÑÂåÖ"><a href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E5%8C%85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ê†ºÂºèÂåñÁºñËØëÂêéÁöÑÂåÖ</h3>
<p>Èô§‰∫ÜÊ†ºÂºèÂåñÊàë‰ª¨ÁöÑÊ∫ê‰ª£Á†ÅÔºåÊàë‰ª¨Âú®ÁºñËØëÂêéÁöÑÂåÖ‰∏äËøêË°å‰∫ÜÊõ¥Â§ö‰∏ÄÁ≥ªÂàóÁöÑÊ†ºÂºèÂåñËßÑÂàôÊ£ÄÊü•ÔºàÂÆûÈôÖ‰∏äÔºå<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/validate/eslintrc.cjs.js#L26-L27">‰ªÖÊúâ‰∏§‰∏™</a>Ôºâ„ÄÇËøôÂú®Â∫ïÂ±ÇÂ∑•ÂÖ∑‰∏äÁªô‰∫ÜÊàë‰ª¨È¢ùÂ§ñÁöÑ‰øùÊä§Èò≤Ê≠¢ÂºïÂÖ•ÂºÇÂ∏∏Âπ∂<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/validate/eslintrc.cjs.js#L22">Á°Æ‰øù</a>ÂåÖÊ≤°Êúâ‰ΩøÁî®Êõ¥ËÄÅÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÁöÑ‰ªª‰ΩïËØ≠Ë®ÄÁâπÊÄß„ÄÇ</p>
<h3 id="Ê®°ÊãüÂåÖÂèëÂ∏É"><a href="#%E6%A8%A1%E6%8B%9F%E5%8C%85%E5%8F%91%E5%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ê®°ÊãüÂåÖÂèëÂ∏É</h3>
<p>ÁîöËá≥Âú®ÊûÑÂª∫ÂêéÁöÑÂåÖ‰∏äËøêË°åÊµãËØï‰πüÊó†Ê≥ïÈÅøÂÖçÂºïÂÖ•Á†¥ÂùèÁöÑÊõ¥Êñ∞„ÄÇ‰æãÂ¶ÇÔºåÊàë‰ª¨Âú®Êàë‰ª¨ÁöÑ <code class="gatsby-code-text">package.json</code> Êñá‰ª∂‰∏≠‰ΩøÁî® <code class="gatsby-code-text">files</code> Â≠óÊÆµÊù•ÊåáÂêëÂ∫îËØ•Ë¢´ÂèëÂ∏ÉÂà∞ npm ‰∏äÁöÑÂÖ≥‰∫éÂÖ∑‰ΩìÁöÑÊñá‰ª∂Â§πÂíåÊñá‰ª∂ÁöÑÁôΩÂêçÂçï„ÄÇÁÑ∂ËÄåÔºåÂÖ∂ÂæàÂÆπÊòìÂ¢ûÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂÖ•Âè£ÊåáÂêë‰∏Ä‰∏™ÂåÖ‰ΩÜÊòØÂøòËÆ∞Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞ÁôΩÂêçÂçïÂÜÖ„ÄÇÁîöËá≥ÂåÖÁöÑÊµãËØïÂ∑≤ÁªèÈÄöËøáÔºå‰ΩÜÂú®ÂèëÂ∏É‰πãÂêéÂÖ∂ÂÖ•Âè£Âàô‰ºö‰∏¢Â§±„ÄÇ</p>
<p>‰∏∫‰∫ÜÈÅøÂÖçÁ±ª‰ººÁöÑÊÉÖÂÜµÔºåÁé∞Âú®ÔºåÂú®ÊûÑÂª∫‰πãÂêéÊàë‰ª¨<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/packaging.js#L129-L134">ÈÄöËøáËøêË°å <code class="gatsby-code-text">npm pack</code> Âíå Âø´ÈÄüËß£Âéã</a>Êù•Ê®°Êãü npm ÂèëÂ∏É„ÄÇÁ±ª‰ºº <code class="gatsby-code-text">npm publish</code>ÔºåËøô‰∏ÄÂëΩ‰ª§ËøáÊª§‰∫Ü‰ªª‰Ωï‰∏çÂú® <code class="gatsby-code-text">files</code> ÁôΩÂêçÂçïÂÜÖÁöÑ‰ªª‰Ωï‰∏úË•ø„ÄÇÈÄöËøáËøô‰∏ÄÊñπÂºèÔºåËã•Êàë‰ª¨ÂøòËÆ∞Ê∑ªÂä†‰∏Ä‰∏™ÂÖ•Âè£Âà∞ÂàóË°®‰∏≠ÔºåÂÖ∂Â∞Ü‰ºöÂú®ÊûÑÂª∫Êñá‰ª∂Â§π‰∏≠Áº∫Â§±ÔºåËÄå‰æùËµñ‰∫éÂÆÉÁöÑÂåÖÊµãËØïÂ∞Ü‰ºöÂ§±Ë¥•„ÄÇ</p>
<h3 id="ÂàõÂª∫ÊâãÂä®ÊµãËØïÊñá‰ª∂"><a href="#%E5%88%9B%E5%BB%BA%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂàõÂª∫ÊâãÂä®ÊµãËØïÊñá‰ª∂</h3>
<p>Êàë‰ª¨ÁöÑÂçïÂÖÉÊµãËØï‰ªÖÂú® Node ÁéØÂ¢É‰∏ãËøêË°åÔºå‰ΩÜ‰∏çÂú®ÊµèËßàÂô®ÁéØÂ¢É‰∏ã„ÄÇËøôÊòØÊúâÊÑèËÄå‰∏∫‰πãÔºåÂõ†‰∏∫Âú®Êàë‰ª¨ÁöÑÁªèÈ™å‰∏≠Âü∫‰∫éÊµèËßàÂô®ÁöÑÊµãËØïÂ∑•ÂÖ∑ÈùûÂ∏∏Â•áÊÄ™ÔºåÂπ∂‰∏îÊó†Ê≥ïÊçïËé∑ËÆ∏Â§öÈóÆÈ¢ò„ÄÇ</p>
<p>Êàë‰ª¨ÂèØ‰ª•ÊëÜËÑ±Ëøô‰∏ÄÈóÆÈ¢òÔºåÂõ†‰∏∫ËÆøÈóÆ DOM ÁöÑ‰ª£Á†ÅÊòØÂõ∫ÂÆöÁöÑÂú®Â∞ëÊï∞Âá†‰∏™Êñá‰ª∂‰∏≠ÔºåÂπ∂‰∏îÈÄöÂ∏∏‰∏ç‰ºöÊîπÂèò„ÄÇÊØèÂë®ÔºåÊàë‰ª¨Â∞Ü Facebook.com ÁöÑ master ÂàÜÊîØ‰ª£Á†ÅÊõ¥Êñ∞Âà∞ React ÁöÑÊúÄÊñ∞Êèê‰∫§„ÄÇÂú® FacebookÔºåÂØπ‰∫éÈáçË¶ÅÁöÑ‰∫ßÂìÅÊµÅÁ®ãÔºåÊàë‰ª¨‰ΩøÁî®‰∫Ü‰∏ÄÁ≥ªÂàóÂÜÖÈÉ®ÁöÑ <a href="http://www.seleniumhq.org/projects/webdriver/">WebDriver</a> ÊµãËØïÔºåÂπ∂ËÉΩÂ§üÊçïËé∑‰∏Ä‰∫õÂºÇÂ∏∏„ÄÇReact Êõ¥Êñ∞È¶ñÂÖà‰ºöË¢´ÂëòÂ∑•‰ΩøÁî®ÔºåÂõ†Ê≠§Á¥ßÊÄ•ÁöÑ bug ‰ºöÂú®ÂÆÉ‰ª¨Âà∞Ëææ 200 ‰∏áÁöÑÁî®Êà∑ÂâçË¢´Êä•Âëä„ÄÇ</p>
<p>ÂÖ∂‰ªçÁÑ∂ÂæàÈöæËØÑÂÆ° DOM Áõ∏ÂÖ≥ÁöÑÂèòÊõ¥ÔºåËÄå‰∏îÊàë‰ª¨ÂÅ∂Â∞î‰πü‰ºöÁäØÈîôËØØ„ÄÇÂ∞§ÂÖ∂ÊòØÔºåÂæàÈöæËÆ∞‰ΩèÊâÄÊúâ‰ª£Á†ÅÂøÖÈ°ªË¶ÅÂ§ÑÁêÜÁöÑËæπÁïåÊù°‰ª∂Ôºå‰∏∫‰ªÄ‰πàË¶ÅË¢´Ê∑ªÂä†Ôºå‰ª•Âèä‰ΩïÊó∂ËÉΩÂ∞ÜÂÆÉ‰ª¨ÂÆâÂÖ®Âú∞ÁßªÈô§„ÄÇÊàë‰ª¨ËÄÉËôëÂ¢ûÂä†‰∫õÂú®ÊµèËßàÂô®‰∏äËøêË°åÁöÑËá™Âä®ÂåñÊµãËØïÔºå‰ΩÜÊàë‰ª¨‰∏çÊÉ≥ÊãñÊÖ¢Êï¥‰∏™ÂºÄÂèëÂë®ÊúüÂπ∂Â§ÑÁêÜ‰∏Ä‰∏™ËÑÜÂº±ÁöÑ CI ÁéØÂ¢É„ÄÇËá™Âä®ÂåñÊµãËØïÂπ∂‰∏çÊòØÊ∞∏ËøúÈÉΩËÉΩÊçïËé∑ DOM ÂºÇÂ∏∏„ÄÇ‰æãÂ¶ÇÔºå‰∏Ä‰∏™ÊòæÁ§∫Âú®ÊµèËßàÂô®‰∏äÁöÑËæìÂÖ•ÂÄºÂèØËÉΩÂíåÂÆÉÊâÄÊä•ÂëäÁöÑ DOM Â±ûÊÄß‰∏çÂåπÈÖç„ÄÇ</p>
<p>Êàë‰ª¨Â∞±Ëøô‰∏™ÈóÆÈ¢òÂíå <a href="https://github.com/aweary">Brandon Dail</a>„ÄÅ <a href="https://github.com/jquense">Jason Quense</a> ‰ª•Âèä <a href="https://github.com/nhunzaker">Nathan Hunzaker</a> ËøõË°å‰∫Ü‰∫§Ë∞à„ÄÇ‰ªñ‰ª¨‰πãÂâç‰∏∫ ReactDOM Êèê‰∫§‰∫ÜÂ§ßÈáèÁöÑË°•‰∏Å‰ΩÜÂæàÈÅóÊÜæÁöÑÊòØÊàë‰ª¨Ê≤°ÊúâÂèäÊó∂Âú∞ËøõË°åÂÆ°ÈòÖ„ÄÇÊàë‰ª¨ÂÜ≥ÂÆöÁªô‰ªñ‰ª¨Êèê‰∫§ÁöÑÊùÉÈôêÔºå‰ΩÜË¶ÅÊ±Ç‰ªñ‰ª¨ÂØπ‰∫éÁ±ª‰ººËæìÂÖ•ÁÆ°ÁêÜÁöÑ DOM Áõ∏ÂÖ≥ÁöÑÂå∫ÂüüÂàõÂª∫<a href="https://github.com/facebook/react/pull/8589">‰∏ÄÁ≥ªÂàóÁöÑÊâãÂ∑•ÊµãËØï</a>„ÄÇËøô‰∏ÄÊï¥Â•óÊâãÂä®ÁöÑÊµãËØïÊñá‰ª∂Âú®ËøáÂéª‰∏ÄÂπ¥<a href="https://github.com/facebook/react/commits/master/fixtures/dom">‰∏çÊñ≠Â¢ûÈïø</a>„ÄÇ</p>
<p>Ëøô‰∫õÊµãËØïÊñá‰ª∂‰Ωú‰∏∫ React Â∫îÁî®ÁöÑËÆæÊñΩÊîæÂú® <a href="https://github.com/facebook/react/tree/d906de7f602df810c38aa622c83023228b047db6/fixtures/dom"><code class="gatsby-code-text">fixtures/dom</code></a> Èáå„ÄÇÂ¢ûÂä†‰∏Ä‰∏™ÊµãËØïÊñá‰ª∂Ê∂âÂèäÁºñÂÜô‰∏Ä‰∏™‰ª£Á†ÅÊúâÈ¢ÑÊúüË°å‰∏∫ËØ¥ÊòéÁöÑ React ÁªÑ‰ª∂ÂíåÁõ∏ÂÖ≥ÈóÆÈ¢òÂèäÊµèËßàÂô®ÊÄ™ÂºÇË°å‰∏∫ÔºàquirksÔºâÁöÑÈìæÊé•ÔºåÁ±ª‰ºº<a href="https://github.com/facebook/react/pull/11760">Ëøô‰∏™‰æãÂ≠ê</a>Ôºö</p>
<img src="https://user-images.githubusercontent.com/590904/33555298-dd52fb4e-d8cd-11e7-80e9-8369538eb633.png" style="max-width:100%" alt="DOM fixture example">
<p>Ëøô‰∏™ÊµãËØïÊñá‰ª∂Â∫îÁî®ËÉΩÂ§üËÆ©‰Ω†ÈÄâÊã©‰∏Ä‰∏™Êñπ‰æøÂØπÊØîÊîπÂèòÂâçÂêéÁöÑ React ÁâàÊú¨ÔºàÊú¨Âú∞ÊàñÂ∑≤ÂèëÂ∏ÉÂà∞ npm ÁöÑÁâàÊú¨Ôºâ„ÄÇÂΩìÊàë‰ª¨ÊîπÂèò DOM ‰∫§‰∫íÁöÑÁõ∏ÂÖ≥Ë°å‰∏∫Êó∂ÔºåÊàë‰ª¨ËÉΩÂ§üÈÄöËøáÂú®‰∏çÂêåÁöÑÊµèËßàÂô®ËøêË°åÁõ∏ÂÖ≥ÁöÑÊµãËØïÊñá‰ª∂È™åËØÅÂÖ∂ÊòØÂê¶ËøòÂ≠òÂú®ÈóÆÈ¢ò„ÄÇ</p>
<p>Âú®Êüê‰∫õÊÉÖÂÜµÔºå‰∏Ä‰∏™ÊîπÂèòÂ§çÊùÇÂà∞ÈúÄË¶Å‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂπ∂Âü∫‰∫éÊ≠§‰∏ìÈó®ÊûÑÂª∫ÁöÑÊµãËØïÊñá‰ª∂Êù•ËøõË°åÈ™åËØÅ„ÄÇ‰æãÂ¶ÇÔºå<a href="/blog/2017/09/08/dom-attributes-in-react-16.html">Âú® React 16 ‰∏≠Â§ÑÁêÜ DOM Â±ûÊÄß</a>ÂæàÈöæÂú®‰∏ÄÂºÄÂßãÂ∞±ËÉΩËá™‰ø°Âú∞ÂÆûÁé∞„ÄÇÊàë‰ª¨Â∞ùËØïÊåñÊéò‰∏çÂêåÊª¥ËæπÁïåÊù°‰ª∂ÔºåÂπ∂‰∏∫ React 16 ÁöÑÂèäÊó∂ÂèëÂ∏ÉÂá†‰πéÊîæÂºÉ‰∫ÜÂÆÉ„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨ÊûÑÂª∫‰∫Ü‰∏Ä‰ªΩ Áî®‰∫éÂú®‰πãÂâç React ÁâàÊú¨Âíå‰∏ã‰∏ÄÁâàÊú¨ React Ê∏≤ÊüìÊâÄÊúâÊîØÊåÅÁöÑÂ±ûÊÄßÂíåÈîôËØØÊãºÂÜôÁöÑÂ±ûÊÄßÁöÑ<a href="https://github.com/facebook/react/tree/d906de7f602df810c38aa622c83023228b047db6/fixtures/attribute-behavior">‚ÄúÂ±ûÊÄßË°®ÊµãËØïÊñá‰ª∂Ôºàattribute table fixtureÔºâ‚Äù</a> ÔºåÂπ∂ÊòæÁ§∫‰∏§ËÄÖÁöÑ‰∏çÂêå„ÄÇÂÖ∂ËÄóË¥π‰∫Ü‰∏Ä‰∫õÂæ™ÁéØÔºàÂÖ≥ÈîÆÁöÑÁâπÊÄßÊòØÂ∞ÜÁõ∏‰ººÁöÑË°å‰∏∫ÁªÑÂêàÂà∞‰∏ÄËµ∑Ôºâ‰ΩÜÂÖ∂ÊúÄÁªàËÉΩÂ§üËÆ©Êàë‰ª¨Âú®Âá†Â§©Êó∂Èó¥ÂÜÖ‰øÆÂ§çÊâÄÊúâ‰∏ªË¶ÅÁöÑÈóÆÈ¢ò„ÄÇ</p>
<br>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">We went through the table to vet the new behavior for every case (and discovered some old bugs too) <a href="https://t.co/cmF2qnK9Q9">pic.twitter.com/cmF2qnK9Q9</a></p>&mdash; Dan Abramov (@dan_abramov) <a href="https://twitter.com/dan_abramov/status/906244378066345984?ref_src=twsrc%5Etfw">September 8, 2017</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>ËøêË°åÊµãËØïÊñá‰ª∂‰ªçÁÑ∂ÊúâÂ§ßÈáèÁöÑÂ∑•‰ΩúÔºåÊàë‰ª¨ËÄÉËôëÂ∞ÜÂÖ∂‰∏≠‰∏ÄÈÉ®ÂàÜËá™Âä®Âåñ„ÄÇÊµãËØïÂ∫îÁî®‰ªçÁÑ∂ÊòØÈùûÂ∏∏ÂÆùË¥µÁöÑÔºåÁîöËá≥ÊòØÂØπ React ÁõÆÂâçÂ≠òÂú®ÁöÑË°å‰∏∫ÂíåÊâÄÊúâÁöÑËæπÁïåÊù°‰ª∂‰ª•ÂèäÊµèËßàÂô® bug ÁöÑ‰∏Ä‰∏™ÊñáÊ°£„ÄÇ‰ΩøÊàë‰ª¨Êúâ‰ø°ÂøÉÂú®‰∏çÁ†¥ÂùèÈáçË¶ÅÁöÑÁî®‰æãÁöÑÊù°‰ª∂‰∏ãÂØπÈÄªËæëËøõË°åÈáçÂ§ßÁöÑË∞ÉÊï¥„ÄÇÊàë‰ª¨ËÄÉËôëÁöÑÂè¶Â§ñ‰∏Ä‰∏™Ë∞ÉÊï¥ÊòØÂ¢ûÂä†‰∏Ä‰∏™ Github Êú∫Âô®‰∫∫ÊûÑÂª∫ Âπ∂ÂØπÊØè‰∏ÄÊ¨°Ê∂âÂèäÁõ∏ÂÖ≥Êñá‰ª∂ÁöÑÊèê‰∫§Ëá™Âä®Âú∞ÈÉ®ÁΩ≤ÊµãËØïÊñá‰ª∂ÔºåÂõ†Ê≠§ÊØè‰∏™‰∫∫ÈÉΩÂèØ‰ª•ËøõË°åÊµèËßàÂô®ÊµãËØï„ÄÇ</p>
<h3 id="È¢ÑÈò≤Ê≠ªÂæ™ÁéØ"><a href="#%E9%A2%84%E9%98%B2%E6%AD%BB%E5%BE%AA%E7%8E%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>È¢ÑÈò≤Ê≠ªÂæ™ÁéØ</h3>
<p>React 16 ‰ª£Á†ÅÂåÖÂê´‰∫ÜÂ§ßÈáèÁöÑ <code class="gatsby-code-text">while</code> Âæ™ÁéØ„ÄÇÂÆÉ‰ª¨ËÆ©Êàë‰ª¨ÈÅøÂÖçÂèëÁîüÂú®Êó©Êúü React ÁâàÊú¨ÁöÑÂèØÊÄïÁöÑËøáÊ∑±ÁöÑË∞ÉÁî®Ê†àË∑ØÂæÑÔºå‰ΩÜ‰ΩøÂæó React ÂºÄÂèëÂèòÂæóÈùûÂ∏∏Èöæ„ÄÇÊØèÊ¨°ÈÄÄÂá∫Êù°‰ª∂Âá∫Áé∞ÈîôËØØÊó∂Êàë‰ª¨ÁöÑÊµãËØïÂ∞Ü‰ºöË¢´ÊåÇËµ∑ÔºåÂπ∂Ëä±Ë¥π‰∏Ä‰∫õÊó∂Èó¥Êù•ÊâæÂá∫Âì™‰∏™Âæ™ÁéØÂºïÂèë‰∫ÜËøô‰∏ÄÈóÆÈ¢ò„ÄÇ</p>
<p>ÂèóÂà∞ <a href="https://repl.it/site/blog/infinite-loops">Repl.it ÊâÄÈááÁî®Á≠ñÁï•ÁöÑ</a> ÂêØÂèëÔºåÊàë‰ª¨Âú®ÊµãËØïÁéØÂ¢ÉÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/scripts/babel/transform-prevent-infinite-loops.js">Èò≤Ê≠¢Ê≠ªÂæ™ÁéØÁöÑ Babel Êèí‰ª∂</a>„ÄÇËã•Êüê‰∫õÂæ™ÁéØË∂ÖËøá‰∫ÜÂæ™ÁéØÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÊï∞ÂÄºÔºåÊàë‰ª¨Â∞Ü‰ºöÊäõÂá∫‰∏Ä‰∏™ÈîôËØØÂπ∂Á´ãÂàªÂ§±Êïà‰ª•ËÆ© Jest ËÉΩÂ§üÂáÜÁ°ÆÂú∞ÊòæÁ§∫Á°ÆÂàáÁöÑÂèëÁîü‰ΩçÁΩÆ„ÄÇ</p>
<p>Ëøô‰∏ÄÊñπÂºèÊúâ‰∏Ä‰∏™Áº∫Èô∑„ÄÇËã•‰∏Ä‰∏™ÈîôËØØ‰ªé Babel Êèí‰ª∂‰∏≠‰∫ßÁîüÂπ∂ÂøΩÁï•ÂáΩÊï∞Ë∞ÉÁî®Ê†àÔºåÊµãËØïÂ∞Ü‰ºöÈÄöËøáÂç≥‰ΩøÊòØÊ≠ªÂæ™ÁéØ„ÄÇËøôÁúüÁöÑ„ÄÅÁúüÁöÑÈùûÂ∏∏Á≥üÁ≥ï„ÄÇ‰∏∫Ëß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºåÊàë‰ª¨Âú®ÊäõÂá∫ÈîôËØØ‰πãÂâç<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/scripts/jest/setupTests.js#L42-L56">ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ÂÖ®Â±ÄÂå∫Âüü</a>„ÄÇËÄåÂêéÔºåÂú®ÊØèÊ¨°ÊµãËØïËøêË°å‰πãÂêéÔºåÂ¶ÇÊûúÂÖ®Â±ÄÂå∫ÂüüÂ∑≤ÁªèË¢´ËÆæÁΩÆ‰∫ÜÊàë‰ª¨Â∞ÜÈáçÊñ∞ÁàÜÂá∫ÈîôËØØ„ÄÇËøô‰∏ÄÊñπÂºè‰∏ã‰ªª‰ΩïÊ≠ªÂæ™ÁéØÂ∞Ü‰ºöÈÄ†ÊàêÊµãËØïÂ§±Ë¥•ÔºåÊó†ËÆ∫ÈîôËØØÊòØÂê¶ÊòØÁî± Babel Êèí‰ª∂ÂºïËµ∑„ÄÇ</p>
<h2 id="Ëá™ÂÆö‰πâÊûÑÂª∫"><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E5%BB%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ëá™ÂÆö‰πâÊûÑÂª∫</h2>
<p>Âú®ÂºïÂÖ•Êñ∞ÁöÑÊûÑÂª∫ÊµÅÁ®ãÂêéÔºå‰ªçÁÑ∂Êúâ‰∏Ä‰∫õ‰∏úË•øÊàë‰ª¨ÂøÖÈ°ªËøõË°åÂæÆË∞É„ÄÇÂÖ∂Ëä±Ë¥π‰∫ÜÊàë‰ª¨‰∏Ä‰∫õÊó∂Èó¥Êù•Â§ÑÁêÜÔºå‰ΩÜÊàë‰ª¨ÂØπ‰∫éÊàë‰ª¨ÊâÄËÉΩÊâæÂà∞ÁöÑËß£ÂÜ≥ÊñπÊ°àË°®Á§∫Êª°ÊÑè„ÄÇ</p>
<h3 id="Ê∂àÈô§Êó†Áî®‰ª£Á†Å"><a href="#%E6%B6%88%E9%99%A4%E6%97%A0%E7%94%A8%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ê∂àÈô§Êó†Áî®‰ª£Á†Å</h3>
<p>Rollup Âíå Google Closure Compiler ÁöÑÁªìÂêàÂ∑≤ÁªèËÉΩÂ§üËÆ©Êàë‰ª¨Âú®Áîü‰∫ßÂåÖ‰∏≠‰ªÖÂ∞ÜÂºÄÂèëÁöÑ‰ª£Á†ÅÂâ•Á¶ª„ÄÇÊàë‰ª¨Âú®ÊûÑÂª∫ÊúüÈó¥Â∞Ü <code class="gatsby-code-text">__DEV__</code> Â≠óÁ¨¶‰∏≤<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L223-L226">ÊõøÊç¢</a>‰∏∫‰∏Ä‰∏™Â∏ÉÂ∞îÁ±ªÂûãÁöÑÂ∏∏ÈáèÔºåRollup Âíå Google Closure Compiler ÈÉΩËÉΩÂ§üÂ∞Ü <code class="gatsby-code-text">if (false) {}</code> ÁöÑ‰ª£Á†ÅÂàÜÊîØ‰ª•Âèä‰∏Ä‰∫õÊõ¥Â§çÊùÇÁöÑÊ®°ÂºèÁªôÁßªÈô§„ÄÇÁÑ∂ËÄåÔºå‰ªçÁÑ∂Â≠òÂú®‰∏Ä‰∏™ÈùûÂ∏∏ËÆ®ÂéåÁöÑÊÉÖÂÜµÔºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">import</span> warning <span class="token keyword">from</span> <span class="token string">'fbjs/lib/warning'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">warning</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'Blimey!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
<p>Ëøô‰∏ÄÊ®°ÂºèÂú® React Ê∫êÁ†Å‰∏≠ÈùûÂ∏∏Â∏∏ËßÅ„ÄÇÁÑ∂ËÄå <code class="gatsby-code-text">fbjs/lib/warning</code> ÊòØ‰∏Ä‰∏™Â§ñÈÉ®ÂºïÂÖ•ÁöÑÂ∫ìÔºåËÄå‰∏çÊòØ Rollup ÊâìÂåÖÁöÑ CommonJS ÂåÖ„ÄÇÂõ†Ê≠§ÔºåÂç≥‰Ωø <code class="gatsby-code-text">warning()</code> ÂÆåÂÖ®Ë¢´ÁßªÈô§ÔºåRollup ‰ªçÁÑ∂‰∏çÁü•ÈÅìËÉΩÂê¶ÂÆâÂÖ®Âú∞ÁßªÈô§Êï¥‰∏™ÂºïÂÖ•„ÄÇË¶ÅÊòØÊ®°ÂùóÂú®ÂàùÂßãÂåñÊúüÈó¥ÊúâÂâØ‰ΩúÁî®ÔºüÈÇ£ÁßªÈô§Êìç‰ΩúÂ∞Ü‰ºöÂèòÂæó‰∏çÂÆâÂÖ®„ÄÇ</p>
<p>‰∏∫Ëß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºåÊàë‰ª¨‰ΩøÁî®‰∫Ü <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L338-L340">Rollup ÁöÑ <code class="gatsby-code-text">treeshake.pureExternalModules</code> ÈÄâÈ°π</a>ÔºåÂ∞ÜÁ°Æ‰øù‰∏ç‰ºö‰∫ßÁîüÂâØ‰ΩúÁî®ÁöÑÊ®°Âùó‰øùÂ≠òÂú®‰∏Ä‰∏™Êï∞ÁªÑÈáå„ÄÇËøôËÉΩÂ§üËÆ© Rollup Áü•ÈÅìÂ¶ÇÊûú <code class="gatsby-code-text">fbjs/lib/warning</code> ÂºïÂÖ•Êú™Ë¢´‰ΩøÁî®ÔºåËÉΩÂ§üÂÆåÂÖ®ÂÆâÂÖ®Âú∞Â∞ÜÂÆÉ‰ªé‰ª£Á†Å‰∏≠Ââ•Á¶ª„ÄÇÁÑ∂ËÄåÔºå Â¶ÇÊûúÂÆÉ<em>Ê≠£Âú®</em>Ë¢´‰ΩøÁî®Ôºà‰æãÂ¶ÇÊàë‰ª¨ÂÜ≥ÂÆöÂú®Áîü‰∫ßÁâàÊú¨‰∏≠Â¢ûÂä†Ë≠¶ÂëäÔºâÔºåimport ÂàôÂ∞Ü‰ºöË¢´‰øùÁïô„ÄÇËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàËøô‰∏ÄÊñπÂºèÊØîÊõøÊç¢ÊàêÁ©∫Ê®°ÂùóÊõ¥‰∏∫ÂÆâÂÖ®„ÄÇ</p>
<p>ÂΩìÊàë‰ª¨ËøõË°åÊüê‰∫õ‰ºòÂåñÔºåÊàë‰ª¨ÈúÄË¶ÅÁ°Æ‰øùÂÖ∂‰∏ç‰ºöÂú®‰πãÂêéÂºïÂÖ• bug„ÄÇË¶ÅÊòØÊüê‰∫∫ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ‰ªÖÂú®ÂºÄÂèëÊ®°Âºè‰∏ãÂèØÁî®ÁöÑÈ¢ùÂ§ñÁöÑÂ∫ìÔºåÂπ∂‰∏îÊú™ÊÑèËØÜ‰πüÂà∞ÈúÄË¶ÅÊ∑ªÂä†Âà∞ <code class="gatsby-code-text">pureExternalModules</code> ÈáåÔºüRollup Âú®ËøôÊ†∑ÁöÑÊÉÖÂÜµ‰ºöÊâìÂç∞Âá∫‰∏Ä‰∏™Ë≠¶ÂëäÔºå‰ΩÜÊàë‰ª¨<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/build.js#L395-L412">ÂÜ≥ÂÆöËÆ©Êï¥‰∏™ÊûÑÂª∫ÁéØËäÇÈÉΩÂ§±Êïà</a>„ÄÇËøôÂº∫Âà∂‰∫∫‰ª¨ÊØèÊ¨°Â¢ûÂä†‰∏Ä‰∏™‰ªÖÂú®ÂºÄÂèëÊ®°Âºè‰∏ãÂèØÁî®ÁöÑÂåÖÂ∞±ÈúÄË¶ÅÁõ¥Êé•Âú∞Â£∞Êòé<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/modules.js#L10-L22">ËÄåÊó†ËÆ∫ÂÖ∂ÊòØÂê¶ÂÖ∑ÊúâÂâØ‰ΩúÁî®</a> „ÄÇ</p>
<h3 id="fork-Ê®°Âùó"><a href="#fork-%E6%A8%A1%E5%9D%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fork Ê®°Âùó</h3>
<p>Âú®Êüê‰∫õÊÉÖÂÜµÔºå‰∏çÂêåÁöÑÂåÖÈúÄË¶ÅÂåÖÂê´‰∫õÁ®çÂæÆ‰∏çÂêåÁöÑ‰ª£Á†Å„ÄÇ‰æãÂ¶ÇÔºåReact Native Êúâ‰∏çÂêåÁöÑÈîôËØØÂ§ÑÁêÜÊú∫Âà∂ÔºåÂç≥Â±ïÁ§∫‰∏Ä‰∏™Á∫¢Ê°ÜËÄå‰∏çÊòØÊâìÂç∞‰∏ÄÊù°‰ø°ÊÅØÂà∞ÊéßÂà∂Âè∞„ÄÇÁÑ∂ËÄåÔºåÈÄöËøáÊ®°ÂùóË∞ÉÁî®Â∞ÜÂ∑ÆÂºÇ‰∏≤ËÅîËµ∑Êù•ÈùûÂ∏∏Âú∞‰∏çÊñπ‰æø„ÄÇ</p>
<p>Á±ª‰ººËøôÊ†∑ÁöÑÈóÆÈ¢òÈÄöÂ∏∏ÈÄöËøáËøêË°åÊó∂ÈÖçÁΩÆËøõË°åËß£ÂÜ≥„ÄÇÁÑ∂ËÄåÔºåÊúâÊó∂ÂÄôÂàôÊó†Ê≥ïÂ§ÑÁêÜÔºö‰æãÂ¶ÇÔºåReact DOM ÂåÖÁîöËá≥‰∏çÂ∫îËØ•ÂéªÂºïÂÖ• React Native ÁöÑ redbox ÂáΩÊï∞„ÄÇÂ∞Ü‰ªéÊú™Âú®ÊåáÂÆöÁéØÂ¢ÉËøêË°å‰∏ã‰ΩøÁî®ÁöÑ‰ª£Á†ÅËøõË°åÊâìÂåÖ‰πüÊòØÈùûÂ∏∏Á≥üÁ≥ïÁöÑ„ÄÇ</p>
<p>Âè¶‰∏ÄÁßçÊñπÂºèÊòØ‰ΩøÁî®Âä®ÊÄÅ‰æùËµñÊ≥®ÂÖ•„ÄÇÁÑ∂ËÄåÔºåËøôÈÄöÂ∏∏‰ºö‰ΩøÂæó‰ª£Á†ÅÈöæ‰ª•ÁêÜËß£Âπ∂ÂèØËÉΩÈÄ†Êàê‰∏•ÈáçÁöÑ‰æùËµñ„ÄÇËøô‰πü‰ΩøÂæó‰∏Ä‰∫õ‰ºòÂåñÁöÑÊú∫‰ºöËêΩÁ©∫„ÄÇ</p>
<p>‰ªé‰ª£Á†ÅÁöÑËßíÂ∫¶Êù•ÁúãÔºåÁêÜÊÉ≥ÊÉÖÂÜµ‰∏ãÊàë‰ª¨‰ªÖÂ∏åÊúõÂ∞Ü‰∏çÂêåÁöÑÊ®°ÂùóÈáçÊñ∞ÊåáÂêëÁâπÂÆöÁöÑÂåÖ„ÄÇËøô‰∏Ä ‚Äúfork‚Äù ÂíåÂéüÊù•ÁöÑÊ®°Âùó‰∏ÄÊ†∑ÊúâÁõ∏ÂêåÁöÑ APIÔºå‰ΩÜÂ§ÑÁêÜÁöÑÊñπÂºè‰∏çÂêå„ÄÇÊàë‰ª¨ÂèëÁé∞Ëøô‰∏ÄÊ®°ÂûãÈùûÂ∏∏Áõ¥ËßÇÔºåÂπ∂<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/forks.js">ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ fork ÈÖçÁΩÆÊñá‰ª∂</a> Êù•ÂØπÂ¶Ç‰Ωï‰∏é‰ªñ‰ª¨ÂéüÂßãÁöÑÊ®°ÂùóËøõË°åÊò†Â∞Ñ‰ª•ÂèäÂú®Âì™‰∫õÊù°‰ª∂‰∏ã‰ºöÂèëÁîüËøõË°åËØ¶ÁªÜËØ¥Êòé„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåfork ÈÖçÁΩÆÂÖ•Âè£ÂØπ‰∫é‰∏çÂêåÁöÑÂåÖÊåáÂÆö‰∫Ü‰∏çÂêåÁöÑ <a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/shared/ReactFeatureFlags.js">ÁâπÊÄßÊ†áÂøó</a>Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token string">'shared/ReactFeatureFlags'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>bundleType<span class="token punctuation">,</span> entry<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'react-native-renderer'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.native.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'react-cs-renderer'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.native-cs.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>bundleType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> FB_DEV<span class="token punctuation">:</span>
        <span class="token keyword">case</span> FB_PROD<span class="token punctuation">:</span>
          <span class="token keyword">return</span> <span class="token string">'shared/forks/ReactFeatureFlags.www.js'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
      </div>
<p>Âú®ÊûÑÂª∫ÊúüÈó¥ÔºåËã•Êù°‰ª∂Êª°Ë∂≥Ôºå<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/scripts/rollup/plugins/use-forks-plugin.js#L40">Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑ Rollup Êèí‰ª∂</a>Â∞Ü‰ºöÁî®ÂÆÉ‰ª¨ fork ÁöÑÊ®°ÂùóÊù•ÊõøÊç¢„ÄÇÁî±‰∫éÂéüÂßãÊ®°ÂùóÂíå fork ÁöÑÊ®°ÂùóÈÉΩÁî± ES Ê®°ÂùóÂÜôÊàêÔºå Rollup Âíå Google Closure Compiler ÂèØ‰ª•ÂÜÖÂµåÔºàinlineÔºâÁ±ª‰ººÊï∞Â≠óÊàñÂ∏ÉÂ∞îÂÄºÁ≠âÂ∏∏ÈáèÔºåÂπ∂Âõ†Ê≠§ÂØπ‰∫é‰∏çÊîØÊåÅÁöÑÁâπÊÄßÊ†áÂøóËÉΩÂ§üÊúâÊïàÂú∞ÁßªÈô§„ÄÇÂú®ÊµãËØï‰∏≠ÔºåÂΩìÈúÄË¶ÅÊó∂ÔºåÊàë‰ª¨<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/react-cs-renderer/src/__tests__/ReactNativeCS-test.internal.js#L15-L17">‰ΩøÁî® <code class="gatsby-code-text">jest.mock()</code></a> ÊåáÂêëÊåáÂêëÁâπÂÆöÁöÑ fork ÁâàÊú¨„ÄÇ</p>
<p>‰Ωú‰∏∫ÂõûÊä•ÔºåÊàë‰ª¨ÂèØËÉΩÊÉ≥Ë¶ÅÈ™åËØÅÂéüÂßãÊ®°ÂùóÁöÑÂØºÂá∫Á±ªÂûãÂíå fork Ê®°ÂùóÁöÑÂØºÂá∫Á±ªÂûãÊòØÂê¶ÂÆåÂÖ®ÂåπÈÖç„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/shared/forks/ReactFeatureFlags.native.js#L32-L36">Êúâ‰∫õÂ•áÊÄ™‰ΩÜÂÆåÂÖ®ËÉΩÂ§üÊ≠£Â∏∏ËøêËΩ¨ÁöÑ Flow ÊäÄÂ∑ß</a>Êù•ÂÆûÁé∞Ôºö</p>
<div class="gatsby-highlight">
      <pre class="gatsby-code-jsx"><code class="gatsby-code-jsx"><span class="token keyword">import</span> <span class="token keyword">typeof</span> <span class="token operator">*</span> <span class="token keyword">as</span> FeatureFlagsType <span class="token keyword">from</span> <span class="token string">'shared/ReactFeatureFlags'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">typeof</span> <span class="token operator">*</span> <span class="token keyword">as</span> FeatureFlagsShimType <span class="token keyword">from</span> <span class="token string">'./ReactFeatureFlags.native'</span><span class="token punctuation">;</span>
type Check<span class="token operator">&lt;</span>_X<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> _X<span class="token punctuation">,</span> X<span class="token punctuation">:</span> Y <span class="token operator">=</span> _X<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">:</span> Check<span class="token operator">&lt;</span>FeatureFlagsShimType<span class="token punctuation">,</span> FeatureFlagsType<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div>
<p>Ëøô‰∏ÄÊñπÂºèÈÄöËøáÂº∫Âà∂ Flow ÂéªÈ™åËØÅ‰∏§‰∏™Ê®°ÂùóÊòØÂê¶ËÉΩ‰∫íÁõ∏ËµãÂÄºÔºàÂõ†Ê≠§ÊòØÁõ∏Á≠âÁöÑÔºâ„ÄÇÁé∞Âú®ÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®‰∏çÊîπÂèòÂÖ∂‰ªñÊñá‰ª∂ÁöÑÊÉÖÂÜµ‰∏ã‰øÆÊîπÂéüÂßãÊ®°ÂùóÊàñ fork Ê®°ÂùóÁöÑÂØºÂá∫ÔºåÁ±ªÂûãÊ£ÄÊü•Â∞Ü‰ºöÂ§±Ë¥•„ÄÇËøôÂèØËÉΩÊúâÁÇπÊÑöË†¢Ôºå‰ΩÜÊàë‰ª¨ÂèëÁé∞Âú®ÂÆûË∑µ‰∏≠ÈùûÂ∏∏ÊúâÂ∏ÆÂä©„ÄÇ</p>
<p>Ê¶ÇÊã¨‰∏Ä‰∏ãËøô‰∏ÄÁ´†ÔºåÊ≥®ÊÑèÂ¶ÇÊûú‰Ω†Âú® npm ‰∏äÊù•‰ΩøÁî® React ÂàôÊó†Ê≥ïÊåáÂÆö‰Ω†Ëá™Â∑±ÁöÑ fork Ê®°Âùó„ÄÇËøôÊòØÊúâÊÑèÁöÑÔºåÂõ†‰∏∫Ëøô‰∫õÊñá‰ª∂‰∏≠Ê≤°ÊúâÂÖ¨ÂºÄÁöÑ APIÔºåËÄå‰∏îÂÆÉ‰ª¨Âπ∂Ê≤°ÊúâË¢´ <a href="https://semver.org/">semver</a> ÊâÄË¶ÜÁõñ„ÄÇÁÑ∂ËÄåÔºåÂ¶ÇÊûú‰Ω†‰∏ç‰ªãÊÑè‰∏çÁ®≥ÂÆöÊÄßÂíåÂ∑ÆÂºÇÊÄßÈ£éÈô©ÔºåÊàë‰ª¨Ê¨¢Ëøé‰Ω†‰ªé master ÂàÜÊîØ‰∏äÊù•ÊûÑÂª∫ React ÁîöËá≥ÊòØ fork ÂÆÉ„ÄÇÊàë‰ª¨Â∏åÊúõËøôÁØáÊñáÁ´†ÂØπ‰∫éËÆ∞ÂΩï‰ªéÂçï‰∏™ JavaScript Â∫ìËßíÂ∫¶Âá∫ÂèëÂÆö‰Ωç‰∫é‰∏çÂêåÁöÑÁéØÂ¢ÉËÉΩÊèê‰æõÂ∏ÆÂä©„ÄÇ</p>
<h3 id="ËøΩË∏™ÂåÖÂ∞∫ÂØ∏"><a href="#%E8%BF%BD%E8%B8%AA%E5%8C%85%E5%B0%BA%E5%AF%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ËøΩË∏™ÂåÖÂ∞∫ÂØ∏</h3>
<p>‰Ωú‰∏∫ÊûÑÂª∫ÁöÑÊúÄÂêé‰∏ÄÊ≠•ÔºåÊàë‰ª¨Áé∞Âú®<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/scripts/rollup/build.js#L264-L272">ËÆ∞ÂΩïÊâÄÊúâÊûÑÂª∫ÂåÖÁöÑÊûÑÂª∫Â§ßÂ∞è</a>Âπ∂Â∞ÜÂÆÉ‰ª¨ÂÜôÂÖ•Âà∞‰∏Ä‰∏™<a href="https://github.com/facebook/react/blob/d906de7f602df810c38aa622c83023228b047db6/scripts/rollup/results.json">Á±ª‰ººËøôÊ†∑</a>ÁöÑÊñá‰ª∂Èáå„ÄÇÂΩìËøêË°å <code class="gatsby-code-text">yarn build</code>ÔºåÂÖ∂‰ºöÊâìÂç∞‰∏Ä‰∏™ÁªìÊûúÁöÑË°®Ê†ºÔºö</p>
<br>
<img src="https://user-images.githubusercontent.com/1519870/28427900-80487dbc-6d6f-11e7-828d-1b594bd1ddb5.png" style="max-width:100%" alt="Build results after running GCC">
<p><em>ÔºàÂÖ∂Âπ∂‰∏çÊòØ‰∏ÄÁõ¥ÈÉΩËøôÊ†∑Â•Ω„ÄÇËøôÊ¨°Êèê‰∫§ÊòØÂ∞Ü React ‰ªé Uglify ËøÅÁßªÂà∞ Google Closure Compiler„ÄÇÔºâ</em></p>
<p>ËÆ∞ÂΩïÊñá‰ª∂Â§ßÂ∞èÂØπ‰∫éÊØè‰∏™‰∫∫ËøΩË∏™ÂåÖÂ∞∫ÂØ∏ÂèòÂåñÂíåÊøÄÂä±ÁùÄÂéªÂèëÁé∞‰ºòÂåñÁöÑÊú∫‰ºöÈÉΩÂçÅÂàÜÊúâÂ∏ÆÂä©„ÄÇ</p>
<p>Êàë‰ª¨ÂØπËøô‰∏ÄÁ≠ñÁï•Âπ∂‰∏çÂÆåÂÖ®Êª°ÊÑèÔºåÂõ†‰∏∫ JSON Êñá‰ª∂ÈÄöÂ∏∏‰ºöÂú®Êõ¥Â§ßÁöÑÂàÜÊîØ‰∏≠ÈÄ†ÊàêÂêàÂπ∂ÂÜ≤Á™Å„ÄÇÂΩìÂâçÂπ∂‰∏çÊòØÂº∫Âà∂ËøõË°åÊõ¥Êñ∞ÔºåÂõ†Ê≠§ÂÖ∂ÂèØËÉΩ‰ºöËøáÊó∂„ÄÇ‰πãÂêéÔºåÊàë‰ª¨ËÄÉËôëÂ∞ÜÂÖ∂ÈõÜÊàêÂà∞Ëá™Âä®Âåñ‰∏≠ÔºåÂú®ÊØèÊ¨°ÁöÑÊèê‰∫§‰∏≠ÈÉΩ‰ºöÂ∏¶ÊúâÊñá‰ª∂Â§ßÂ∞èÁöÑÂèòÂåñ„ÄÇ</p>
<h2 id="ÁÆÄÂåñÂèëÂ∏ÉÊç¢‰ª∂"><a href="#%E7%AE%80%E5%8C%96%E5%8F%91%E5%B8%83%E6%8D%A2%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÁÆÄÂåñÂèëÂ∏ÉÊç¢‰ª∂</h2>
<p>Êàë‰ª¨ÁªèÂ∏∏ÂñúÊ¨¢ÂêëÂºÄÊ∫êÁ§æÂå∫ÂèëÂ∏ÉÊõ¥Êñ∞„ÄÇ‰∏çÂπ∏ÁöÑÊòØÔºåÊóßÁöÑÊµÅÁ®ãÂú®Â§ÑÁêÜÂèëÂ∏ÉÊó∂ÈùûÂ∏∏ÁöÑÊÖ¢‰∏îÈÄöÂ∏∏‰ºöËÄóË¥π‰∏ÄÊï¥Â§©„ÄÇÂú®ÂØπËøô‰∏ÄÊµÅÁ®ãÂÅö‰∫Ü‰∫õÊîπÂèòÂêéÔºåÊàë‰ª¨Áé∞Âú®ËÉΩÂ§üÂú®‰∏Ä‰∏™Â∞èÊó∂ÂÜÖÂÆåÊàêÊï¥‰∏™ÂèëÂ∏É„ÄÇËøôÂ∞±ÊòØÊàë‰ª¨ÊâÄÂÅöÁöÑË∞ÉÊï¥„ÄÇ</p>
<h3 id="ÂàÜÊîØÁ≠ñÁï•"><a href="#%E5%88%86%E6%94%AF%E7%AD%96%E7%95%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÂàÜÊîØÁ≠ñÁï•</h3>
<p>Áî±‰∫éÊàë‰ª¨ÁöÑÂàÜÊîØÁ≠ñÁï•ÔºåÂú®ÊóßÁöÑÂèëÂ∏ÉÊµÅÁ®ã‰∏≠Ê∂àËÄó‰∫ÜÂ§ßÂ§öÊï∞ÁöÑÊó∂Èó¥„ÄÇ<code class="gatsby-code-text">master</code> ÂàÜÊîØË¢´ËÆ§‰∏∫‰∏çÂèØÈù†ÁöÑ‰∏îÈÄöÂ∏∏‰ºöÂåÖÂê´‰∏Ä‰∫õÁ†¥ÂùèÊÄßÁöÑÊõ¥Êñ∞„ÄÇÂèëÂ∏ÉÈÄöÂ∏∏‰ªé‰∏Ä‰∏™Á®≥ÂÆöÂàÜÊîØÂÆåÊàêÔºå‰∏îÊõ¥Êñ∞ÈúÄË¶ÅÂú®ÂèëÂ∏ÉÂâçÊâãÂä®‰ΩéÂ∞ÜÂÖ∂ÊåëÈÄâÂà∞Ëøô‰∏ÄÂàÜÊîØ‰∏≠Âéª„ÄÇÊàë‰ª¨Êúâ<a href="https://github.com/facebook/react/pull/7330">Â∑•ÂÖ∑Êù•Â∏ÆÂä©Ëá™Âä®Âåñ</a>ÂÖ∂‰∏≠‰∏Ä‰∫õÊµÅÁ®ãÔºå‰ΩÜ‰ΩøÁî®‰ªçÁÑ∂<a href="https://github.com/facebook/react/blob/b5a2a1349d6e804d534f673612357c0be7e1d701/scripts/release-manager/Readme.md">Áõ∏ÂΩìÂ§çÊùÇ</a>„ÄÇ</p>
<p>Èöè 16 ÁâàÊú¨ÔºåÊàë‰ª¨Áé∞Âú®‰ªé <code class="gatsby-code-text">master</code> ÂàÜÊîØ‰∏äËøõË°åÂèëÂ∏É„ÄÇÂÆûÈ™åÁâπÊÄßÂíå‰∏Ä‰∫õÁ†¥ÂùèÊÄßÊõ¥Êñ∞‰πüË¢´ÂÖÅËÆ∏Ôºå‰ΩÜÂøÖÈ°ªÈöêËóèÂú®<a href="https://github.com/facebook/react/blob/cc52e06b490e0dc2482b345aa5d0d65fae931095/packages/shared/ReactFeatureFlags.js">ÁâπÊÄßÊ†áËÆ∞</a>‰πãÂêéÔºåÊâÄ‰ª•‰ªñ‰ª¨ËÉΩÂ§üÂú®ÊûÑÂª∫ÁéØËäÇË¢´ÁßªÈô§„ÄÇÊñ∞ÁöÑÊâÅÂπ≥ÂåñÂåÖÂíåÊó†Áî®‰ª£Á†ÅÊì¶Èô§‰ΩøÂæóÊàë‰ª¨‰∏çÁî®ÊãÖÂøÉÂ∞Ü‰ªª‰Ωï‰∏çÊÉ≥ÂÖ¨ÂºÄÁöÑ‰ª£Á†ÅÊ≥ÑÈú≤Âà∞ÂºÄÊ∫êÁâàÊú¨‰∏≠„ÄÇ</p>
<h3 id="Ëá™Âä®ÂåñËÑöÊú¨"><a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ëá™Âä®ÂåñËÑöÊú¨</h3>
<p>Â∞ÜÂèòÊõ¥ËøÅÂÖ•Âà∞Á®≥ÂÆöÁöÑ <code class="gatsby-code-text">master</code> ÂêéÔºåÊàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ <a href="https://github.com/facebook/react/issues/10620">ÂèëÂ∏ÉÊµÅÁ®ãÊ∏ÖÂçï</a>„ÄÇÂ∞ΩÁÆ°ÊØî‰πãÂâçÁöÑÁéØËäÇÊõ¥ÁÆÄÂçïÔºåËøô‰ªçÁÑ∂ÂåÖÂê´‰∫ÜÂ§ßÈáèÁöÑÊ≠•È™§‰∏îÈÅóÂøò‰∫Ü‰∏Ä‰∏™ÂèØËÉΩ‰ºöÂØºËá¥‰∏ÄÊ¨°ÂºÇÂ∏∏ÁöÑÂèëÂ∏É„ÄÇ</p>
<p>‰∏∫Ëß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºåÊàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ <a href="https://github.com/facebook/react/pull/11223">Ëá™Âä®Âú∞ÂèëÂ∏ÉÊµÅÁ®ã</a>ÔºåÂÖ∂<a href="https://github.com/facebook/react/tree/master/scripts/release#react-release-script">Êõ¥ÂÆπÊòì‰ΩøÁî®</a>Âπ∂ÂåÖÂê´‰∫ÜÂá†È°πÊûÑÂª∫Ê£ÄÊü•‰ª•Á°Æ‰øùÊàë‰ª¨ÂèëÂ∏É‰∫Ü‰∏ÄÊ¨°ÊúâÊïàÁöÑÊûÑÂª∫„ÄÇÊñ∞ÁöÑÊµÅÁ®ãË¢´ÂàÜÈöî‰∏∫‰∏§Ê≠•Ôºö<em>ÊûÑÂª∫</em> Âíå <em>ÂèëÂ∏É</em>„ÄÇËøôÊòØ‰Ω†Á¨¨‰∏ÄÊ¨°ËøêË°åÁöÑÊ†∑Â≠êÔºö</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 822px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 45.37712895377128%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9ElEQVQoz41S7W6EIBDUqgunIp9i0Yo5Mdr3f8IO7Z8mvfY6IZsJzrA7YOHG0XuvjXHOGcD5XMbMq6oq/gYZR9rx8ZWkyVXZoiyLf+KlISySuukHpkx967BZfuK5WUo5eT8MgzF6EAKkaZqfssdn7fuulPr6DBsxRkRIC0qUOfBrZ7S6Z+wg87xc1/txHOd5ppRCCDHGbdu0Uri/BxPNIfjJY/iu6zjnbXtjjPV9X9f188x4pzVGvNM0TTAzhsLRpG1bTI5Ey/JmrcUUQgjGWfE9O6Rb3KBYVxySx8S1wQkp0lprsAPneV4pHZCgh9b4LQxifgAFAxQ1QzKDmQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script overview"
        title=""
        src="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png"
        srcset="/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-d0a04.png 210w,
/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-c8d6c.png 420w,
/static/release-script-build-overview-adca79c3a0e003b317fe62e68ce9d4a0-a0a5f.png 822w"
        sizes="(max-width: 822px) 100vw, 822px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><em>ÊûÑÂª∫</em> ÁéØËäÇÂÅö‰∫ÜÂ§ßÈáèÁöÑÂ∑•‰Ωú - È™åËØÅËÆ∏ÂèØÔºåËøêË°åÊµãËØïÂíåÊ£ÄÊü• CI Áä∂ÊÄÅ„ÄÇ‰∏ÄÊó¶ÂÖ∂ÂÆåÊàêÔºåÂÖ∂Â∞Ü‰ºöËæìÂá∫‰∏Ä‰∏™Ê¢ØÂΩ¢Ê∏ÖÂçïÂà∞ CHANGELOG Âπ∂‰ΩøÁî®‰πãÂâçÊèêÂà∞ÁöÑ <a href="#creating-manual-test-fixtures">ÊâãÂ∑•Ë£ÖÁΩÆ</a> Êù•ËøõË°åÂåÖÈ™åËØÅ„ÄÇ</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-d15b8.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 840px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 95.52407932011332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAAByUlEQVQ4y5VT2Y6jMBAEbALm8oVtjG0CmUQZzf9/4BTkabUrki01zSEV1V3dzrQZU0rbZmNQxlhnnRCibduhH5qmuVwur5z9E2rSXzvWdU2gEVLkeZ59COXUbbvFlGJMUqrsv6Anva1bCDPnvG07wUXf93imtPxEGeTbsixuckLu3aJJ5KIoPiDbnRxC8LOXSrIDwzB03a5fVdUZude985O22tpBKQ5VKIMMcdRflqfFM8Va3TDZlCUtihzVUkry/V4QQiilZ+ShG5TUozbWWq31eEApBVlMDvms+X43d+BwWQg0iYLxAbbXdY3deDPz+gBMQm67HWj7UoFYoeY3ZFQ4TRNqjjEiw6HTPvM/whjjnPPehzmgWyhDdDeL0uIFgis/3v76FZhzCM5NWE/8Jy3XGBfBpRBSKWQjxCxklCpwEapa1mysmW7aibExwz57D+bkvV2WcByhAkEI1CjZlxSKBJEXUEeUexBURzMhJZj3u3k+7fe3Naa2hhnDpOxenp8ZZszoZ5zodLuln5/H4/G0brmuDxxtCL/Zbc6l1jMXUenN2Icx2zhea6ZeM3ozKu/Fuun7l15XaUy3JGHGXuv2GHiDfHI2fgHOzScpC1PdigAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script build confirmation screen"
        title=""
        src="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-acf85.png"
        srcset="/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-c1418.png 210w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-5d5d8.png 420w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-acf85.png 840w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-de0cd.png 1260w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-bd6c2.png 1680w,
/static/release-script-build-confirmation-17f44f353d82a22f6a18707956ad065f-d15b8.png 1765w"
        sizes="(max-width: 840px) 100vw, 840px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>Ââ©‰∏ãÁöÑÂ∞±ÊòØËøõË°åÊ†áËÆ∞ÔºàtagÔºâÂπ∂‰ΩøÁî®<em>ÂèëÂ∏É</em>ËÑöÊú¨ÂèëÂ∏ÉÂà∞ NPM ‰∏ä„ÄÇ</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-bd35c.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 840px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 125.12733446519523%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsSAAALEgHS3X78AAACtElEQVQ4y41UCXKjMBD0wSUJiUMCXRgBPpJ4P7D7/49tIza1sStV8SQ1BTI9R0+PdtrqeV7GMcwhTONonTudTt77qqqaaG3bKtXBM8YoY3VdU0qzLCvLcscbPo2TNU513vhZWwvA8XjcvWJMMWWVNCrvzL6yhIlKiN2LRi3LuyJXBfOkqNP1aL8/fLH9+nrEA8qBfwBzxmtRt/gTaE9xITjn6Keq0XVVNzWe0S0OlVJCiAc8PgKo5LxuGnwBMrYMx2hJkmz5vy8bmK7rAGNlKaMJUYFS5EQqrXXbroQTQrZAD+CtQkJJQQhq3ooso6FIBCk/X/M8T9P0sWfOm7ah0ZANgK1DLjhm1use+Cra1hT4+wIWYgOgMB4NiUSFea3M4TCPBlUUBYojD5VvPCH85tc88Rl14usf5uy8l7L10cIYhmEIYUxeVBi4Bd5aG0IwxjjvWjl1/Zvq3qp6IcwzPpd8omygpWN8LPmYpOwfGHO6XC7Lslyv1zCO8xJut+n+6+3jY/rze7zf9ekEntKiANNZlq+NQwSf8qRUKokQzrmu60Nwg0c1B0IwxQIkd4ooWWBShGKpGE7+D6zre4gBNU/TZKyFV0qCNhABvr/O5RtDn0g7zTM22Vrnh0Gb2dhpGK7whMo8q7Jc5HmVZWJ/SJ4V1muN5M5V86ymSY6j0brTZilIm2V1QWReNHnR4vVweFQYxhpLVbhObreztf2y+Pf3xWiVpskPo+pjz/BgC2XD40qihG6/Ypc//9e9xsEzGKvj1obR8er94Dcxwv90k1DmHEQmtUZOXIAe4Ovter/fPzBl8Ilw3qM6eMj2SWGij2YMrlFcpDN2C6u7rQrohNgxdzxjfs9qRzZEP5/PGBWwUBsCvXoBIoOUCisNtcQrWmGNoRnEQgcIvS5MCNjKyN8DYX8BX7tGg3ZkvyoAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Release Script publish confirmation screen"
        title=""
        src="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-acf85.png"
        srcset="/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-c1418.png 210w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-5d5d8.png 420w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-acf85.png 840w,
/static/release-script-publish-confirmation-a3846d4b3e50d29415846b58612310f2-bd35c.png 1178w"
        sizes="(max-width: 840px) 100vw, 840px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>Ôºà‰Ω†ÂèØËÉΩÂú®‰πãÂâçÁöÑÊà™Âõæ‰∏≠Ê≥®ÊÑèÂà∞‰∫Ü <code class="gatsby-code-text">--dry</code> Ê†áËÆ∞„ÄÇËØ•Ê†áËÆ∞ÂÖÅËÆ∏Êàë‰ª¨ËøêË°å‰∏ÄÊ¨°Á´ØÂà∞Á´ØÁöÑÂèëÂ∏ÉÔºåËÄå‰∏ç‰ºöÂÆûÈôÖÂèëÂ∏ÉÂà∞ NPM„ÄÇËøôÂØπ‰∫éÂ§ÑÁêÜÂèëÂ∏ÉËÑöÊú¨Ëá™Ë∫´Êó∂ÈùûÂ∏∏ÊúâÁî®„ÄÇÔºâ</p>
<h2 id="ÊÄªÁªì"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÊÄªÁªì</h2>
<p>ËøôÁØáÂçöÂÆ¢ÊòØÂê¶ÊøÄÂä±‰Ω†ËÆ©‰Ω†Âú®‰Ω†Ëá™Â∑±ÁöÑÈ°πÁõÆ‰∏≠Â∞ùËØï‰∏Ä‰∫õÊÉ≥Ê≥ïÔºüÊàë‰ª¨Á°ÆÂÆûÂ∏åÊúõÂ¶ÇÊ≠§„ÄÇËã•‰Ω†ÊúâÂÖ∂‰ªñÂÖ≥‰∫éÂ¶Ç‰ΩïÊûÑÂª∫ ReactÔºåÊµãËØïÔºåÊàñË¥°ÁåÆÂ∑•‰ΩúÊµÅÁöÑÊèêÂçáÔºåËØ∑Âú®[Êàë‰ª¨ÁöÑÈóÆÈ¢òËøΩË∏™Âô®]‰∏äËÆ©Êàë‰ª¨Áü•ÈÅì(<a href="https://github.com/facebook/react/issues">https://github.com/facebook/react/issues</a>)„ÄÇ</p>
<p>‰Ω†ÂèØ‰ª•ÈÄöËøá<a href="https://github.com/facebook/react/labels/Component%3A%20Build%20Infrastructure">ÊûÑÂª∫Âü∫Á°ÄËÆæÊñΩÊ†áÁ≠æ</a> ÊâæÂà∞Áõ∏ÂÖ≥ÈóÆÈ¢ò„ÄÇËøô‰∫õÈÄöÂ∏∏ÊòØÁ¨¨‰∏ÄÊ¨°Ë¥°ÁåÆÁöÑÂ•ΩÊú∫‰ºöÔºÅ</p>
<h2 id="ÊÑüË∞¢"><a href="#%E6%84%9F%E8%B0%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ÊÑüË∞¢</h2>
<p>Êàë‰ª¨ÊÉ≥Ë¶ÅÊÑüË∞¢Ôºö</p>
<ul>
<li><a href="https://github.com/Rich-Harris">Rich Harris</a> Âíå <a href="https://github.com/lukastaegert">Lukas Taegert</a> ÂØπ‰∫é Rollup ÁöÑ‰∏∫‰Ωï‰ª•ÂèäÂ∏ÆÂä©Êàë‰ª¨ËøÅÁßªÂà∞ÈÇ£„ÄÇ</li>
<li><a href="https://github.com/dimvar">Dimitris Vardoulakis</a>Ôºå <a href="https://github.com/ChadKillingsworth">Chad Killingsworth</a> Âíå <a href="https://github.com/MatrixFrog">Tyler Breisacher</a> ÂØπ‰∫é‰ªñ‰ª¨Âú® Google Closure Compilre ‰∏äÁöÑÂ∑•‰Ωú‰ª•ÂèäÂèäÊó∂ÁöÑÂª∫ËÆÆ„ÄÇ</li>
<li><a href="https://github.com/watadarkstar">Adrian Carolli</a>Ôºå<a href="https://github.com/rivenhk">Adams Au</a>Ôºå<a href="https://github.com/accordeiro">Alex Cordeiro</a>, <a href="https://github.com/HeroProtagonist">Jordan Tepper</a>Ôºå<a href="https://github.com/sjy">Johnson</a>Ôºå<a href="https://github.com/misoguy">Soo Jae Hwang</a>Ôºå<a href="https://github.com/xjlim">Joe Lim</a>Ôºå<a href="https://github.com/yu-tian113">Yu Tian</a> ÂíåÂÖ∂‰ªñ‰∫∫Â∏ÆÂä©Âú®ÂéüÂûãÂíåÂÆûÁé∞‰∏≠ÊâÄÂÅöÁöÑÁõ∏ÂÖ≥ÁöÑÊîπËøõ„ÄÇ</li>
<li><a href="https://github.com/anushreesubramani">Anushree Subramani</a>Ôºå<a href="https://github.com/abiduzz420">Abid Uzair</a>Ôºå<a href="https://github.com/skiritsis">Sotiris Kiritsis</a>Ôºå<a href="https://github.com/timjacobi">Tim Jacobi</a>, <a href="https://github.com/aarboleda1">Anton Arboleda</a>Ôºå<a href="https://github.com/jeremenichelli">Jeremias Menichelli</a>Ôºå<a href="https://github.com/audyodi">Audy Tanudjaja</a>Ôºå<a href="https://github.com/gordyd">Gordon Dent</a>, <a href="https://github.com/enapupe">Iacami Gevaerd
</a>Ôºå<a href="https://github.com/sadpandabear">Lucas Lentz</a>, <a href="https://github.com/silvestrijonathan">Jonathan Silvestri</a>Ôºå<a href="https://github.com/mjw56">Mike Wilcox</a>Ôºå<a href="https://github.com/smaniotto">Bernardo Smaniotto</a>Ôºå<a href="https://github.com/douglasgimli">Douglas Gimli</a>Ôºå<a href="https://github.com/ethan-arrowood">Ethan Arrowood</a>Ôºå‰ª•ÂèäÂÖ∂‰ªñ‰∫∫Êù•Â∏ÆÂä©ÂÆåÊàêÁßªÊ§ç React ÊµãËØïÂ•ó‰ª∂‰ΩøÁî®ÂÖ¨ÂÖ±ÁöÑ API„ÄÇ</li>
</ul>]]></description><link>https://doc.react-china.org/blog/2017/12/15/improving-the-repository-infrastructure.html</link><guid isPermaLink="false">https://doc.react-china.org/blog/2017/12/15/improving-the-repository-infrastructure.html</guid><pubDate>Fri, 15 Dec 2017 00:00:00 GMT</pubDate></item></channel></rss>